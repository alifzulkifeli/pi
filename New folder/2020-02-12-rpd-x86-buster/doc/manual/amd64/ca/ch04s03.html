<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>4.3. Preparació dels fitxers per arrencar amb el llapis de memòria USB</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="Guia d'instal·lació de Debian GNU/Linux">
<link rel="up" href="ch04.html" title="Capítol 4. Obtenir el suport d'instal·lació del sistema">
<link rel="prev" href="ch04s02.html" title="4.2. Descarregar fitxers de les rèpliques de Debian">
<link rel="next" href="ch04s04.html" title="4.4. Preparació dels fitxers per arrencar des del disc dur">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">4.3. Preparació dels fitxers per arrencar amb el llapis de memòria USB</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch04s02.html"><img src="images/prev.png" alt="Anterior"></a> </td>
<th width="60%" align="center">Capítol 4. Obtenir el suport d'instal·lació del sistema</th>
<td width="20%" align="right"> <a accesskey="n" href="ch04s04.html"><img src="images/next.png" alt="Següent"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="boot-usb-files"></a>4.3. Preparació dels fitxers per arrencar amb el llapis de memòria USB</h2></div></div></div>
<p>Per preparar el llapis USB, necessitareu un sistema amb GNU/Linux que suporti dispositius USB. Els sistemes GNU/Linux actuals normalment reconeixen automàticament els llapis USB així que es connecten. Si no és el cas, hauríeu de comprovar que s'ha carregat el mòdul «usb-storage» del nucli. Quan connecteu el llapis USB, aquest estarà representat per un dispositiu anomenat <code class="filename">/dev/sdX</code>, on la <span class="quote">«<span class="quote">X</span>»</span> és una lletra en minúscules (a-z). Hauríeu de poder veure de quin dispositiu es tracta més exactament executant l'ordre <span class="command"><strong>dmesg</strong></span> després de connectar-lo. Per escriure-hi, és possible que calgui desactivar la protecció d'escriptura del llapis USB. </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Avís]" src="images/warning.png"></td>
<th align="left">Avís</th>
</tr>
<tr><td align="left" valign="top"><p>Aneu amb compte, tots els procediments que es descriuen en aquesta secció destruiran tot el que hi hagi al dispositiu. Assegureu-vos que esteu utilitzant el nom de dispositiu corresponent al llapis USB. Si utilitzeu un nom de dispositiu incorrecte podeu arribar a perdre les dades de, per exemple, el disc dur principal. </p></td></tr>
</table></div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-isohybrid"></a>4.3.1. Preparar una memòria USB fent servir una imatge híbrida CD o DVD</h3></div></div></div>
<p>Les imatges en CD i DVD de Debina es poden escriure directament a una memòria USB, que resulta ésser un sistema molt senzill d'obtenir una memòria USB arrencable. Seleccioneu una imatge en CD o DVD (ja sigui la d'instal·lació per xarxa, «netinst», CD-1, DVD-1 o la d'arrencada per xarxa, «netboot») per a posar-la en la vostra memòria USB. Vegeu <a class="xref" href="ch04s01.html" title="4.1. Conjunt de CD-ROM oficials de Debian GNU/Linux">Secció 4.1, «Conjunt de CD-ROM oficials de Debian GNU/Linux»</a> per a obtenir una imatge en CD o DVD. </p>
<p>Una altra opció, per a memòries USB molt petites, només d'alguns megabits de capacitat, és descarregar la imatge <code class="filename">mini.iso</code> des del directori <code class="filename">netboot</code> (a l'adreça citada a <a class="xref" href="ch04s02.html#where-files" title="4.2.1. On trobar imatges d'instal·lació">Secció 4.2.1, «On trobar imatges d'instal·lació»</a>). </p>
<p>The CD or DVD image you choose should be written directly to the USB stick, overwriting its current contents. For example, when using an existing GNU/Linux system, the CD or DVD image file can be written to a USB stick as follows, after having made sure that the stick is unmounted: </p>
<div class="informalexample"><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>cp <em class="replaceable"><code>debian.iso</code></em> /dev/<em class="replaceable"><code>sdX</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sync</code></strong>
</pre></div>
<p> Information about how to do this on other operating systems can be found in the <a class="ulink" href="https://www.debian.org/CD/faq/index.en.html#write-usb" target="_top">Debian CD FAQ</a>. </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>La imatge s'ha d'escriure en un disc sencer i no en una partició, p. ex. /dev/sdb and not /dev/sdb1. No faceu servir eines del tipus <span class="command"><strong>unetbootin</strong></span> que modifiquen la imatge. </p></td></tr>
</table></div>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>Escrivint la imatge CD o DVD en una memòria USB hauria d'ésser suficient per a la majoria d'usuaris. Les altres opcions descrites a continuació, són més complexes i van dirigides a aquelles persones amb exigències especials. </p></td></tr>
</table></div>
<p>La imatge híbrida en una memòria USB no ocupa tota la capacitat disponible, de manera que pot valer la pena fer servir l'espai lliure per a fitxers de microprogramari («firmware») o paquets o altres fitxers de la vostra elecció. Vos pot ésser útil si només disposau d'una memòria USB o bé voleu fer servir la memòria per altres coses. </p>
<p>Generau una segona partició FAT en la memòria USB, monteu la partició i copiau o descomprimiu el microprogramari en ella. Per exemple: </p>
<div class="informalexample"><pre class="screen"># mount /dev/<em class="replaceable"><code>sdX2</code></em> /mnt
# cd /mnt
# tar zxvf <em class="replaceable"><code>adreça a</code></em>firmware.tar.gz
# cd /
# umount /mnt
</pre></div>
<p>

</p>
<p>És possible que el <code class="filename">mini.iso</code> estigui escrit en la memòria USB. En aquest cas, la segona partició no s'ha de generar atès que ja estarà present. Desconnectant i tornant a connectar la memòria USB es podrà fer visibles les dues particions. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-easy"></a>4.3.2. Copiar manualment els fitxers en la memòria USB</h3></div></div></div>
<p>Una possibilitat alternativa per a preparar la vostra memòria USB és copiant-hi els fitxers de l'instal·lador i també una imatge de CD. Fixeu-vos que el llapis USB ha de tenir una mida mínima de 1 GiB (és possible configurar un llapis amb menys capacitat com es descriu a la <a class="xref" href="ch04s03.html#usb-copy-flexible" title="4.3.3. Còpia dels fitxers — la manera flexible">Secció 4.3.3, «Còpia dels fitxers — la manera flexible»</a>). </p>
<p>Hi ha un fitxer complet <code class="filename">hd-media/boot.img.gz</code> que conté tots el fitxers de l'instal·lador (incloent el nucli) <span class="phrase"> així com <span class="command"><strong>syslinux</strong></span> i el seu fitxer de configuració</span>. </p>
<p>Fixeu-vos que, tot i semblar còmode, aquest mètode té un desavantatge: la mida lògica del dispositiu estarà limitada a 1 GiB, encara que la capacitat del llapis USB sigui superior. Si voleu utilitzar-lo per a altres propòsits haureu de tornar a partir el llapis USB i generar nous sistemes de fitxers per disposar de tota la seva capacitat. </p>
<p>Per utilitzar aquesta imatge heu d'extreure-la directament al llapis USB: </p>
<div class="informalexample"><pre class="screen"># zcat boot.img.gz &gt; /dev/<em class="replaceable"><code>sdX</code></em>
</pre></div>
<p>

</p>
<p>Després d'això, munteu el llapis de memòria USB <span class="phrase">(<strong class="userinput"><code>mount /dev/<em class="replaceable"><code>sdX</code></em> /mnt</code></strong>),</span> que ara tindrà <span class="phrase">un sistema de fitxers FAT,</span> i copieu-hi una imatge  Debian ISO («netinst» o un CD complet). Finalment, desmunteu el llapis (<strong class="userinput"><code>umount /mnt</code></strong>) i ja esteu preparats. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-flexible"></a>4.3.3. Còpia dels fitxers — la manera flexible</h3></div></div></div>
<p>Si voleu més flexibilitat o voleu saber que esteu fent, heu de seguir aquest mètode per posar els fitxers al vostre llapis. Un avantatge d'utilitzar aquest mètode és que, si el llapis USB té prou capacitat, podreu copiar-hi una imatge ISO, fins i tot una imatge DVD, </p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="idm816"></a>4.3.3.1. Fer particions a un llapis USB</h4></div></div></div>
<p>Mostrarem com configurar un llapis de memòria per utilitzar la primera partició d'aquest, en comptes del dispositiu complet. </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Nota]" src="images/note.png"></td>
<th align="left">Nota</th>
</tr>
<tr><td align="left" valign="top">
<p>La major part dels llapis USB venen preconfigurats amb una única partició FAT16, així que en general no serà necessari tornar a partir o tornar a formatar-lo. Si heu de fer-ho, utilitzeu el <span class="command"><strong>cfdisk</strong></span> o qualsevol altra eina per fer la partició FAT16<a href="#ftn.idm822" class="footnote" name="idm822"><sup class="footnote">[3]</sup></a>, i aleshores generau el sistema de fitxers fent: </p>
<div class="informalexample"><pre class="screen">
# install-mbr /dev/<em class="replaceable"><code>sdX</code></em>
</pre></div>
<p> L'ordre <span class="command"><strong>install-mbr</strong></span> està en el paquet <code class="classname">mbr</code> de Debian. Per a generar el sistema de fitxers, feu servir: </p>
<div class="informalexample"><pre class="screen">
# mkdosfs /dev/<em class="replaceable"><code>sdX1</code></em>
</pre></div>
<p> Aneu amb compte d'utilitzar el nom del dispositiu correcte pel vostre llapis USB. L'ordre <span class="command"><strong>mkdosfs</strong></span> és al paquet Debian <code class="classname">dosfstools</code>. </p>
</td></tr>
</table></div>
<p>Per arrencar el nucli després d'arrencar des del llapis USB, posarem un carregador d'arrencada al llapis. Malgrat que hauria de funcionar qualsevol carregador (p.ex. <span class="command"><strong>LILO</strong></span>), és convenient utilitzar <span class="command"><strong>syslinux</strong></span>, ja que utilitza una partició FAT16 i pot reconfigurar-se editant tan sols un fitxer de text. Qualsevol sistema operatiu que suporti el sistema de fitxers FAT pot utilitzar-se per canviar la configuració del carregador d'arrencada. </p>
<p>Per posar el <span class="command"><strong>syslinux</strong></span> a la partició FAT16 del vostre llapis USB, instal·leu els paquets <code class="classname">syslinux</code> i <code class="classname">mtools</code> al vostre sistema i executeu: </p>
<div class="informalexample"><pre class="screen">
# syslinux /dev/<em class="replaceable"><code>sdX1</code></em>
</pre></div>
<p> Altra vegada, aneu amb compte i utilitzeu el nom correcte per al dispositiu. La partició no hauria d'estar muntada quan executeu l'ordre <span class="command"><strong>syslinux</strong></span>. Aquest procediment escriu un sector d'arrencada a la partició i genera el fitxer <code class="filename">ldlinux.sys</code> que conté el codi del carregador d'arrencada. </p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="idm847"></a>4.3.3.2. Com afegir la imatge de l'instal·lador</h4></div></div></div>
<p>Munteu la partició (<strong class="userinput"><code>mount /dev/<em class="replaceable"><code>sdX1</code></em> /mnt</code></strong>) i copieu els següents fitxers de la imatge de l'instal·lador al llapis: </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p> <code class="filename">vmlinuz</code> o <code class="filename">linux</code> (imatge del nucli) </p></li>
<li class="listitem"><p> <code class="filename">initrd.gz</code> (imatge inicial del disc RAM) </p></li>
</ul></div>
<p> Podeu escollir entre la versió normal de l'instal·lador o la seua versió gràfica. Podeu trobar la darrera al subdirectori <code class="filename">gtk</code>. Si voleu reanomenar els fitxers, tingueu en compte que <code class="classname">syslinux</code> només pot processar noms de fitxer de DOS (8.3). </p>
<p>A continuació heu de generar un fitxer de configuració <code class="filename">syslinux.cfg</code> que haurà de contenir com a mínim les dues línies següents (canvieu-hi el nom del nucli binari a <span class="quote">«<span class="quote"><code class="filename">linux</code></span>»</span> si heu emprat una imatge <code class="filename">netboot</code>): </p>
<div class="informalexample"><pre class="screen">
default vmlinuz initrd=initrd.gz
</pre></div>
<p> Per a emprar l'instal·lador gràfic heu d'afegir <strong class="userinput"><code>vga=788</code></strong> a la segona línia. Es poden afegir altres paràmetres si ho desitjau. </p>
<p>Per habilitat l'indicador d'arrencada per a permetre afegir paràmetres addicionals, afegiu la línia <strong class="userinput"><code>prompt 1</code></strong>. </p>
<p>Si heu emprat una imatge <code class="filename">hd-media</code>, ara heu de copiar una imatge ISO de Debian<a href="#ftn.idm874" class="footnote" name="idm874"><sup class="footnote">[4]</sup></a> al llapis. Quan hàgeu acabat, desmunteu el llapis de memòria USB (<strong class="userinput"><code>umount /mnt</code></strong>). </p>
</div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div id="ftn.idm822" class="footnote"><p><a href="#idm822" class="para"><sup class="para">[3] </sup></a>Recordeu-vos d'activar l’indicador de partició arrencable <span class="quote">«<span class="quote">bootable</span>»</span>.</p></div>
<div id="ftn.idm874" class="footnote"><p><a href="#idm874" class="para"><sup class="para">[4] </sup></a> Podeu emprar una imatge «netinst» o una de CD complet (vegeu <a class="xref" href="ch04s01.html" title="4.1. Conjunt de CD-ROM oficials de Debian GNU/Linux">Secció 4.1, «Conjunt de CD-ROM oficials de Debian GNU/Linux»</a>). Assegureu-vos d'emprar-ne una que hi càpiga. Adoneu-vos que la imatge <span class="quote">«<span class="quote">netboot <code class="filename">mini.iso</code></span>»</span> no és vàlida per a aquest propòsit.</p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch04s02.html"><img src="images/prev.png" alt="Anterior"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch04.html"><img src="images/up.png" alt="Pujar"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch04s04.html"><img src="images/next.png" alt="Següent"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">4.2. Descarregar fitxers de les rèpliques de Debian </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Inici"></a></td>
<td width="40%" align="right" valign="top"> 4.4. Preparació dels fitxers per arrencar des del disc dur</td>
</tr>
</table>
</div>
</body>
</html>
