<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>8.6. Kompilace nového jádra</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="Debian GNU/Linux — instalační příručka">
<link rel="up" href="ch08.html" title="Kapitola 8. Co dál?">
<link rel="prev" href="ch08s05.html" title="8.5. Nastavení poštovního systému">
<link rel="next" href="ch08s07.html" title="8.7. Obnovení poškozeného systému">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">8.6. Kompilace nového jádra</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch08s05.html"><img src="images/prev.png" alt="Předcházející"></a> </td>
<th width="60%" align="center">Kapitola 8. Co dál?</th>
<td width="20%" align="right"> <a accesskey="n" href="ch08s07.html"><img src="images/next.png" alt="Další"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="kernel-baking"></a>8.6. Kompilace nového jádra</h2></div></div></div>
<p>

Proč byste si chtěli sestavit nové jádro? Obvykle nejde o
nutnost, poněvadž jádro dodávané s Debianem funguje ve většině
počítačů. V Debianu také bývají dostupná alternativní jádra, která
mohou odpovídat vašemu hardwaru lépe než jádro výchozí, takže byste se
na ně určitě měli podívat. Nicméně nové jádro může být užitečné
v následujících situacích:

</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>

Potřebujete vyřešit hardwarový konflikt zařízení nebo speciální nároky
hardwaru, které dodávané jádro nezvládne.

</p></li>
<li class="listitem"><p>

Ve standardním jádře postrádáte podporu zařízení nebo nějakou službu
(např. podporu vysoké paměti).

</p></li>
<li class="listitem"><p>

Chcete menší jádro bez ovladačů, které nepoužíváte. Urychlíte start
systému a ušetříte paměť.

</p></li>
<li class="listitem"><p>

Chcete monolitické jádro místo modulárního.

</p></li>
<li class="listitem"><p>

Chcete jádro z vývojové řady.

</p></li>
<li class="listitem"><p>

Chcete se o jádře dozvědět něco víc.

</p></li>
</ul></div>
<p>

</p>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="idm3250"></a>8.6.1. Správa jader</h3></div></div></div>
<p>

Nebojte se kompilace jádra, je to zábava a budete z ní mít užitek.

</p>
<p>

Doporučený způsob kompilace jádra v Debianu vyžaduje tyto balíky:
<code class="classname">fakeroot</code>, <code class="classname">kernel-package</code>,
<code class="classname">linux-source-2.6</code> a další, které
již máte patrně nainstalované (úplný seznam je v souboru
<code class="filename">/usr/share/doc/kernel-package/README.gz</code>).

</p>
<p>

Tato metoda vytvoří ze zdrojových textů jádra .deb balíček, a jestliže
používáte nestandardní moduly, taktéž z nich vyrobí aktuální balíčky.
Při instalaci balíčku se do adresáře <code class="filename">/boot</code> uloží
pěkně pohromadě jádro, mapa symbolů <code class="filename">System.map</code> a
aktuální konfigurace.

</p>
<p>

Jádro <span class="emphasis"><em>nemusíte</em></span> připravovat touto cestou, ale
domníváme se, že s využitím balíčkovacího softwaru se proces
zjednoduší a je také bezpečnější. Místo balíku
<code class="classname">linux-source-2.6</code>
si klidně můžete stáhnout poslední zdrojové texty jádra přímo od
Linuse.

</p>
<p>

Popis balíku <code class="classname">kernel-package</code> se nachází v
adresáři <code class="filename">/usr/share/doc/kernel-package</code>.
V následujících odstavcích najdete jen stručný úvod k jeho použití.

</p>
<p>

V dalším budeme předpokládat, že zdrojové texty jádra verze
3.16 uložíte někam do svého domovského adresáře.<a href="#ftn.idm3268" class="footnote" name="idm3268"><sup class="footnote">[25]</sup></a>

Přejděte do adresáře, kde chcete mít zdrojové texty jádra
(<strong class="userinput"><code>cd <em class="replaceable"><code>~/build</code></em></code></strong>),
rozbalte archiv (<strong class="userinput"><code>tar xf
/usr/src/linux-source-3.16.tar.xz</code></strong>) a vejděte
do vzniklého adresáře (<strong class="userinput"><code>cd
linux-source-3.16/</code></strong>).

</p>
<p>

V prostředí X11 nakonfigurujte jádro příkazem <strong class="userinput"><code>make
xconfig</code></strong>, nebo v terminálu příkazem <strong class="userinput"><code>make
menuconfig</code></strong> (musíte mít nainstalovaný balíček
<code class="classname">ncurses-dev</code>). Pročtěte si nápovědu a pozorně
vybírejte z nabízených možností. Pokud si v některém bodu nebudete
vědět rady, je většinou lepší zařízení do jádra vložit. Volby, kterým
nerozumíte a které se nevztahují k hardwaru, raději nechte na
přednastavených hodnotách. Nezapomeňte do jádra zahrnout <span class="quote">„<span class="quote">Kernel
module loader</span>“</span> (tj. automatické vkládání modulů) v sekci
<span class="quote">„<span class="quote">Loadable module support</span>“</span>, které přednastavené nebývá,
avšak Debian tuto službu předpokládá.

</p>
<p>

Příkazem <strong class="userinput"><code>make-kpkg clean</code></strong> pročistíte strom
zdrojových textů a vynulujete předchozí nastavení balíku
<code class="classname">kernel-package</code>.

</p>
<p>

Kompilaci jádra provedete příkazem <strong class="userinput"><code>fakeroot
make-kpkg --initrd --revision=<em class="replaceable"><code>1.0.moje</code></em>
kernel_image</code></strong>. Číslo verze <span class="quote">„<span class="quote">1.0.moje</span>“</span> si
můžete zvolit podle vlastní úvahy, slouží pouze k vaší orientaci
v připravených balících. Kompilace zabere chvíli času, záleží na
výpočetním výkonu vašeho počítače.

</p>
<p>

Až kompilace skončí, jádro nainstalujete jako každý jiný balík. Jako
root napište <strong class="userinput"><code>dpkg -i
../linux-image-3.16-<em class="replaceable"><code>podarchitektura</code></em>_1.0.moje_amd64.deb</code></strong>.
<em class="replaceable"><code>podarchitektura</code></em> je volitelné upřesnění
architektury, <span class="phrase"> např. <span class="quote">„<span class="quote">686</span>“</span>,
</span> které jste zadali při konfiguraci
jádra. <strong class="userinput"><code>dpkg -i</code></strong> nainstaluje jádro spolu
s doprovodnými soubory. Jedná se třeba o soubory
<code class="filename">System.map</code>, který je užitečný při dohledávání
problémů v jádře, a <code class="filename">/boot/config-3.16</code>
obsahující konfigurační soubor jádra. Balík s jádrem je dostatečně
chytrý, takže během instalace upraví zavaděč tak, aby implicitně
používal nové jádro. Pokud jste vytvořili balík s moduly (třeba PCMCIA
nebo lm-sensors), je nanejvýš vhodné ho také nainstalovat.

</p>
<p>

Nyní je čas spustit systém s novým jádrem. Projděte si chybové hlášky,
které se mohly při instalaci jádra vyskytnout, a pokud vše vypadá
dobře, restartujte příkazem <strong class="userinput"><code>shutdown -r now</code></strong>.

</p>
<p>

Více informací o debianích jádrech a o kompilaci jader si můžete
přečíst v <a class="ulink" href="https://kernel-team.pages.debian.net/kernel-handbook/" target="_top">Debian Linux Kernel Handbook</a>.
Popis balíku <code class="classname">kernel-package</code> najdete v adresáři
<code class="filename">/usr/share/doc/kernel-package</code>.

</p>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div id="ftn.idm3268" class="footnote"><p><a href="#idm3268" class="para"><sup class="para">[25] </sup></a>

Existují i jiná místa, kam můžete zdrojové texty jádra rozbalit, ale
použitá možnost je nejjednodušší a nevyžaduje žádná speciální práva.

</p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch08s05.html"><img src="images/prev.png" alt="Předcházející"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch08.html"><img src="images/up.png" alt="Nahoru"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch08s07.html"><img src="images/next.png" alt="Další"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">8.5. Nastavení poštovního systému </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Domů"></a></td>
<td width="40%" align="right" valign="top"> 8.7. Obnovení poškozeného systému</td>
</tr>
</table>
</div>
</body>
</html>
