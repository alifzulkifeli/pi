<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>B.4. Obsah souboru s přednastavením (pro buster)</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="Debian GNU/Linux — instalační příručka">
<link rel="up" href="apb.html" title="Příloha B. Automatizování instalací pomocí přednastavení">
<link rel="prev" href="apbs03.html" title="B.3. Vytvoření souboru s přednastavením">
<link rel="next" href="apbs05.html" title="B.5. Pokročilé možnosti">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">B.4. Obsah souboru s přednastavením (pro buster)</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="apbs03.html"><img src="images/prev.png" alt="Předcházející"></a> </td>
<th width="60%" align="center">Příloha B. Automatizování instalací pomocí přednastavení</th>
<td width="20%" align="right"> <a accesskey="n" href="apbs05.html"><img src="images/next.png" alt="Další"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="preseed-contents"></a>B.4. Obsah souboru s přednastavením (pro buster)</h2></div></div></div>
<p>

Útržky konfigurace použité v této části jsou také dostupné jako
samostatný soubor na <span class="phrase"><a class="ulink" href="../example-preseed.txt" target="_top">../example-preseed.txt</a></span>.

</p>
<p>

Tento příklad je založen na instalaci pro architekturu Intel
x86. Jestliže instalujete na jinou architekturu, nemusí některá
nastavení odpovídat těm uvedeným (výběr klávesnice, instalace
zavaděče) a budete je muset nahradit adekvátními hodnotami.

</p>
<p>

Podrobnosti o tom, jak jednotlivé komponenty instalačního systému
pracují, naleznete v kapitole <a class="xref" href="ch06s03.html" title="6.3. Použití jednotlivých komponent">6.3 – „Použití jednotlivých komponent“</a>.

</p>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-l10n"></a>B.4.1. Lokalizace</h3></div></div></div>
<p>

Nastavení lokalizačních proměnných bude fungovat pouze v případě, když
používáte přednastavení přes initrd, nebo pomocí zaváděcích parametrů
jádra. U ostatních způsobů se totiž soubor s přednastavením nahraje až
po zobrazení těchto otázek.

Výjimkou je automatický režim (<a class="xref" href="apbs02.html#preseed-auto" title="B.2.3. Automatický režim">B.2.3 – „Automatický režim“</a>), který
odsune otázky ohledně lokalizace na později a umožní je tak
přednastavit všemi známými způsoby.

</p>
<p>

Místní prostření (locale) slouží k současnému zadání jazyka
i země. Například pomocí zaváděcího parametru jádra můžete zadat
<strong class="userinput"><code>locale=<em class="replaceable"><code>cs_CZ</code></em></code></strong>.

</p>
<p>

Tento způsob je velice jednoduchý, ale neumožňuje přednastavit všechny
možné kombinace jazyka, země a místního prostředí<a href="#ftn.idm3768" class="footnote" name="idm3768"><sup class="footnote">[27]</sup></a>. Volitelně tedy můžete přednastavit jednotlivé
proměnné.

</p>
<div class="informalexample"><pre class="screen">
# Přednastavením locale se automaticky nastaví jazyk, země a locale.
d-i debian-installer/locale string cs_CZ

# Pro větší pružnost je též možno nastavit hodnoty samostatně.
#d-i debian-installer/language string en
#d-i debian-installer/country string NL
#d-i debian-installer/locale string en_GB.UTF-8
# Volitelně můžete zadat další locale, která se mají vygenerovat.
#d-i localechooser/supported-locales multiselect cs_CZ.UTF-8, en_US.UTF-8
</pre></div>
<p>

Zadat můžete libovolnou kombinaci jazyka podporovaného v <code class="classname">debian-installer</code>
a země. Pokud kombinace netvoří platné prostředí, vybere instalační
systém kombinaci tak, že se pokusí zachovat jazyk a k němu vybere
platnou zemi.

</p>
<p>

Nastavení klávesnice se skládá z výběru klávesové mapy a přepínače
mezi zvolenou mapou a US variantou. Během instalace jsou dostupné
pouze základní klávesové mapy. Ostatní dostupné varianty naleznete až
v nainstalovaném systému příkazem <span class="command"><strong>dpkg-reconfigure
keyboard-configuration</strong></span>.

</p>
<div class="informalexample"><pre class="screen">
# Výběr klávesnice.
d-i keyboard-configuration/xkb-keymap select cz
# d-i keyboard-configuration/toggle select No toggling
</pre></div>
<p>

</p>
<p>

Nastavení klávesnice můžete přeskočit nastavením proměnné
<code class="classname">keymap</code> na hodnotu
<strong class="userinput"><code>skip-config</code></strong>. Tím se zachová výchozí klávesová
mapa jádra.

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-network"></a>B.4.2. Nastavení sítě</h3></div></div></div>
<p>

Pokud nahráváte soubor s přednastavením ze sítě, pak následující
samozřejmě nebude fungovat! V takovém případě zadejte potřebné
parametry sítě zavaděči jádra. Zavádíte-li z CD nebo USB, bude
nastavení fungovat bez problémů.

</p>
<p>

Potřebujete-li při zavádění ze sítě vybrat konkrétní síťové rozhraní
ještě před nahráním souboru s přednastavením, použijte zaváděcí
parametr
<strong class="userinput"><code>interface=<em class="replaceable"><code>eth1</code></em></code></strong>.

</p>
<p>

Přestože přednastavení síťování není běžně dostupné při přednastavení
ze sítě (tj. při použití <span class="quote">„<span class="quote">preseed/url</span>“</span>), můžete to obejít
následujícím hackem (např. pokud chcete síťovému rozhraní nastavit
statickou adresu). Hack spočívá ve vynucení opětovné konfigurace sítě
po načtení souboru s přednastavením. Stačí vytvořit skript pro
<span class="quote">„<span class="quote">preseed/run</span>“</span> obsahující následující příkazy:

</p>
<div class="informalexample"><pre class="screen">
kill-all-dhcp; netcfg
</pre></div>
<p>

</p>
<p>

Pro nastavení sítě lze využít následující proměnné:

</p>
<div class="informalexample"><pre class="screen">
# Kompletně zakáže nastavení sítě. Hodí se pro instalace z CD
# na nezasíťovaných zařízeních, kde by byly síťové otázky,
# varování o nedostupné síti a dlouhé čekací doby na obtíž.
#d-i netcfg/enable boolean false

# netcfg zkusí použít rozhraní, jehož druhý konec je aktivní
# a tím pádem přeskočí výběr ze seznamu nalezených rozhraní.
d-i netcfg/choose_interface select auto

# Výběr konkrétního síťového rozhraní:
#d-i netcfg/choose_interface select eth1

# Rozpoznání aktivního síťového připojení může někdy trvat déle než
# výchozí 3 sekundy. V takovém případě pomůže zvýšení této hodnoty.
#d-i netcfg/link_wait_timeout string 10

# Máte-li pomalejší dhcp server a instalačnímu systému vyprší čas při
# čekání na odpověď, bude užitečné následující.
#d-i netcfg/dhcp_timeout string 60
#d-i netcfg/dhcpv6_timeout string 60

# Pokud dáváte přednost ručnímu nastavení sítě:
#d-i netcfg/disable_autoconfig boolean true

# Má-li tento soubor s přednastavením fungovat na systémech s i bez
# dhcp serveru, odkomentujte následující řádky a také statické
# nastavení sítě níže.
#d-i netcfg/dhcp_failed note
#d-i netcfg/dhcp_options select Configure network manually

# Statické nastavení sítě.
#
# Příklad IPv4
#d-i netcfg/get_ipaddress string 192.168.1.42
#d-i netcfg/get_netmask string 255.255.255.0
#d-i netcfg/get_gateway string 192.168.1.1
#d-i netcfg/get_nameservers string 192.168.1.1
#d-i netcfg/confirm_static boolean true
#
# Příklad IPv6
#d-i netcfg/get_ipaddress string fc00::2
#d-i netcfg/get_netmask string ffff:ffff:ffff:ffff::
#d-i netcfg/get_gateway string fc00::1
#d-i netcfg/get_nameservers string fc00::1
#d-i netcfg/confirm_static boolean true

# Název počítače a domény přiřazené přes DHCP mají větší prioritu než
# hodnoty nastavené zde, nicméně takto máte jistotu, že tato otázka
# nezobrazí (ať už nastavení z DHCP obdržíme nebo ne).
d-i netcfg/get_hostname string nenastavene-jmeno
d-i netcfg/get_domain string nenastavena-domena

# Chcete-li vynutit konkrétní název počítače bez ohledu na to, co
# nabídne DHCP server, odkomentujte následující řádku.
#d-i netcfg/hostname string nejakejmeno

# Zakáže otravný dialog o WEP klíči.
d-i netcfg/wireless_wep string
# Praštěné DHCP jméno počítače, které používají někteří ISP jako heslo.
#d-i netcfg/dhcp_hostname string radish

# Pokud síťová karta nebo jiný hardware vyžaduje nesvobodný firmware,
# můžete říct instalátoru, aby se vždy pokusil firmware nahrát bez
# dalšího dotazování. Chcete-li nahrávání i dotazování zakázat,
# nastavte na hodnotu false.
#d-i hw-detect/load_firmware boolean true
</pre></div>
<p>

Pokud není proměnná <code class="classname">netcfg/get_netmask</code>
přednastavená, <span class="command"><strong>netcfg</strong></span> si síťovou masku dopočítá
automaticky. Pro plně automatické instalace musíte v takovém případě
nastavit proměnnou jako <code class="literal">seen</code>, aby instalace
nečekala na potvrzení spočítané masky. Obdobně je možné
nepřednastavovat proměnnou <code class="classname">netcfg/get_gateway</code> a
nechat <span class="command"><strong>netcfg</strong></span>, aby automaticky  automaticky odhadl
adresu brány. Jako speciální případ je možné nastavit proměnnou
<code class="classname">netcfg/get_gateway</code> na hodnotu <span class="quote">„<span class="quote">none</span>“</span>,
což znamená, že se brána nemá použít vůbec.

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-network-console"></a>B.4.3. Síťová konzole</h3></div></div></div>
<div class="informalexample"><pre class="screen">
# Následující nastavení se hodí v situacích, kdy chcete instalovat
# vzdáleně přes SSH pomocí komponenty network-console.
# Toto přednastavení má smysl pouze pokud plánujete dokončit
# instalaci ručně.
#d-i anna/choose_modules string network-console
#d-i network-console/authorized_keys_url string http://10.0.0.1/openssh-key
#d-i network-console/password password r00tme
#d-i network-console/password-again password r00tme
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-mirror"></a>B.4.4. Nastavení zrcadla</h3></div></div></div>
<p>

V závislosti na způsobu instalace můžete zrcadlo použít pro stažení
dodatečných komponent instalačního systému, stažení základního systému
a pro nastavení souboru <code class="filename">/etc/apt/sources.list</code>.

</p>
<p>

Parametr <code class="classname">mirror/suite</code> určuje verzi
instalovaného systému.

</p>
<p>

Parametr <code class="classname">mirror/udeb/suite</code> určuje verzi
Debianu, ze které se stáhnou dodatečné komponenty instalačního
systému. Nastavení této proměnné má smysl pouze v případě, že
komponenty stahujete ze sítě a potřebujete, aby odpovídaly verzi
initrd, který se používá pro instalaci. Instalační systém obvykle
zvolí správnou hodnotu, takže by neměl být důvod tuto proměnnou
měnit.

</p>
<div class="informalexample"><pre class="screen">
# Zvolíte-li ftp, nemusíte nastavovat mirror/country
#d-i mirror/protocol string ftp
d-i mirror/country string manual
d-i mirror/http/hostname string ftp.cz.debian.org
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Verze pro instalaci.
#d-i mirror/suite string testing
# Verze, ze které nahrát komponenty instalátoru (volitelné).
#d-i mirror/udeb/suite string testing
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-account"></a>B.4.5. Nastavení účtů</h3></div></div></div>
<p>

Instalační systém umožňuje přednastavit jak heslo uživatele root, tak
jméno a heslo prvního běžného uživatele systému. Heslo můžete zadat
buď v nešifrované podobě, nebo jako crypt(3) <span class="emphasis"><em>hash</em></span>.

</p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Varování]" src="images/warning.png"></td>
<th align="left">Varování</th>
</tr>
<tr><td align="left" valign="top"><p>

Přednastavení hesel není bezpečné, protože kdokoliv s přístupem
k souboru s přednastavením si tato hesla může přečíst. Z pohledu
bezpečnosti je použití hashů lepší, ovšem vzhledem k možným útokům
hrubou silou je třeba zvolit silný algoritmus jako SHA-256 nebo
SHA512. Dřívější hashovací algoritmy jako DES a MD5 jsou považovány za
slabé.

</p></td></tr>
</table></div>
<div class="informalexample"><pre class="screen">
# Přeskočí vytvoření účtu pro roota (běžný uživatel bude moci použít
# sudo).
#d-i passwd/root-login boolean false
# Volitelně přeskočí vytvoření běžného uživatelského účtu.
#d-i passwd/make-user boolean false

# Rootovo heslo v čitelném tvaru
#d-i passwd/root-password password r00tme
#d-i passwd/root-password-again password r00tme
# nebo šifrované pomocí crypt(3) hashe.
#d-i passwd/root-password-crypted password [crypt(3) hash]

# Vytvoření účtu běžného uživatele.
#d-i passwd/user-fullname string Jan Novak
#d-i passwd/username string jan
# Heslo běžného uživatele v čitelném tvaru
#d-i passwd/user-password password nebezpecne
#d-i passwd/user-password-again password nebezpecne
# nebo šifrované pomocí crypt(3) hashe.
#d-i passwd/user-password-crypted password [crypt(3) hash]
# Nastaví UID běžného uživatele (jinak se použije výchozí hodnota).
#d-i passwd/user-uid string 1010
# Uživatelský účet bude automaticky přidán do několika standardních
# skupin. Chcete-li to změnit, zadejte seznam požadovaných skupin.
#d-i passwd/user-default-groups string audio cdrom video
</pre></div>
<p>

Do proměnných <code class="classname">passwd/root-password-crypted</code> a
<code class="classname">passwd/user-password-crypted</code> můžete jako
hodnotu zadat znak vykřičník <span class="quote">„<span class="quote">!</span>“</span>, což znamená, že daný
účet bude zakázán. To se může hodit například pro účet root, což ovšem
předpokládá, že máte nastavenu nějakou jinou možnost, jak počítač
spravovat (například pomocí <span class="command"><strong>sudo</strong></span> nebo autentizace
přes SSH klíče).

</p>
<p>

SHA-512 hash hesla můžete vygenerovat následujícím příkazem (z balíku
<code class="classname">whois</code>):

</p>
<div class="informalexample"><pre class="screen">
mkpasswd -m sha-512
</pre></div>
<p>

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-time"></a>B.4.6. Nastavení hodin a časového pásma</h3></div></div></div>
<div class="informalexample"><pre class="screen">
# Určuje, zda jsou hardwarové hodiny nastaveny na UTC.
d-i clock-setup/utc boolean true

# Proměnnou můžete nastavit na libovolnou platnou hodnotu $TZ;
# Seznam časových pásem naleznete v /usr/share/zoneinfo/.
d-i time/zone string Europe/Prague

# Určuje, zda se mají při instalaci nastavit hodiny pomocí NTP.
d-i clock-setup/ntp boolean true
# NTP server, který se má použít. Výchozí hodnota je většinou
# dostačující.
#d-i clock-setup/ntp-server string tak.cesnet.cz
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-partman"></a>B.4.7. Rozdělení disku</h3></div></div></div>
<p>

Dělení disku je víceméně omezeno možnostmi, které nabízí
<code class="classname">partman-auto</code>. Můžete zvolit rozdělení buď
stávajícího volného místa, nebo celého disku. Rozvržení oblastí můžete
určit pomocí předdefinovaného schematu, vlastního schematu ze
souboru nebo schematu obsaženém v souboru s přednastavením.

</p>
<p>

Přednastavení pokročilejších konfigurací s RAIDem, LVM a šifrováním je
sice podporováno, ale ne s takovými možnostmi, jako při ručním dělení.

</p>
<p>

Příklady níže ukazují jen základní použití schemat. Podrobnější
informace naleznete v souborech
<code class="filename">partman-auto-recipe.txt</code> a
<code class="filename">partman-auto-raid-recipe.txt</code>, které jsou součástí
balíku <code class="classname">debian-installer</code>. Oba soubory jsou též
dostupné ze <a class="ulink" href="https://salsa.debian.org/installer-team/debian-installer/tree/master/doc/devel" target="_top">zdrojového
repositáře <code class="classname">debian-installer</code></a>. Poznamenejme, že podporovaná funkcionalita
se může mezi jednotlivými vydáními lišit.

</p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Varování]" src="images/warning.png"></td>
<th align="left">Varování</th>
</tr>
<tr><td align="left" valign="top"><p>

Označení disků závisí na pořadí, ve kterém jsou nahrány jejich
ovladače. Jestliže se v systému nachází více disků, tak se ubezpečte,
že jste vybrali ten správný.

</p></td></tr>
</table></div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="preseed-partman-example"></a>B.4.7.1. Příklad dělení disku</h4></div></div></div>
<div class="informalexample"><pre class="screen">
# Má-li systém nějaké volné místo, můžete si vybrat, zda chcete
# automaticky rozdělit pouze toto volné místo. To však funguje pouze
# pokud není nastavena proměnná partman-auto/method (níže).
#d-i partman-auto/init_automatically_partition select biggest_free

# Alternativně můžete zadat k automatickému dělení celý disk.
# Obsahuje-li systém pouze jediný disk, použije se tento automaticky.
# V opačném případě musíte zadat název příslušného zařízení
# v tradičním formátu a ne ve formátu devfs (tj. musíte zadat něco
# jako /dev/sda, ne /dev/discs/disc0/disc).
# Například pro použití prvního SCSI/SATA disku:
#d-i partman-auto/disk string /dev/sda
#
# Dále musíte zvolit metodu, která se má použít. Momentálně jsou
# dostupné metody
# - regular: použije typ oblastí typický na vaší architektuře
# - lvm:     pro rozdělení disku použije LVM
# - crypto:  použije LVM nad zašifrovanou oblastí
d-i partman-auto/method string lvm

# Pokud některý z disků určených k automatickému rozdělení obsahuje
# pozůstatek z předchozího LVM, zobrazí se varování. Tímto můžete
# varování potlačit...
d-i partman-lvm/device_remove_lvm boolean true
# To stejné platí pro potvrzení při zápisu LVM oblastí.
d-i partman-lvm/confirm boolean true
d-i partman-lvm/confirm_nooverwrite boolean true
# A platí i pro odstranění pozůstatků předchozího softwarového RAIDu:
d-i partman-md/device_remove_md boolean true

# Můžete vybrat jedno ze tří připravených schémat dělení.
# - atomic: všechny soubory v jedné oblasti
# - home:   samostatná oblast /home
# - multi:  samostatné oblasti /home, /var a /tmp
d-i partman-auto/choose_recipe select atomic

# Nebo zadat váš vlastní návod na dělení...
# Pokud umíte do prostředí d-i dostat soubor s návodem na dělení,
# stačí na něj odkázat.
#d-i partman-auto/expert_recipe_file string /hd-media/recipe

# V opačném případě můžete zadat celý návod na jednu (logickou) řádku.
# Například vytvoříme malou oblast /boot, vhodný swap a zbytek
# použijeme jako kořenovou oblast:
#d-i partman-auto/expert_recipe string                         \
#      boot-root ::                                            \
#              40 50 100 ext3                                  \
#                      $primary{ } $bootable{ }                \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ /boot }                     \
#              .                                               \
#              500 10000 1000000000 ext3                       \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ / }                         \
#              .                                               \
#              64 512 300% linux-swap                          \
#                      method{ swap } format{ }                \
#              .

# Kompletní formát je popsán v souboru partman-auto-recipe.txt
# dostupném v balíku "debian-installer" nebo ve zdrojovém repositáři
# D-I. Soubor demonstruje použití i takových věcí, jako je pojmenování
# souborových systémů, pojmenování skupin svazků a určení, ze kterých
# fyzických zařízení se má skupina svazků skládat.

# Následujícím řeknete partmanu, aby disk rozdělil bez potvrzení.
# (Za předpokladu, že jste partmanu v předchozích krocích řekli,
# co má dělat.)
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

# Je-li povoleno šifrování disku, přeskočí úvodní vymazání oblastí.
#d-i partman-auto-crypto/erase_disks boolean false
</pre></div>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="preseed-partman-raid"></a>B.4.7.2. Rozdělení při použití RAIDu</h4></div></div></div>
<p>

Pomocí přednastavení též můžete nastavit oblasti na polích softwarového
RAIDu. Podporovány jsou RAID úrovně 0, 1, 5, 6 a 10, vytváření
degradovaných polí a určení rezervních zařízení.

</p>
<p>

Používáte-li RAID 1,
můžete podle části <a class="xref" href="apbs04.html#preseed-bootloader" title="B.4.11. Instalace zavaděče">B.4.11 – „Instalace zavaděče“</a> přednastavit
grub, aby se nainstaloval do všech zařízení v poli použitých.

</p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Varování]" src="images/warning.png"></td>
<th align="left">Varování</th>
</tr>
<tr><td align="left" valign="top"><p>

U tohoto typu automatického rozdělení se dá velice lehce něco
pokazit. Navíc se jedná o komponentu, kterou vývojáři <code class="classname">debian-installer</code> testují
relativně málo. Odpovědnost za správné zapsání návodu pro rozdělení
(aby dával smysl a nevytvářel konflikty) nese uživatel. V případě
problémů zkontrolujte <code class="filename">/var/log/syslog</code>.

</p></td></tr>
</table></div>
<div class="informalexample"><pre class="screen">
# Metoda by měla být nastavena na "raid".
#d-i partman-auto/method string raid
# Zadejte disky k rozdělení. Na všech bude nakonec stejné rozložení,
# takže to bude fungovat pouze pokud mají disky stejnou velikost.
#d-i partman-auto/disk string /dev/sda /dev/sdb

# Dále musíte zadat fyzické oblasti, které se mají použít.
#d-i partman-auto/expert_recipe string \
#      multiraid ::                                         \
#              1000 5000 4000 raid                          \
#                      $primary{ } method{ raid }           \
#              .                                            \
#              64 512 300% raid                             \
#                      method{ raid }                       \
#              .                                            \
#              500 10000 1000000000 raid                    \
#                      method{ raid }                       \
#              .

# Na závěr musíte zadat, jakým způsobem se mají dříve definované oblasti
# použít v nastavení RAIDu. Důležité je použít správná čísla logických
# oblastí. Podporovány jsou RAID úrovně 0, 1, 5, 6 a 10; zařízení jsou
# oddělena pomocí "#"
# Parametry jsou:
# &lt;typraidu&gt; &lt;početzařízení&gt; &lt;početrezerv&gt; &lt;typss&gt; &lt;přípbod&gt; \
#          &lt;zařízení&gt; &lt;rezervnízařízení&gt;

#d-i partman-auto-raid/recipe string \
#    1 2 0 ext3 /                    \
#          /dev/sda1#/dev/sdb1       \
#    .                               \
#    1 2 0 swap -                    \
#          /dev/sda5#/dev/sdb5       \
#    .                               \
#    0 2 0 ext3 /home                \
#          /dev/sda6#/dev/sdb6       \
#    .

# Více informací naleznete v souboru partman-auto-recipe.txt dostupném
# v balíku "debian-installer" nebo ve zdrojovém repositáři D-I.

# Toto zajistí, že se partman nebude při rozdělování ptát na potvrzení.
d-i partman-md/confirm boolean true
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
</pre></div>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="preseed-partman-mount-styles"></a>B.4.7.3. Způsob připojení oblastí</h4></div></div></div>
<p>

Souborové systémy se obvykle připojují pomocí jedinečného
univerzálního identifikátoru, tzv. UUID. To umožňuje korektní
připojení oblastí i v případech, kdy se změní jejich jména
zařízení. UUID jsou dlouhé a špatně se čtou, takže pokud si budete
přát, může instalátor připojit souborové systémy pomocí tradičních
jmen zařízení, nebo pomocí názvů oblastí, které jim přidělíte.
Zvolíte-li připojení pomocí názvů oblastí, budou oblasti bez
nastaveného názvu připojeny pomocí UUID.

</p>
<p>

Zařízení se stabilními jmény, jako např. logické svazky LVM, budou
místo UUID nadále používat připojení pomocí tradičních jmen zařízení.

</p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Varování]" src="images/warning.png"></td>
<th align="left">Varování</th>
</tr>
<tr><td align="left" valign="top"><p>

Tradiční jména zařízení se mohou měnit v závislosti na pořadí, ve
kterém jádro při zavádění zařízení objeví. To může způsobit připojení
chybného souborového systému. Podobný problém existuje v případě
použití názvů oblastí, protože při zapojení dalšího disku (i
externího) mohou použité názvy oblastí kolidovat a tím pádem není
zaručeno, která oblast se připojí.

</p></td></tr>
</table></div>
<div class="informalexample"><pre class="screen">
# Výchozí je připojování pomocí UUID, ale můžete zvolit též "traditional"
# pro použití tradičních jmen zařízení, nebo "label" pro použití názvů
# oblastí (se záchytnou možností použití UUID).
#d-i partman/mount_style select uuid
</pre></div>
</div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-base-installer"></a>B.4.8. Instalace základního systému</h3></div></div></div>
<p>

V této fázi instalace se toho moc nastavit nedá. Jediné otázky se
týkají instalace jádra.

</p>
<div class="informalexample"><pre class="screen">
# Nastaví APT, aby implicitně neinstaloval doporučené balíky. Použití
# této volby může znamenat instalaci nekompletního systému a měli by
# ji používat pouze zkušení uživatelé.
#d-i base-installer/install-recommends boolean false

# (Meta) balík jádra, který se má nainstalovat; nechcete-li instalovat
# žádné jádro, zadejte "none".
#d-i base-installer/kernel/image string linux-image-686
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-apt"></a>B.4.9. Nastavení APT</h3></div></div></div>
<p>

Nastavení souboru <code class="filename">/etc/apt/sources.list</code>
a několika základních parametrů je plně řízeno typem instalace
a dříve zodpovězenými otázkami. Volitelně můžete přidat další
(lokální) archivy.

</p>
<div class="informalexample"><pre class="screen">
# Můžete si zvolit instalaci softwaru ze sekcí non-free a contrib.
#d-i apt-setup/non-free boolean true
#d-i apt-setup/contrib boolean true
# Odkomentujte, pokud nechcete používat síťové zrcadlo.
#d-i apt-setup/use_mirror boolean false
# Vyberte, které aktualizační služby chcete využívat a zadejte
# jejich zrcadla. Příklad ukazuje výchozí hodnoty.
#d-i apt-setup/services-select multiselect security, updates
#d-i apt-setup/security_host string security.debian.org

# Další archivy, k dispozici jsou local[0-9]
#d-i apt-setup/local0/repository string \
#       http://muj.server/debian stable main
#d-i apt-setup/local0/comment string local server
# Povolí řádky deb-src
#d-i apt-setup/local0/source boolean true
# URL k veřejnému klíči lokálního archivu; Klíč musíte zadat, protože
# jinak si apt bude stěžovat na neautentizovaný archiv a příslušný
# řádek v sources.list zůstane zakomentovaný
#d-i apt-setup/local0/key string http://muj.server/klic

# Instalace vyžaduje, aby byly všechny repositáře autentizovány
# známým gpg klíčem. Tímto nastavením můžete autentizaci potlačit.
# Varování: Nebezpečné, není doporučeno.
#d-i debian-installer/allow_unauthenticated boolean true

# Odkomentujte pro přidání další architektury, zde i386
#d-i apt-setup/multiarch string i386
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-pkgsel"></a>B.4.10. Výběr balíků</h3></div></div></div>
<p>

Můžete nainstalovat libovolnou kombinaci dostupných úloh. V době psaní
to zahrnuje:

</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
  <strong class="userinput"><code>standard</code></strong> (standardní unixové nástroje)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>desktop</code></strong> (grafické prostředí)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>gnome-desktop</code></strong> (prostředí Gnome)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>xfce-desktop</code></strong> (prostředí XFCE)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>kde-desktop</code></strong> (prostředí KDE Plasma)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>cinnamon-desktop</code></strong> (prostředí Cinnamon)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>mate-desktop</code></strong> (prostředí MATE)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>lxde-desktop</code></strong> (prostředí LXDE)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>web-server</code></strong> (webový server)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>print-server</code></strong> (tiskový server)
</p></li>
<li class="listitem"><p>
  <strong class="userinput"><code>ssh-server</code></strong> (SSH server)
</p></li>
</ul></div>
<p>

Instalaci úloh můžete vynechat a instalovat balíky nějakou jinou
cestou. Úlohu <strong class="userinput"><code>standard</code></strong> však doporučujeme
instalovat vždy.

</p>
<p>

Chcete-li kromě balíků v úlohách instalovat také nějaké samostatné
balíky, můžete použít parametr <code class="classname">pkgsel/include</code>.
Hodnotou parametru je čárkami nebo mezerami oddělený seznam, takže jej
můžete jednoduše použít i na příkazové řádce jádra.

</p>
<div class="informalexample"><pre class="screen">
#tasksel tasksel/first multiselect standard, web-server, kde-desktop

# Samostatné balíky pro instalaci.
#d-i pkgsel/include string openssh-server build-essential
# Zda se mají balíky po rozbalení debootstrapem aktualizovat.
# Povolené hodnoty: none, safe-upgrade, full-upgrade
#d-i pkgsel/upgrade select none

# Některé verze instalačního systému mohou vývojářům Debianu hlásit
# seznam balíků, které jste nainstalovali, což pomáhá při
# rozhodování, který software je oblíbený a proto by měl být zařazen
# na CD. Výchozí hodnotou je zákaz posílání tohoto seznamu, ale měli
# byste zvážit jeho povolení.
#popularity-contest popularity-contest/participate boolean false
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-bootloader"></a>B.4.11. Instalace zavaděče</h3></div></div></div>
<div class="informalexample"><pre class="screen">
<span class="phrase">
# Výchozím zavaděčem (pro x86) je Grub. Chcete-li místo něj instalovat
# LILO, odkomentujte následující:
#d-i grub-installer/skip boolean true
# Jestliže chcete přeskočit také instalaci LILA a neinstalovat žádný
# zavaděč, odkomentujte ještě toto:
#d-i lilo-installer/skip boolean true
</span>


# Toto je bezpečné nastavení - pokud nenalezne jiný operační systém,
# nainstaluje Grub do MBR.
d-i grub-installer/only_debian boolean true

# Toto nainstaluje Grub do MBR i když nalezne jiný operační systém,
# což je méně bezpečné, protože se jiný systém nemusí zavést.
d-i grub-installer/with_other_os boolean true

# Kvůli potenciáním zapojeným USB klíčenkám nelze obecně bezpečně určit
# umístění MBR, takže je potřeba ho zadat:
#d-i grub-installer/bootdev  string /dev/sda
# Pro instalaci na první zařízení (předpokládejme, že nejde o USB klíčenku):
#d-i grub-installer/bootdev  string default

# Alternativně můžete instalovat jinam než do MBR - odkomentujete
# a upravte tyto řádky:
#d-i grub-installer/only_debian boolean false
#d-i grub-installer/with_other_os boolean false
#d-i grub-installer/bootdev  string (hd0,1)
# Pro instalaci Grubu na více disků:
#d-i grub-installer/bootdev  string (hd0,1) (hd1,1) (hd2,1)

# Volitelné heslo pro Grub buď v čitelné podobě
#d-i grub-installer/password password r00tme
#d-i grub-installer/password-again password r00tme
# nebo zašifrované pomocí MD5 hashe, viz grub-md5-crypt(8).
#d-i grub-installer/password-crypted password [MD5 hash]

# Následující volbou můžete přidat další zaváděcí parametry pro
# nainstalovaný systém (pokud to podporuje instalátor zavaděče).
# Poznámka: parametry předané instalátoru budou přidány automaticky.
#d-i debian-installer/add-kernel-opts string nousb
</pre></div>
<p>

MD5 hash hesla pro <code class="classname">grub</code> můžete získat buď
příkazem <span class="command"><strong>grub-md5-crypt</strong></span>, nebo příkazem uvedeným
v příkladu v části <a class="xref" href="apbs04.html#preseed-account" title="B.4.5. Nastavení účtů">B.4.5 – „Nastavení účtů“</a>.

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-finish"></a>B.4.12. Dokončení instalace</h3></div></div></div>
<div class="informalexample"><pre class="screen">
# Při instalaci skrze sériovou konzoli jsou tradiční virtuální konzoly
# (VT1-VT6) v /etc/inittab zakázány. Chcete-li je nechat povolené,
# odkomentujte následující řádek.
#d-i finish-install/keep-consoles boolean true

# Vynechá poslední hlášku, že je instalace kompletní.
d-i finish-install/reboot_in_progress note

# Zakáže vysunutí CD během restartu, což se občas může hodit.
#d-i cdrom-detect/eject boolean false

# Tímto se počítač po skončení instalace místo restartu do nového
# systému zastaví, případně zcela vypne.
#d-i debian-installer/exit/halt boolean true
# Tímto se počítač nejen zastaví, ale i vypne.
#d-i debian-installer/exit/poweroff boolean true
</pre></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-other"></a>B.4.13. Přednastavení ostatních balíků</h3></div></div></div>
<div class="informalexample"><pre class="screen">
# Je možné, že se objeví další otázky v závislosti na tom, jaký
# software nainstalujete, nebo podle toho, co se během instalace
# pokazí. Seznam všech možných otázek během instalace získáte
# příkazy:
#   debconf-get-selections --installer &gt; soubor
#   debconf-get-selections &gt;&gt; soubor
</pre></div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div id="ftn.idm3768" class="footnote"><p><a href="#idm3768" class="para"><sup class="para">[27] </sup></a>

Například přednastavením <code class="literal">locale</code> na hodnotu
<strong class="userinput"><code>en_NL</code></strong> by se jako výchozí locale pro instalovaný
systém použilo <code class="literal">en_US.UTF-8</code>. Jestliže preferujete
britský standard angličtiny (<code class="literal">en_GB.UTF-8</code>), musíte
přednastavit jednotlivé proměnné.

</p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="apbs03.html"><img src="images/prev.png" alt="Předcházející"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="apb.html"><img src="images/up.png" alt="Nahoru"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="apbs05.html"><img src="images/next.png" alt="Další"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">B.3. Vytvoření souboru s přednastavením </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Domů"></a></td>
<td width="40%" align="right" valign="top"> B.5. Pokročilé možnosti</td>
</tr>
</table>
</div>
</body>
</html>
