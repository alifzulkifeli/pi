<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>4.3. Forberedning af filer for opstart via USB-hukommelsesdrev</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="Installationsguide for Debian GNU/Linux">
<link rel="up" href="ch04.html" title="Kapitel 4. Find systeminstallationsmedie">
<link rel="prev" href="ch04s02.html" title="4.2. Hentning af filer fra Debian-spejl">
<link rel="next" href="ch04s04.html" title="4.4. Forberedelse af filer for harddiskopstart">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">4.3. Forberedning af filer for opstart via USB-hukommelsesdrev</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch04s02.html"><img src="images/prev.png" alt="forrige"></a> </td>
<th width="60%" align="center">Kapitel 4. Find systeminstallationsmedie</th>
<td width="20%" align="right"> <a accesskey="n" href="ch04s04.html"><img src="images/next.png" alt="næste"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="boot-usb-files"></a>4.3. Forberedning af filer for opstart via USB-hukommelsesdrev</h2></div></div></div>
<p>For at forberede USB-drevet, så skal du bruge et system hvor GNU/Linux allerede er installeret og hvor USB er understøttet. Med nuværende GNU/Linux-systemer vil USB-drevet automatisk blive genkendt når det indsættes. Hvis ikke bør du kontrollere om usb-storage-kernemodulet er indlæst. Når USB-drevet indsættes, så vil det blive lagt på en enhed navngivet <code class="filename">/dev/sdX</code>, hvor <span class="quote">“<span class="quote">X</span>”</span> er et bogstav i intervallet a-z. Du bør kunne se hvilken enhd USB-drevet blev lagt på ved at køre kommandoen <span class="command"><strong>dmesg</strong></span> efter indsættelse. For at skrive til dit drev skal du måske stille på skrivebeskyttelsesknappen. </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Advarsel]" src="images/warning.png"></td>
<th align="left">Advarsel</th>
</tr>
<tr><td align="left" valign="top"><p>Procedurerne beskrevet i dette afsnit vil fjerne alt på enheden! Vær sikker på at du bruger det korrekt enhedsnavn for dit USB-drev. Hvis du bruger dne forkerte enhed kan resultatet være at al information på for eksempel en harddisk mistes. </p></td></tr>
</table></div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-isohybrid"></a>4.3.1. Forberedning af et USB-drev via en hybrid cd eller et dvd-aftryk</h3></div></div></div>
<p>Debian cd- og dvd-aftryk kan nu skrives direkte på et USB-drev, hvilket er en meget nem måde at lave et USB-drev, der kan opstartes fra. Vælg et cd- eller dvd-aftryk (såsom netinst, cd-1, dvd-1 eller netboot), som vil passe på dit USB-drev. Se <a class="xref" href="ch04s01.html" title="4.1. Officielle Debian GNU/Linux cd/dvd-rom-sæt">Afsnit 4.1, “Officielle Debian GNU/Linux cd/dvd-rom-sæt”</a> for hvordan du får fat i et cd- eller dvd-aftryk. </p>
<p>Alternativt kan du for meget små USB-drev på kun nogle få megabyte hente aftrykket <code class="filename">mini.iso</code> fra mappen <code class="filename">netboot</code> (på placeringen nævnt i <a class="xref" href="ch04s02.html#where-files" title="4.2.1. Her kan du finde installationsaftryk">Afsnit 4.2.1, “Her kan du finde installationsaftryk”</a>). </p>
<p>Cd eller dvd-aftrykket du vælger skal skrives direkte til USB-drevet, og overskrive dets nuværende indhold. For eksempel kan du med et eksisterende GNU/Linux-system skrive cd- eller dvd-aftrykket til et USB-drev som i det følgende, efter at du har sikret dig at drevet er afmonteret:</p>
<div class="informalexample"><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>cp <em class="replaceable"><code>debian.iso</code></em> /dev/<em class="replaceable"><code>sdX</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sync</code></strong>
</pre></div>
<p> Information om hvordan dette gøres på andre operativsystemer kan findes i <a class="ulink" href="https://www.debian.org/CD/faq/index.en.html#write-usb" target="_top">Debian CD FAQ</a>. </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Vigtigt]" src="images/important.png"></td>
<th align="left">Vigtigt</th>
</tr>
<tr><td align="left" valign="top"><p>Aftrykket skal skrives til whole-disk-enheden og ikke en partition, f.eks. /dev/sdb og ikke 7dev/sdb1. Brug ikke værktøjer såsom <span class="command"><strong>unetbootin</strong></span> som ændrer aftrykket. </p></td></tr>
</table></div>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Vigtigt]" src="images/important.png"></td>
<th align="left">Vigtigt</th>
</tr>
<tr><td align="left" valign="top"><p>En simpel skrivning af cd- eller dvd-aftrykket til USB bør fungere fint for de fleste brugere. De andre muligheder er mere komplekse og hovedsagelig for folk med specielle behov. </p></td></tr>
</table></div>
<p>Hybridaftrykket på drevet bruger ikke al lagerplads, så kan være en overvejelse værd at bruge den ledige plads til firmware-filer eller pakker eller andre filer efter dit eget valg. Dette kan være nyttigt, hvis du kun har et drev eller bare ønsker at have alt på en enhed. </p>
<p>Opret endnu en FAT-partition på drevet, monter partitionen og kopier eller udpak firmwaren til den. For eksempel: </p>
<div class="informalexample"><pre class="screen"># mount /dev/<em class="replaceable"><code>sdX2</code></em> /mnt
# cd /mnt
# tar zxvf <em class="replaceable"><code>/path/to/</code></em>firmware.tar.gz
# cd /
# umount /mnt
</pre></div>
<p>

</p>
<p>Du har skrevet <code class="filename">mini.iso</code> til USB-drevet. I dette tilfælde skal den anden partition ikke oprettes da, meget passende, den allerede vil være til stede. Fjernelse og isættelse af USB-drevet bør gøre de to partitioner synlige. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-easy"></a>4.3.2. Manuelt kopiere filer til USB-drevet</h3></div></div></div>
<p>En alternativ måde at opsætte dit USB-drev er manuelt at kopiere installationsprogrammets filer, og også et cd-aftryk til drevet. Bemærk at USB-drevet skal være på mindst 1 GB (mindre opsætninger er muliger hvis du følger <a class="xref" href="ch04s03.html#usb-copy-flexible" title="4.3.3. Manuelt kopiere filer til USB-drevet — den fleksible måde">Afsnit 4.3.3, “Manuelt kopiere filer til USB-drevet — den fleksible måde”</a>). </p>
<p>Der er en alt i en-fil <code class="filename">hd-media/boot.img.gz</code> som indeholder alle installationsprogrammets filre (inklusive the kernen) <span class="phrase">samt <code class="classname">syslinux</code> og dets konfiguration file</span> . </p>
<p>Bemærk dog, selvom det er nemt, at denne metode har en stor ulempe: Den logiske størrelse på enheden vil være begrænset til 1 GB, selv hvis kapaciteten på USB-drevet er større. Du skal partitionere USB-drevet igen og oprette nye filsystemer for at få den fulde kapacitet tilbage, hvis du ønsker at bruge den til andre formål. </p>
<p>For at bruge dette aftryk udtrækkes det direkte til dit USB-drev: </p>
<div class="informalexample"><pre class="screen"># zcat boot.img.gz &gt; /dev/<em class="replaceable"><code>sdX</code></em>
</pre></div>
<p>

</p>
<p>Derefter monteres USB-hukommelsesdrevet <span class="phrase">(<strong class="userinput"><code>mount /dev/<em class="replaceable"><code>sdX</code></em> /mnt</code></strong>),</span>  som nu vil have <span class="phrase">et FAT-filsystem</span>  på sig og kopier et Debian ISO-aftryk (netinst eller fuld cd) til den. Afmonter drevet (<strong class="userinput"><code>umount /mnt</code></strong>) og du er færdig. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-flexible"></a>4.3.3. Manuelt kopiere filer til USB-drevet — den fleksible måde</h3></div></div></div>
<p>Hvis du ønsker højere fleksibilitet eller bare ønsker at vide, hvad der foregår, så kan du bruge en af de følgende metoder til at placere filerne på dit drev. En af fordelene ved denne metode er at — hvis kapaciteten på dit USB-drev er stor nok — så kan du kopiere ethvert ISO-aftryk eller endda et dvd-aftryk til drevet. </p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="idm818"></a>4.3.3.1. Partitionering af USB-drevet</h4></div></div></div>
<p>Vi vil vise hvordan hukommelsesdrevet opsættes til at bruge den første partition, i stedet for hele enheden. </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Bemærk]" src="images/note.png"></td>
<th align="left">Bemærk</th>
</tr>
<tr><td align="left" valign="top">
<p>Da de fleste USB-drev kommer prækonfigurede med en enkel FAT16-partition, så skal du sandsynligvis ikke partitioner eller formatere drevet igen. Hvis du alligevel skal gøre dette, så brug <span class="command"><strong>cfdisk</strong></span> eller et andet partitioneringsværktøj til at oprette en FAT16-partition<a href="#ftn.idm824" class="footnote" name="idm824"><sup class="footnote">[3]</sup></a>, installer en MBR via: </p>
<div class="informalexample"><pre class="screen">
# install-mbr /dev/<em class="replaceable"><code>sdX</code></em>
</pre></div>
<p> Kommandoen <span class="command"><strong>install-mbr</strong></span> er indeholdt i Debian-pakken <code class="classname">mbr</code>. Opret så filsystemet med: </p>
<div class="informalexample"><pre class="screen">
# mkdosfs /dev/<em class="replaceable"><code>sdX1</code></em>
</pre></div>
<p> Vær opmærksom på at bruge det korrekte enhedsnavn for dit USB-drev. Kommandoen <span class="command"><strong>mkdosfs</strong></span> er indeholdt i Debian-pakken <code class="classname">dosfstools</code>. </p>
</td></tr>
</table></div>
<p>For at starte kernen efter opstart fra USB-drevet, vil vi placere en opstartsindlæser på drevet. Selvom enhver opstartsindlæser (f.eks. <code class="classname">lilo</code>) bør fungere, er det nemt at bruge <code class="classname">syslinux</code>, da den bruger en FAT16-partition og kan konfigureres om ved bare at redigere en tekstfil. Ethvert operativsystem som understøtter FAT-filsystemet kan bruges til at lave ændringer til konfigurationen af opstartsindlæseren. </p>
<p>For at placere <code class="classname">syslinux</code> på FAT16-partitionen på dit USB-drev, så installer pakkerne <code class="classname">syslinux</code> og <code class="classname">mtools</code> på dit system, og udfør: </p>
<div class="informalexample"><pre class="screen">
# syslinux /dev/<em class="replaceable"><code>sdX1</code></em>
</pre></div>
<p> Igen husk at sikre dig, at du bruger det korrekte enhedsnavn. Partitionen må ikke være monteret når <span class="command"><strong>syslinux</strong></span> startes. Denne procedure skriver en opstartssektor til partionen og opretter filen <code class="filename">ldlinux.sys</code>, som indeholder koden for opstartsindlæseren. </p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="idm849"></a>4.3.3.2. Tilføjelse af installationsprogrammets aftryk</h4></div></div></div>
<p>Monter partitionen (<strong class="userinput"><code>mount /dev/<em class="replaceable"><code>sdX1</code></em> /mnt</code></strong>) og kopier de følgende installationsaftryksfiler til drevet: </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p> <code class="filename">vmlinuz</code> eller <code class="filename">linux</code> (kernel binary) </p></li>
<li class="listitem"><p> <code class="filename">initrd.gz</code> (initial ramdisk image) </p></li>
</ul></div>
<p> Du kan vælge mellem enten den tekstbaserede eller grafiske version af installationsprogrammet. Den sidste kan findes i undermappen <code class="filename">gtk</code>. Hvis du ønsker at omdøbe filerne, så bemærk venligst at <code class="classname">syslinux</code> kun kan behandle DOS-filnavne (8.3). </p>
<p>Derefter bør du oprette en konfigurationsfil <code class="filename">syslinux.cfg</code>, der som minimum skal indeholde de to følgende linjer (ændr navnet på kernens binær fil til <span class="quote">“<span class="quote"><code class="filename">linux</code></span>”</span> hvis du brugte et <code class="filename">netboot</code>-aftryk: </p>
<div class="informalexample"><pre class="screen">
default vmlinuz initrd=initrd.gz
</pre></div>
<p> For det grafiske installationsprogram bør du tilføje <strong class="userinput"><code>vga=788</code></strong> til den anden linje. Andre parametre kan tilføjes som ønsket. </p>
<p>For at aktivere opstartsprompten til at acceptere yderligere parametertilføjelse, tilføjes en linje <strong class="userinput"><code>prompt 1</code></strong>. </p>
<p>Hvis du anvendte et <code class="filename">hd-media</code>-aftryk, så bør du kopiere ISO-filen for et Debian-ISO-aftryk<a href="#ftn.idm876" class="footnote" name="idm876"><sup class="footnote">[4]</sup></a> ned på drevet. Når du er færdig, afmonter USB-drevet (<strong class="userinput"><code>umount /mnt</code></strong>). </p>
</div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div id="ftn.idm824" class="footnote"><p><a href="#idm824" class="para"><sup class="para">[3] </sup></a> Glem ikke at angive opstartsflaget <span class="quote">“<span class="quote">bootable</span>”</span>. </p></div>
<div id="ftn.idm876" class="footnote"><p><a href="#idm876" class="para"><sup class="para">[4] </sup></a> Du kan bruge enten en netinst eller et fuld cd-aftryk (se <a class="xref" href="ch04s01.html" title="4.1. Officielle Debian GNU/Linux cd/dvd-rom-sæt">Afsnit 4.1, “Officielle Debian GNU/Linux cd/dvd-rom-sæt”</a>). Vær sikker på at vælge et som passer. Bemærk at <span class="quote">“<span class="quote">netboot <code class="filename">mini.iso</code></span>”</span>-aftrykket ikke er brugbar til dette formål. </p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch04s02.html"><img src="images/prev.png" alt="forrige"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch04.html"><img src="images/up.png" alt="op"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch04s04.html"><img src="images/next.png" alt="næste"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">4.2. Hentning af filer fra Debian-spejl </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="hjem"></a></td>
<td width="40%" align="right" valign="top"> 4.4. Forberedelse af filer for harddiskopstart</td>
</tr>
</table>
</div>
</body>
</html>
