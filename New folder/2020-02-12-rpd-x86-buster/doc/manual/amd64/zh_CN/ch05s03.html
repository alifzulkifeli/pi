<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>5.3. 引导参数</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="Debian GNU/Linux 安装手册">
<link rel="up" href="ch05.html" title="第 5 章 用安装系统启动">
<link rel="prev" href="ch05s02.html" title="5.2. 辅助功能">
<link rel="next" href="ch05s04.html" title="5.4. 安装过程中的故障修复">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">5.3. 引导参数</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch05s02.html"><img src="images/prev.png" alt="上一页"></a> </td>
<th width="60%" align="center">第 5 章 用安装系统启动</th>
<td width="20%" align="right"> <a accesskey="n" href="ch05s04.html"><img src="images/next.png" alt="下一页"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="boot-parms"></a>5.3. 引导参数</h2></div></div></div>
<p>引导参数是 Linux 内核的参数。一般用于确保外围设备能够正确地运行。对于其中的大多数部分来说，内核可以自动检查外围设备的相关信息。但是在某些情况下，您可能需要给内核一点小小的帮助。 </p>
<p>如果这是您第一次引导系统，尝试缺省的引导参数(即：不要输入任何参数)，并且检查是否工作正确。这可能正确，如果不行，可以重新启动，并且检查需要告诉系统什么样的硬件特定参数。 </p>
<p>有关很多引导参数的信息可以查看 <a class="ulink" href="http://www.tldp.org/HOWTO/BootPrompt-HOWTO.html" target="_top"> Linux BootPrompt HOWTO</a>，其中包括一些老旧硬件的解决方法。这一节只描述一些最常用的基本参数。一些常见的问题描述见 <a class="xref" href="ch05s04.html" title="5.4. 安装过程中的故障修复">第 5.4 节 “安装过程中的故障修复”</a>。 </p>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="boot-console"></a>5.3.1. 启动控制台</h3></div></div></div>
<p>假如您用串口控制台引导，通常内核可以自动检测到。如果在串口引导的计算机上有视频卡(framebuffer)和键盘，您必须传递 <strong class="userinput"><code>console=<em class="replaceable"><code>device</code></em></code></strong> 参数给内核，其中 <em class="replaceable"><code>device</code></em> 是串口设备，通常是 <code class="filename">ttyS0</code> 形式。 </p>
<p>您可能需要指定串行端口的参数，例如波特率和奇偶校验位，如<strong class="userinput"><code> console = ttyS0,9600n8</code></strong>;其他的典型波特率可能是57600或115200。请确保在 <span class="quote">“<span class="quote">---</span>”</span>之后指定此选项，以便已安装的系统能将其复制到启动加载程序的配置中（如果安装程序支持此启动加载程序）。 </p>
<p>为了确保安装程序使用的终端类型与您的终端模拟程序匹配，可以添加一个 <strong class="userinput"><code>TERM=<em class="replaceable"><code>type</code></em></code></strong> 参数。注意，安装程序仅支持下列终端类型: <code class="literal">linux</code>、<code class="literal">bterm</code>、<code class="literal">ansi</code>、<code class="literal">vt102</code> 和 <code class="literal">dumb</code>。<code class="classname">debian-installer</code> 中默认的串口控制台终端类型是 <strong class="userinput"><code>vt102</code></strong>。如果您使用的虚拟工具，比如 QEMU/KVM，不支持转换成这些终端类型，您可以从一个 <span class="command"><strong>screen</strong></span> 会话中启动。这会将其转换成 <code class="literal">screen</code> 终端类型，而它又非常接近于 <code class="literal">vt102</code> 类型。 </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="installer-args"></a>5.3.2. Debian 安装程序的参数</h3></div></div></div>
<p>The installation system recognizes a few additional boot parameters<a href="#ftn.idm1374" class="footnote" name="idm1374"><sup class="footnote">[6]</sup></a> which may be useful. </p>
<p>许多参数都有<span class="quote">“<span class="quote">简写</span>”</span>，可以避免内核命令行选项的限制，并且更容易输入。如果参数有简写，它会列在(正式)长形式后面的括号里。本手册中的示例一般都使用简写。 </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term">debconf/priority (priority)</span></dt>
<dd>
<p>这些参数设置将设置显示的信息为最低的级别。 </p>
<p>缺省安装使用 <strong class="userinput"><code>priority=high</code></strong>。这意味着高优先级的和至关重要的信息将被显示，但是中级和低级信息将被跳过。如果其间出现了问题，安装程序将按照要求调整优先级别。 </p>
<p>如果您加入 <strong class="userinput"><code>priority=medium</code></strong> 作为引导参数，将看到安装菜单以及安装过程中更多的控制。当使用 <strong class="userinput"><code>priority=low</code></strong>，将显示所有的消息(这相当于采用 <span class="emphasis"><em>expert</em></span> 引导方法)。通过 <strong class="userinput"><code>priority=critical</code></strong>，安装系统只会显示至关重要的信息，并且尝试正确无误地执行各项事宜。 </p>
</dd>
<dt><span class="term">DEBIAN_FRONTEND</span></dt>
<dd>
<p>这个引导参数控制用于安装程序的用户界面的类型。当前可能参数设置有：</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p><strong class="userinput"><code>DEBIAN_FRONTEND=noninteractive</code></strong></p></li>
<li class="listitem"><p><strong class="userinput"><code>DEBIAN_FRONTEND=text</code></strong></p></li>
<li class="listitem"><p><strong class="userinput"><code>DEBIAN_FRONTEND=newt</code></strong></p></li>
<li class="listitem"><p><strong class="userinput"><code>DEBIAN_FRONTEND=gtk</code></strong></p></li>
</ul></div>
<p> 缺省的前端是 <strong class="userinput"><code>DEBIAN_FRONTEND=newt</code></strong>。<strong class="userinput"><code>DEBIAN_FRONTEND=text</code></strong> 可以用于串口控制台的安装。一些特殊类型的安装介质可能只含有限的几个前端，但是 <strong class="userinput"><code>newt</code></strong> 和 <strong class="userinput"><code>text</code></strong> 在多少安装介质上都是默认采用。图形安装程序可以在所支持的平台上使用 <strong class="userinput"><code>gtk</code></strong> 前端。 </p>
</dd>
<dt><span class="term">BOOT_DEBUG</span></dt>
<dd>
<p>设置引导参数为 2 会使记录更冗长一些。设置为 3 会在引导过程的特定位置调出 debug shell。(退出 shell 以后会继续引导过程。) </p>
<div class="variablelist"><dl class="variablelist">
<dt><span class="term"><strong class="userinput"><code>BOOT_DEBUG=0</code></strong></span></dt>
<dd><p>此为默认。</p></dd>
<dt><span class="term"><strong class="userinput"><code>BOOT_DEBUG=1</code></strong></span></dt>
<dd><p>更多的信息。</p></dd>
<dt><span class="term"><strong class="userinput"><code>BOOT_DEBUG=2</code></strong></span></dt>
<dd><p>大量的调试信息。</p></dd>
<dt><span class="term"><strong class="userinput"><code>BOOT_DEBUG=3</code></strong></span></dt>
<dd><p>在引导过程中，安装程序将在多处不同地方运行 Shell，以进行细节上的调试。退出 Shell 将继续引导过程。 </p></dd>
</dl></div>
<p>

</p>
</dd>
<dt><span class="term">INSTALL_MEDIA_DEV</span></dt>
<dd>
<p>参数的值是装入 Debian 安装程序的设备路径，例如：<strong class="userinput"><code>INSTALL_MEDIA_DEV=/dev/floppy/0</code></strong> </p>
<p>引导软盘通常会扫描所有的软盘来找到根软盘，可以通过此参数设置只查找一个设备。 </p>
</dd>
<dt>
<span class="term">log_host, </span><span class="term">log_port</span>
</dt>
<dd><p>使得安装程序可以在本地记录同时发送日志到指定主机和端口的远端 syslog。如果不指定，默认端口是 syslog 标准端口 514。 </p></dd>
<dt><span class="term">lowmem</span></dt>
<dd><p>可以强制安装程序设置高于安装程序根据实际内存默认的 lomem 等级。该值可设为 1 和 2。参阅 <a class="xref" href="ch06s03.html#lowmem" title="6.3.1.1. 检测可用内存/小内存模式">第 6.3.1.1 节 “检测可用内存/小内存模式”</a>。 </p></dd>
<dt><span class="term">noshell</span></dt>
<dd><p>禁止 tty2 和 tty3 上的交互式安装。这对于物理安全限制下的无人职守安装很有用处。 </p></dd>
<dt><span class="term">debian-installer/framebuffer (fb)</span></dt>
<dd><p>一些体系利用内核 framebuffer 来提供多种语言的安装。如果 framebuffer 使您的系统出现问题，可以通过参数 <strong class="userinput"><code>vga=normal</code></strong> <strong class="userinput"><code>fb=false</code></strong> 关闭这个特性。这类问题的特征是 bterm 或者 bogl 的相关错误信息、一个空白的屏幕，或者在开始安装几分钟后停止。 </p></dd>
<dt><span class="term">debian-installer/theme (theme)</span></dt>
<dd><p>界面方案(theme)决定安装程序用户界面的外观(颜色、图标等)。不同的前端(frontend)有不同的界面方案。当前 newt 和 gtk 前端只有一个 <span class="quote">“<span class="quote">dark</span>”</span> 界面方案提供给视觉受损的用户。界面方案可以在引导的时候通过 <strong class="userinput"><code>theme=<em class="replaceable"><code>dark</code></em></code></strong> 设置。 </p></dd>
<dt><span class="term">netcfg/disable_autoconfig</span></dt>
<dd>
<p>缺省情况下，<code class="classname">debian-installer</code> 会通过 DHCP 来自动检测网络。如果检测成功的话，您将不需要审视并且改变其获得的设定。您可以在 DHCP 检测失败的情况下手工配置网络。 </p>
<p>如果您的网络上面具备一台 DHCP 服务器，但是不想使用它，比如，因为它给出错误的答案。您可以使用参数 <strong class="userinput"><code>netcfg/disable_autoconfig=true</code></strong> 来阻止通过 DHCP 配置网络，并手工输入信息。 </p>
</dd>
<dt><span class="term">hw-detect/start_pcmcia</span></dt>
<dd><p>设置成 <strong class="userinput"><code>false</code></strong> 来阻止启动 PCMCIA 服务造成的麻烦。有些便携机会有这种现象。 </p></dd>
<dt><span class="term">disk-detect/dmraid/enable (dmraid)</span></dt>
<dd><p>设为 <strong class="userinput"><code>true</code></strong> 可以打开安装程序中对 Serial ATA RAID (也称为 ATA RAID、BIOS RAID 或 fake RAID)磁盘的支持。注意，这种支持当前是实验性的。更多的信息可以在 <a class="ulink" href="https://wiki.debian.org/DebianInstaller/" target="_top">Debian Installer Wiki</a> 找到。 </p></dd>
<dt><span class="term">preseed/url (url)</span></dt>
<dd><p>指定 url 到预设文件，在安装中自动下载和使用。参阅 <a class="xref" href="ch04s06.html" title="4.6. 自动化安装">第 4.6 节 “自动化安装”</a>。 </p></dd>
<dt><span class="term">preseed/file (file)</span></dt>
<dd><p>指定路径至预设文件，加载自动化安装。参阅 <a class="xref" href="ch04s06.html" title="4.6. 自动化安装">第 4.6 节 “自动化安装”</a>。 </p></dd>
<dt><span class="term">preseed/interactive</span></dt>
<dd><p>设为 <strong class="userinput"><code>true</code></strong>，让已经预置的也可以显示提问。用于测试和调试预置的文件。注意，使用引导参数进行预置时无效，但可以使用一种特殊的语法。参阅 <a class="xref" href="apbs05.html#preseed-seenflag" title="B.5.2. 使用预置修改默认值">第 B.5.2 节 “使用预置修改默认值”</a> 了解详细信息。 </p></dd>
<dt><span class="term">auto-install/enable (auto)</span></dt>
<dd><p>延迟那些通常在预置之前的提问，直到网络设置完毕。参阅 <a class="xref" href="apbs02.html#preseed-auto" title="B.2.3. auto 模式">第 B.2.3 节 “auto 模式”</a> 了解自动安装的详细信息。 </p></dd>
<dt><span class="term">finish-install/keep-consoles</span></dt>
<dd><p>从串口或者管理控制台安装时，虚拟控制台(VT1 到 VT6)一般在 <code class="filename">/etc/inittab</code> 里已经关掉。将其改为 <strong class="userinput"><code>true</code></strong> 打开。 </p></dd>
<dt><span class="term">cdrom-detect/eject</span></dt>
<dd>
<p>在重启前，<code class="classname">debian-installer</code> 默认自动弹出安装时的光学媒介。如果系统不是自动从 CD 引导，这是不必要的操作。在某些情况下，反而不便。例如，如果光驱不能自动插入盘片，用户又不在旁边操作。许多 slot loading、slim-line 和 caddy 类型的驱动器不能自动重新加载介质。 </p>
<p>设为 <strong class="userinput"><code>false</code></strong> 可以禁止自动弹出，但要小心确保系统在安装完后，不会自动从光盘引导。 </p>
</dd>
<dt><span class="term">base-installer/install-recommends (recommends)</span></dt>
<dd>
<p>通过设置 <strong class="userinput"><code>false</code></strong> 选项，在安装过程和以后的系统中，包管理系统将配置设为不自动安装这些<span class="quote">“<span class="quote">推荐的软件包(Recommends)</span>”</span>。参阅 <a class="xref" href="ch06s03.html#di-install-base" title="6.3.5. 安装基本系统">第 6.3.5 节 “安装基本系统”</a>。 </p>
<p>注意，虽然使用该选项可以得到一个瘦小的系统，但将会失去一些通常认为应有的特性。您不得不使用手动方式安装这些推荐软件包以获得完整的功能。因此，该选项应由非常有经验的用户来使用。 </p>
</dd>
<dt><span class="term">debian-installer/allow_unauthenticated</span></dt>
<dd><p>安装程序默认需要使用一个已知的 gpg 密钥认证仓库。设为 <strong class="userinput"><code>true</code></strong> 可以禁止认证。<span class="bold"><strong>警告：不安全，不推荐使用。</strong></span> </p></dd>
<dt><span class="term">rescue/enable</span></dt>
<dd><p>设为 <strong class="userinput"><code>true</code></strong> 进入 rescue 模式，而不是执行普通安装。参阅 <a class="xref" href="ch08s06.html" title="8.6. 修复损坏的系统">第 8.6 节 “修复损坏的系统”</a>。 </p></dd>
</dl></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="preseed-args"></a>5.3.3. 使用内核模块参数回答提问</h3></div></div></div>
<p>对于一些例外，可以在引导提示符后设置值来回答安装过程中的提问，在某些情况下，它是惟一真正有效的。有关如何操作的说明可以在 <a class="xref" href="apbs02.html#preseed-bootparms" title="B.2.2. 使用引导参数预置问题的答案">第 B.2.2 节 “使用引导参数预置问题的答案”</a> 找到。下面是一些具体的例子。 </p>
<div class="variablelist"><dl class="variablelist">
<dt>
<span class="term">debian-installer/language (language), </span><span class="term">debian-installer/country (country), </span><span class="term">debian-installer/locale (locale)</span>
</dt>
<dd>
<p>有两种方法可以指定安装过程和安装后系统中所使用的语言(language)、国家(country)和地方(locale)。 </p>
<p>第一种和最简单的方法为只设置 <code class="literal">locale</code> 参数。语言和国家将依据该值产生。例如，您可以使用 <strong class="userinput"><code>locale=de_CH</code></strong> 选择语言为德语，瑞士为国家(安装后的系统中默认的 locale 将设置为 <code class="literal">de_CH.UTF-8</code> )。该方法有一个缺陷，因为并不是所有的语言、国家和地方可以采用这种方式组合。 </p>
<p>第二种更具弹性的方法，是分开指定 <code class="literal">language</code> 和 <code class="literal">country</code>。这种方式下 <code class="literal">locale</code> 可以作为选项来指定安装后系统中默认的 locale 值。例如：<strong class="userinput"><code>language=en country=DE locale=en_GB.UTF-8</code></strong>。 </p>
</dd>
<dt><span class="term">anna/choose_modules (modules)</span></dt>
<dd><p>可用来自动加载那些默认不加载的安装程序模块。比如一些有用的可选模块 <code class="classname">openssh-client-udeb</code> (使您可以在安装过程中使用 <span class="command"><strong>scp</strong></span>) <span class="phrase"> 和 <code class="classname">ppp-udeb</code> (参阅 <a class="xref" href="apds05.html" title="D.5. 通过 PPP over Ethernet（PPPPoE）安装 Debian GNU/Linux">第 D.5 节 “通过 PPP over Ethernet（PPPPoE）安装 Debian GNU/Linux”</a>)</span>。 </p></dd>
<dt><span class="term">netcfg/disable_autoconfig</span></dt>
<dd><p>如果您想禁止 DHCP 使用静态网络设置，将它设为 <strong class="userinput"><code>true</code></strong>。 </p></dd>
<dt><span class="term">mirror/protocol (protocol)</span></dt>
<dd><p>默认情况下，安装程序会使用 http 协议从 Debian 镜像下载文件，在普通优先级下不能修改协议为 ftp。设置该参数为 <strong class="userinput"><code>ftp</code></strong>，您可以强制安装程序使用该协议。注意，必须手动输入主机名，而不是从列表中选择 ftp 镜像。 </p></dd>
<dt><span class="term">tasksel:tasksel/first (tasks)</span></dt>
<dd><p>可以用来选择不在交互式任务列表中出现的任务，例如 <code class="literal">kde-desktop</code> 任务。参阅 <a class="xref" href="ch06s03.html#pkgsel" title="6.3.6.2. 选择和安装软件">第 6.3.6.2 节 “选择和安装软件”</a> 了解详细信息。 </p></dd>
</dl></div>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="module-parms"></a>5.3.4. 给内核模块传递参数</h3></div></div></div>
<p>假如驱动程序编译进内核，您可以像内核文档所说的那样向内核传递参数。然而，如果驱动编译为模块，而且由于安装过程与运行系统加载模块方式不同，无法像平时那样传递参数到模块。因此，您需要使用安装程序所识别的特殊语法，它们将确保参数能保存到合适的配置文件，并在模块加载的时候使用。这些参数并能自动应用到安装后系统的配置中。 </p>
<p>注意，现在很少需要将参数传递到模块。多数情况下，内核将侦测当前系统中的硬件，并很好地设置默认参数。然而，某些情况下还是需要手动设置参数。 </p>
<p>设置模块参数的语法为：</p>
<div class="informalexample"><pre class="screen">
<em class="replaceable"><code>module_name</code></em>.<em class="replaceable"><code>parameter_name</code></em>=<em class="replaceable"><code>value</code></em>
</pre></div>
<p> 如果您需要传递多个参数给相同或不同的模块，重复上面内容即可。例如，设置老式的 3Com 网卡要使用 BNC (coax) 端子和 IRQ 10，要使用： </p>
<div class="informalexample"><pre class="screen">3c509.xcvr=3 3c509.irq=10
</pre></div>
<p>

</p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="module-blacklist"></a>5.3.5. 内核模块黑名单</h3></div></div></div>
<p>有时需要将一个模块加入黑名单阻止内核和 udev 自动加载。其中一个原因是有的模块会与您的硬件产生问题。内核有时会给同一硬件列出两个不同的驱动程序。如果驱动之间冲突或者错误的驱动先加载，将造成设备无法正常工作。 </p>
<p>您可以使用下面的语法将模块加入黑名单：<strong class="userinput"><code><em class="replaceable"><code>module_name</code></em>.blacklist=yes</code></strong>。这会让该模块在安装和安装后的系统都加入 <code class="filename">/etc/modprobe.d/blacklist.local</code> 文件的黑名单中。 </p>
<p>注意，安装系统自己仍然会加载模块。要阻止这种情况，您可以在 expert 模式下，硬件检查过程中从显示的模块列表中取消该模块。 </p>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div id="ftn.idm1374" class="footnote"><p><a href="#idm1374" class="para"><sup class="para">[6] </sup></a> With current kernels (2.6.9 or newer) you can use 32 command line options and 32 environment options. If these numbers are exceeded, the kernel will panic. Also there is a limit of 255 characters for the whole kernel command line, everything above this limit may be silently truncated. </p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch05s02.html"><img src="images/prev.png" alt="上一页"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch05.html"><img src="images/up.png" alt="上一级"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch05s04.html"><img src="images/next.png" alt="下一页"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">5.2. 辅助功能 </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="起始页"></a></td>
<td width="40%" align="right" valign="top"> 5.4. 安装过程中的故障修复</td>
</tr>
</table>
</div>
</body>
</html>
