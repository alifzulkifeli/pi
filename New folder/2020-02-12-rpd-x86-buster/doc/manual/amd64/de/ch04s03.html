<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>4.3. Dateien vorbereiten für das Booten von einem USB-Memory-Stick</title>
<link rel="stylesheet" type="text/css" href="install.css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="index.html" title="Debian GNU/Linux – Installationsanleitung">
<link rel="up" href="ch04.html" title="Kapitel 4. Systeminstallations-Medien beschaffen">
<link rel="prev" href="ch04s02.html" title="4.2. Dateien von einem Debian-Spiegel-Server herunterladen">
<link rel="next" href="ch04s04.html" title="4.4. Dateien vorbereiten für das Booten von Festplatte">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr><th colspan="3" align="center">4.3. Dateien vorbereiten für das Booten von einem USB-Memory-Stick</th></tr>
<tr>
<td width="20%" align="left">
<a accesskey="p" href="ch04s02.html"><img src="images/prev.png" alt="Zurück"></a> </td>
<th width="60%" align="center">Kapitel 4. Systeminstallations-Medien beschaffen</th>
<td width="20%" align="right"> <a accesskey="n" href="ch04s04.html"><img src="images/next.png" alt="Weiter"></a>
</td>
</tr>
</table>
<hr>
</div>
<div class="sect1">
<div class="titlepage"><div><div><h2 class="title">
<a name="boot-usb-files"></a>4.3. Dateien vorbereiten für das Booten von einem USB-Memory-Stick</h2></div></div></div>
<p>Um den USB-Stick vorzubereiten, benötigen Sie ein System, auf dem GNU/Linux bereits läuft und das USB unterstützt. Auf aktuellen GNU/Linux-Systemen sollte der USB-Stick automatisch erkannt werden, sobald Sie ihn einstecken. Falls nicht, sollten Sie sicherstellen, dass das usb-storage-Kernelmodul geladen ist. Beim Einstecken wird dem USB-Stick ein Gerät namens <code class="filename">/dev/sdX</code> zugewiesen, wobei <span class="quote">„<span class="quote">X</span>“</span> ein Buchstabe im Bereich zwischen a und z ist. Es sollte Ihnen möglich sein zu erkennen, welches Gerät dem Stick zugewiesen wurde, indem Sie den Befehl <span class="command"><strong>dmesg</strong></span> ausführen, nachdem der USB-Stick eingesteckt wurde. Um den Stick zu beschreiben, müssen Sie eventuell noch mit dem entsprechenden Schalter am Stick den Schreibschutz deaktivieren (falls Ihr Stick solch einen Schalter hat). </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warnung]" src="images/warning.png"></td>
<th align="left">Warnung</th>
</tr>
<tr><td align="left" valign="top"><p>Die in diesem Abschnitt beschriebenen Vorgehensweisen werden alle Daten zerstören, die sich bereits auf dem Gerät befinden! Vergewissern Sie sich, dass Sie den korrekten Gerätenamen (nämlich den Ihres USB-Sticks) verwenden. Wenn Sie einen falschen Namen verwenden, könnte dies dazu führen, dass Sie z.B. alle Daten auf Ihrer Festplatte verlieren! </p></td></tr>
</table></div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-isohybrid"></a>4.3.1. Einen USB-Stick vorbereiten mit einem Hybrid-CD- oder -DVD-Image</h3></div></div></div>
<p>Debian-CD- und -DVD-Images können jetzt direkt auf einen USB-Stick geschrieben werden, was ein sehr einfacher Weg ist, einen bootfähigen USB-Stick zu erstellen. Wählen Sie einfach ein CD- oder DVD-Image, das auf Ihren Stick passt (z.B. das netinst-, CD-1-, DVD-1- oder netboot-Image). Auf <a class="xref" href="ch04s01.html" title="4.1. Offizielle Debian GNU/Linux-CD/DVD-ROMs">Abschnitt 4.1, „Offizielle Debian GNU/Linux-CD/DVD-ROMs“</a> finden Sie Informationen darüber, wie Sie sich ein CD- oder DVD-Image besorgen. </p>
<p>Alternativ können Sie bei sehr kleinen USB-Sticks, die nur ein paar Megabyte groß sind, das <code class="filename">mini.iso</code>-Image aus dem <code class="filename">netboot</code>-Verzeichnis herunterladen (<a class="xref" href="ch04s02.html#where-files" title="4.2.1. Wo Sie die Installations-Images finden">Abschnitt 4.2.1, „Wo Sie die Installations-Images finden“</a> gibt nähere Informationen, wo Sie dies finden). </p>
<p>Das CD- oder DVD-Image, das Sie ausgewählt haben, sollte direkt auf den USB-Stick geschrieben werden, wobei die vorher vorhandenen Daten überschrieben werden. Auf einem vorhandenen GNU/Linux-System kann das Image wie folgt auf den USB-Stick geschrieben werden (nachdem Sie sichergestellt haben, dass der Stick nicht im Dateisystem eingebunden ist): </p>
<div class="informalexample"><pre class="screen">
<code class="prompt">#</code> <strong class="userinput"><code>cp <em class="replaceable"><code>debian.iso</code></em> /dev/<em class="replaceable"><code>sdX</code></em></code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>sync</code></strong>
</pre></div>
<p> Informationen dazu, wie Sie dies auf anderen Betriebssystemen erledigen, finden Sie in der <a class="ulink" href="https://www.debian.org/CD/faq/index.en.html#write-usb" target="_top">Debian CD FAQ</a>. </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Wichtig]" src="images/important.png"></td>
<th align="left">Wichtig</th>
</tr>
<tr><td align="left" valign="top"><p>Das Image muss auf das vollständige Gerät geschrieben werden, nicht auf eine einzelne Partition, also z.B. auf /dev/sdb, nicht auf /dev/sdb1. Nutzen Sie keine Werkzeuge wie <span class="command"><strong>unetbootin</strong></span>, da diese das Image verändern. </p></td></tr>
</table></div>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Wichtig]" src="images/important.png"></td>
<th align="left">Wichtig</th>
</tr>
<tr><td align="left" valign="top"><p>Einfach das CD- oder DVD-Image wie hier gezeigt auf USB zu schreiben sollte für die meisten Benutzer funktionieren. Die anderen unten erwähnten Optionen sind komplexer und hauptsächlich für Leute mit speziellen Bedürfnissen gedacht. </p></td></tr>
</table></div>
<p>Das Hybrid-Image auf dem Stick beansprucht nicht dem vollständigen Speicherplatz, daher können Sie in Betracht ziehen, den freien Platz zu verwenden, um Firmware-Dateien oder Pakete bzw. andere Dateien Ihrer Wahl abzulegen. Dies könnte nützlich sein, wenn Sie nur einen USB-Stick haben oder einfach alles, was Sie benötigen, auf einem Datenträger zusammenhalten möchten. </p>
<p>Sie erstellen dazu eine zweite FAT-Partition auf dem Stick, binden die Partition ein und kopieren oder entpacken die Firmware/Dateien dorthin. Zum Beispiel: </p>
<div class="informalexample"><pre class="screen"># mount /dev/<em class="replaceable"><code>sdX2</code></em> /mnt
# cd /mnt
# tar zxvf <em class="replaceable"><code>/pfad/zur/</code></em>firmware.tar.gz
# cd /
# umount /mnt
</pre></div>
<p>

</p>
<p>Falls Sie das <code class="filename">mini.iso</code>-Image auf den USB-Stick kopiert haben, muss die zweite Partition nicht mehr erstellt werden, da sie praktischerweise bereits vorhanden ist. Ziehen Sie den Stick heraus und stecken Sie ihn neu ein, dann sollten zwei Partitionen sichtbar sein. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-easy"></a>4.3.2. Dateien manuell auf den USB-Stick kopieren</h3></div></div></div>
<p>Ein alternativer Weg zur Einrichtung des USB-Sticks ist das manuelle Kopieren der Installer-Dateien und eines CD-Images auf den Stick. Beachten Sie, dass der USB-Stick idealerweise mindestens 1 GB groß sein sollte (kleinere Setups sind möglich, wenn Sie gemäß <a class="xref" href="ch04s03.html#usb-copy-flexible" title="4.3.3. Dateien manuell auf den USB-Stick kopieren – der flexible Weg">Abschnitt 4.3.3, „Dateien manuell auf den USB-Stick kopieren – der flexible Weg“</a> vorgehen). </p>
<p>Es gibt ein Komplett-Image <code class="filename">hd-media/boot.img.gz</code>, das alle Dateien des Installers enthält (inklusive Kernel)<span class="phrase"> sowie den Bootloader <code class="classname">syslinux</code> mit der zugehörigen Konfigurationsdatei</span>. </p>
<p>Bedenken Sie, dass diese Methode, obwohl sie bequem ist, einen gravierenden Nachteil hat: die logische Größe des Sticks ist auf 1 GB begrenzt, auch wenn die Kapazität des USB-Sticks eigentlich größer ist. Falls Sie den Stick jemals wieder für einen anderen Zweck verwenden und die volle Kapazität zurückbekommen möchten, müssen Sie ihn neu paritionieren und die Dateisysteme neu erstellen. </p>
<p>Um oben erwähntes Komplett-Image zu verwenden, extrahieren Sie es einfach direkt auf Ihren USB-Stick: </p>
<div class="informalexample"><pre class="screen"># zcat boot.img.gz &gt; /dev/<em class="replaceable"><code>sdX</code></em>
</pre></div>
<p>

</p>
<p>Binden Sie danach den USB-Memory-Stick ins Dateisystem ein<span class="phrase"> (<strong class="userinput"><code>mount /dev/<em class="replaceable"><code>sdX</code></em> /mnt</code></strong>)</span>, der jetzt ein <span class="phrase">FAT-Dateisystem</span> enthält, und kopieren Sie ein Debian ISO-Image (Netinst oder eine Komplett-CD) dorthin. Lösen Sie die Laufwerkseinbindung des Sticks (<strong class="userinput"><code>umount /mnt</code></strong>) – das war's. </p>
</div>
<div class="sect2">
<div class="titlepage"><div><div><h3 class="title">
<a name="usb-copy-flexible"></a>4.3.3. Dateien manuell auf den USB-Stick kopieren – der flexible Weg</h3></div></div></div>
<p>Wenn Sie flexibler sein oder einfach nur wissen möchten, was passiert, sollten Sie folgende Methode benutzen, um die Dateien auf den Stick zu befördern. Ein Vorteil dieser Methode ist, dass Sie – falls die Kapazität Ihres USB-Sticks dafür ausreicht – die Möglichkeit haben, jegliches ISO-Image (sogar ein DVD-Image) darauf zu kopieren. </p>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="idm830"></a>4.3.3.1. Den USB-Stick partitionieren</h4></div></div></div>
<p>Wir werden hier erläutern, wie Sie den Memory-Stick einrichten, so dass nur die erste Partition genutzt wird statt des kompletten USB-Speichers. </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Anmerkung]" src="images/note.png"></td>
<th align="left">Anmerkung</th>
</tr>
<tr><td align="left" valign="top">
<p>Da die meisten USB-Sticks mit einer einzelnen FAT16-Partition vorkonfiguriert geliefert werden, müssen Sie den Stick möglicherweise nicht neu partitionieren oder formatieren. Falls es trotzdem nötig ist, nutzen Sie <span class="command"><strong>cfdisk</strong></span> oder ein anderes Partitionierungswerkzeug, um eine FAT16-Partition zu erzeugen<a href="#ftn.idm836" class="footnote" name="idm836"><sup class="footnote">[3]</sup></a>, erzeugen Sie einen Master-Boot-Record (MBR), indem Sie Folgendes eingeben: </p>
<div class="informalexample"><pre class="screen">
# install-mbr /dev/<em class="replaceable"><code>sdX</code></em>
</pre></div>
<p> Das Programm <span class="command"><strong>install-mbr</strong></span> ist im Debian-Paket <code class="classname">mbr</code> enthalten. Erstellen Sie dann ein Dateisystem: </p>
<div class="informalexample"><pre class="screen">
# mkdosfs /dev/<em class="replaceable"><code>sdX1</code></em>
</pre></div>
<p> Achten Sie darauf, dass Sie den richtigen Gerätenamen für den USB-Stick verwenden. Das Programm <span class="command"><strong>mkdosfs</strong></span> ist im Debian-Paket <code class="classname">dosfstools</code> enthalten. </p>
</td></tr>
</table></div>
<p>Um den Kernel starten zu können, nachdem vom USB-Stick gebootet wurde, werden wir einen Bootloader auf dem Stick ablegen. Obwohl jeder Bootloader (wie z.B. <code class="classname">lilo</code>) funktionieren sollte, wird empfohlen, <code class="classname">syslinux</code> zu verwenden, da er eine FAT16-Partition benutzt und über eine Textdatei konfiguriert werden kann. Jedes Betriebssystem, das das FAT-Dateisystem unterstützt, kann verwendet werden, um die Konfiguration des Bootloaders zu verändern. </p>
<p>Um <code class="classname">syslinux</code> auf die FAT16-Partition des USB-Sticks zu befördern, installieren Sie die Pakete <code class="classname">syslinux</code> und <code class="classname">mtools</code> auf Ihrem System und führen dann aus: </p>
<div class="informalexample"><pre class="screen">
# syslinux /dev/<em class="replaceable"><code>sdX1</code></em>
</pre></div>
<p> Hier nochmals die Warnung, den richtigen Gerätenamen zu verwenden. Die Partition darf nicht ins Dateisystem eingebunden sein, wenn <code class="classname">syslinux</code> ausgeführt wird. Durch diese Prozedur wird ein Boot-Sektor auf die Partition geschrieben und die Datei <code class="filename">ldlinux.sys</code> erstellt, die den Bootloader-Code enthält. </p>
</div>
<div class="sect3">
<div class="titlepage"><div><div><h4 class="title">
<a name="idm861"></a>4.3.3.2. Ein Installer-Image auf den Stick kopieren</h4></div></div></div>
<p>Binden Sie die Partition ins Dateisystem ein (<strong class="userinput"><code>mount /dev/sdX1 /mnt</code></strong>) und kopieren Sie die folgenden Installer-Image-Dateien auf den Stick: </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p> <code class="filename">vmlinuz</code> oder <code class="filename">linux</code> (Kernel-Binär-Datei) </p></li>
<li class="listitem"><p> <code class="filename">initrd.gz</code> (Initial-RAM-Disk-Image) </p></li>
</ul></div>
<p> Sie können wählen zwischen dem textbasierten und dem grafischen Installer. Letzteren finden Sie im <code class="filename">gtk</code>-Unterverzeichnis. Wenn Sie die Dateien umbenennen möchten, beachten Sie, dass <code class="classname">syslinux</code> nur Dateinamen im DOS-(8.3)Format verarbeiten kann. </p>
<p>Als nächstes sollten Sie eine Konfigurationsdatei <code class="filename">syslinux.cfg</code> erstellen, die mindestens die folgende Zeile enthält: </p>
<div class="informalexample"><pre class="screen">
default vmlinuz initrd=initrd.gz
</pre></div>
<p> (Verwenden Sie als Name für die Kernel-Binärdatei <span class="quote">„<span class="quote"><code class="filename">linux</code></span>“</span>, wenn Sie ein <code class="filename">netboot</code>-Image benutzt haben.) Falls Sie den grafischen Installer verwenden möchten, sollten Sie der Zeile <strong class="userinput"><code>vga=788</code></strong> hinzufügen. Auf Wunsch können weitere Parameter angegeben werden. </p>
<p>Um den Boot-Prompt zu aktivieren und so weitere Anpassungen der Parameter zuzulassen, fügen Sie eine Zeile mit dem Inhalt <strong class="userinput"><code>prompt 1</code></strong> hinzu. </p>
<p>Wenn Sie ein <code class="filename">hd-media</code>-Image benutzt haben, sollten Sie jetzt noch die ISO-Datei eines Debian-ISO-Images<a href="#ftn.idm887" class="footnote" name="idm887"><sup class="footnote">[4]</sup></a> auf den Stick kopieren. Danach lösen Sie die Einbindung der Partition wieder (<strong class="userinput"><code>umount /mnt</code></strong>). </p>
</div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div id="ftn.idm836" class="footnote"><p><a href="#idm836" class="para"><sup class="para">[3] </sup></a> Vergessen Sie nicht, die <span class="quote">„<span class="quote">bootable</span>“</span>-Markierung (Boot-Flag) zu setzen. </p></div>
<div id="ftn.idm887" class="footnote"><p><a href="#idm887" class="para"><sup class="para">[4] </sup></a> Sie können dafür ein Netinst- oder ein Komplett-CD-Image verwenden (siehe <a class="xref" href="ch04s01.html" title="4.1. Offizielle Debian GNU/Linux-CD/DVD-ROMs">Abschnitt 4.1, „Offizielle Debian GNU/Linux-CD/DVD-ROMs“</a>). Stellen Sie sicher, dass das Image Ihrer Wahl auf den Stick passt. Beachten Sie, dass das <span class="quote">„<span class="quote">netboot <code class="filename">mini.iso</code></span>“</span>-Image für diesen Zweck nicht geeignet ist. </p></div>
</div>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left">
<a accesskey="p" href="ch04s02.html"><img src="images/prev.png" alt="Zurück"></a> </td>
<td width="20%" align="center"><a accesskey="u" href="ch04.html"><img src="images/up.png" alt="Nach oben"></a></td>
<td width="40%" align="right"> <a accesskey="n" href="ch04s04.html"><img src="images/next.png" alt="Weiter"></a>
</td>
</tr>
<tr>
<td width="40%" align="left" valign="top">4.2. Dateien von einem Debian-Spiegel-Server herunterladen </td>
<td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.png" alt="Zum Anfang"></a></td>
<td width="40%" align="right" valign="top"> 4.4. Dateien vorbereiten für das Booten von Festplatte</td>
</tr>
</table>
</div>
</body>
</html>
