Debian GNU/Linux -- instalační příručka

Copyright © 2004 - 2019 tým okolo instalačního programu Debianu

Tento manuál je volně šiřitelný; můžete ho distribuovat nebo pozměnit za
podmínek uvedených v licenci GNU General Public Licence. Text licence naleznete
v F - "Český překlad GNU General Public License".

Abstrakt

Dokument obsahuje návod na instalaci systému Debian GNU/Linux 10 (kódové
označení "buster"), pro počítače 32-bit PC ("i386"). Kromě návodu zde naleznete
odkazy na další dokumentaci, která vám pomůže s detailnějším nastavením a
vyladěním nového systému.

Varování

Tento překlad instalační příručky není aktuální a momentálně na něm nikdo
nepracuje. Při čtení tedy mějte na paměti, že může obsahovat zastaralé nebo
mylné informace. Jste-li na pochybách, konzultujte anglickou verzi. Můžete-li
nám pomoci s překladem, kontaktujte prosím <debian-boot@lists.debian.org> nebo
českou překladatelskou diskusní skupinu debian-l10n-czech. Děkujeme.

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Obsah

Instalace systému Debian GNU/Linux 10 na architektuře i386
1. Vítejte v Debianu

    1.1. Co je Debian?
    1.2. Co je GNU/Linux?
    1.3. Co je Debian GNU/Linux?
    1.4. Získání Debianu
    1.5. Získání nejnovější verze této příručky
    1.6. Organizace příručky
    1.7. O licenčních ujednáních

2. Požadavky na počítač

    2.1. Podporovaná zařízení

        2.1.1. Podporované počítačové architektury
        2.1.2. Procesory, základní desky a grafické karty
        2.1.3. Notebooky
        2.1.4. Víceprocesorové systémy
        2.1.5. Podpora grafických karet
        2.1.6. Hardware pro připojení k síti
        2.1.7. Braillovy řádky
        2.1.8. Hardwarová syntéza hlasu
        2.1.9. Ostatní zařízení

    2.2. Ovladače vyžadující firmware
    2.3. Hardware určený pro GNU/Linux

        2.3.1. Vyvarujte se uzavřených technologií

    2.4. Instalační média

        2.4.1. CD-ROM/DVD-ROM/BD-ROM
        2.4.2. USB Memory Stick
        2.4.3. Síť
        2.4.4. Pevný disk
        2.4.5. Un*x nebo systém GNU
        2.4.6. Podporovaná datová média

    2.5. Požadavky na operační paměť a diskový prostor

3. Než začnete s instalací

    3.1. Přehled instalačního procesu
    3.2. Zálohujte si svá data!
    3.3. Dále budete potřebovat

        3.3.1. Dokumentace
        3.3.2. Hledání zdrojů informací o hardwaru
        3.3.3. Hardwarová kompatibilita
        3.3.4. Nastavení sítě

    3.4. Splnění minimálních hardwarových požadavků
    3.5. Předrozdělení disku pro více operačních systémů
    3.6. Než začnete s instalací ...

        3.6.1. Vyvolání menu systému BIOS
        3.6.2. Výběr zaváděcího zařízení
        3.6.3. Systémy s firmwarem UEFI
        3.6.4. Vypnutí "rychlého spuštění" u Windows 8
        3.6.5. Různé hardwarové problémy

4. Získání instalačních médií

    4.1. Oficiální sada CD/DVD-ROM
    4.2. Stažení souborů ze zrcadel Debianu

        4.2.1. Kde se nalézají instalační obrazy?

    4.3. Příprava souborů pro zavedení z USB zařízení

        4.3.1. Příprava USB klíčenky s hybridním CD/DVD obrazem
        4.3.2. Ruční kopírování souborů
        4.3.3. Ruční kopírování souborů -- pružná cesta

    4.4. Příprava souborů pro zavedení z pevného disku

        4.4.1. Zavedení instalačního systému programem LILO nebo GRUB
        4.4.2. Zavedení instalačního systému programem loadlin

    4.5. Příprava souborů pro zavedení ze sítě pomocí TFTP

        4.5.1. Nastavení DHCP serveru
        4.5.2. Nastavení BOOTP serveru
        4.5.3. Povolení TFTP serveru
        4.5.4. Přesun TFTP obrazů na místo

    4.6. Automatická Instalace

        4.6.1. debian-installer

5. Zavedení instalačního systému

    5.1. Zavedení instalátoru na 32-bit PC

        5.1.1. Zavedení z USB "klíčenky"
        5.1.2. Zavedení z CD-ROM
        5.1.3. Zavedení z Windows
        5.1.4. Zavedení z DOSu pomocí loadlin
        5.1.5. Zavedení z Linuxu programem LILO nebo GRUB
        5.1.6. Zavedení z TFTP
        5.1.7. Zaváděcí obrazovka
        5.1.8. Grafický instalátor

    5.2. Zpřístupnění

        5.2.1. Uživatelské rozhraní instalačního systému
        5.2.2. Braillův řádek připojený na USB
        5.2.3. Braillův řádek připojený na sériový port
        5.2.4. Softwarová syntéza hlasu
        5.2.5. Hardwarová syntéza hlasu
        5.2.6. Zařízení připojená rovnou na sběrnici
        5.2.7. Kontrastní téma
        5.2.8. Změna velikosti písma
        5.2.9. Záchranný režim, expertní a automatizované instalace
        5.2.10. Zpřístupnění v nainstalovaném systému

    5.3. Zaváděcí parametry

        5.3.1. Zavěděcí konzole
        5.3.2. Parametry instalačního programu
        5.3.3. Použití zaváděcích parametrů pro zodpovězení otázek
        5.3.4. Předávání parametrů jaderným modulům
        5.3.5. Zapsání jaderných modulů na černou listinu

    5.4. Problémy s instalačním systémem

        5.4.1. Spolehlivost CD
        5.4.2. Zaváděcí konfigurace
        5.4.3. Softwarová syntéza hlasu
        5.4.4. Běžné instalační problémy na 32-bit PC
        5.4.5. Význam hlášek při zavádění jádra
        5.4.6. Hlášení problémů s instalací
        5.4.7. Pošlete nám zprávu o instalaci

6. Používáme instalační program Debianu

    6.1. Základní principy

        6.1.1. Používání grafického instalátoru

    6.2. Úvod do komponent
    6.3. Použití jednotlivých komponent

        6.3.1. Nastavení instalačního programu a rozpoznání hardwaru
        6.3.2. Nastavení uživatelů a hesel
        6.3.3. Rozdělení disku a výběr přípojných bodů
        6.3.4. Instalace základního systému
        6.3.5. Instalace dodatečného softwaru
        6.3.6. Nastavení zavádění systému
        6.3.7. Dokončení instalace
        6.3.8. Řešení problémů
        6.3.9. Instalace přes síť

    6.4. Nahrání chybějícího firmwaru

        6.4.1. Příprava média
        6.4.2. Firmware a instalovaný systém

7. Zavedení vašeho nového systému

    7.1. Okamžik pravdy
    7.2. Připojení zašifrovaných svazků

        7.2.1. Řešení problémů

    7.3. Přihlášení do systému

8. Co dál?

    8.1. Vypínání systému
    8.2. První kroky se systémem UNIX
    8.3. Orientace v Debianu

        8.3.1. Balíčkovací systém Debianu
        8.3.2. Další software pro Debian
        8.3.3. Správa různých verzí programů
        8.3.4. Správa Cronu

    8.4. Další dokumentace
    8.5. Nastavení poštovního systému

        8.5.1. Výchozí nastavení pošty
        8.5.2. Odesílání pošty mimo systém
        8.5.3. Nastavení poštovního serveru Exim4

    8.6. Kompilace nového jádra

        8.6.1. Správa jader

    8.7. Obnovení poškozeného systému

A. Jak na instalaci

    A.1. Příprava
    A.2. Zavedení instalačního programu

        A.2.1. CDROM
        A.2.2. USB Memory Stick
        A.2.3. Zavedení ze sítě
        A.2.4. Zavedení z pevného disku

    A.3. Instalace
    A.4. Pošlete nám zprávu o instalaci
    A.5. A na závěr...

B. Automatizování instalací pomocí přednastavení

    B.1. Úvod

        B.1.1. Způsoby přednastavení
        B.1.2. Omezení

    B.2. Použití

        B.2.1. Nahrání souboru s přednastavením
        B.2.2. Použití zaváděcích parametrů jako formy přednastavení
        B.2.3. Automatický režim
        B.2.4. Užitečné aliasy
        B.2.5. Použití DHCP serveru pro určení souboru s přednastavením

    B.3. Vytvoření souboru s přednastavením
    B.4. Obsah souboru s přednastavením (pro buster)

        B.4.1. Lokalizace
        B.4.2. Nastavení sítě
        B.4.3. Síťová konzole
        B.4.4. Nastavení zrcadla
        B.4.5. Nastavení účtů
        B.4.6. Nastavení hodin a časového pásma
        B.4.7. Rozdělení disku
        B.4.8. Instalace základního systému
        B.4.9. Nastavení APT
        B.4.10. Výběr balíků
        B.4.11. Instalace zavaděče
        B.4.12. Dokončení instalace
        B.4.13. Přednastavení ostatních balíků

    B.5. Pokročilé možnosti

        B.5.1. Spouštění vlastních příkazů během instalace
        B.5.2. Použití přednastavení pro změnu výchozích hodnot
        B.5.3. Zřetězené nahrávání souborů s přednastavením

C. Poznámky k rozdělování disku

    C.1. Počet a velikost oblastí
    C.2. Strom adresářů
    C.3. Doporučené rozdělení disku
    C.4. Jak Linux pojmenovává pevné disky
    C.5. Dělící programy v Debianu

        C.5.1. Dělení disku na 32-bit PC

D. Co se jinam nevešlo

    D.1. Zařízení v Linuxu

        D.1.1. Nastavení myši

    D.2. Místo potřebné pro úlohy
    D.3. Jak nainstalovat Debian GNU/Linux ze stávajícího unixového/linuxového
        systému

        D.3.1. Přípravné práce
        D.3.2. Instalace balíku debootstrap
        D.3.3. Spuštění debootstrapu
        D.3.4. Nastavení základního systému
        D.3.5. Instalace jádra
        D.3.6. Nastavení zavaděče
        D.3.7. Vzdálený přístup: Instalace SSH a nastavení přístupu
        D.3.8. Závěrečné kroky

    D.4. Jak nainstalovat Debian GNU/Linux přes paralelní port (PLIP)

        D.4.1. Požadavky
        D.4.2. Nastavení stroje earthsimulator
        D.4.3. Instalace na nahepc

    D.5. Jak nainstalovat Debian GNU/Linux pomocí PPP přes Ethernet (PPPoE)

E. Administrivia

    E.1. O tomto dokumentu
    E.2. Jak přispět k tomuto návodu
    E.3. Hlavní spoluautoři
    E.4. Český překlad
    E.5. Ochranné známky

F. Český překlad GNU General Public License

Seznam tabulek

3.1. Hardwarové informace užitečné pro instalaci
3.2. Doporučené minimální požadavky

Instalace systému Debian GNU/Linux 10 na architektuře i386

Jsme potěšeni, že jste se rozhodli vyzkoušet právě Debian. Poznáte, že je mezi
distribucemi operačních systémů zcela výjimečný. Debian GNU/Linux přináší
kvalitní svobodný software z celého světa a spojuje jej do koherentního celku.
Věříme, že zjistíte, že i zde platí pravidlo synergie: přínos softwaru v
distribuci Debian je mnohem vyšší než celkový přínos samostatných programů.

Chápeme, že mnoho čtenářů bude chtít přeskočit tuto příručku a začít rovnou s
instalací (a instalační program se snaží, aby to bylo možné). Pokud tedy nemáte
čas číst celou instalační příručku, přečtěte si alespoň krátký dokument nazvaný
"Jak na instalaci", který vás provede základní instalací. Pro případ, že se
něco pokazí, nebo pro popis složitějších technik, v něm naleznete odkazy do
této instalační příručky. Krátký dokument se nalézá v A - "Jak na instalaci".

Ve světle řečeného doufáme, že si naleznete čas přečíst většinu této příručky,
protože získáte nejen zajímavé informace, ale také budete mít z instalace lepší
zážitek.

Kapitola 1. Vítejte v Debianu

Obsah

1.1. Co je Debian?
1.2. Co je GNU/Linux?
1.3. Co je Debian GNU/Linux?
1.4. Získání Debianu
1.5. Získání nejnovější verze této příručky
1.6. Organizace příručky
1.7. O licenčních ujednáních

V této kapitole se stručně seznámíte s historií projektu Debian a s distribucí
Debian GNU/Linux. Pokud jste nedočkaví a chcete přejít rovnou k instalaci,
přeskočte klidně na následující kapitolu.

1.1. Co je Debian?

Debian je výhradně dobrovolnická organizace věnující se vývoji svobodného
softwaru a šíření myšlenek Free Software Foundation. Debian vznikl v roce 1993,
když se Ian Murdock rozhodl vytvořit kompletní a jednotnou softwarovou
distribuci založenou na relativně novém jádře Linux. Ian rozeslal otevřenou
výzvu softwarovým vývojářům, kteří by chtěli k projektu přispívat. Relativně
malá skupina zasvěcených nadšenců, původně financovaná Free Software Foundation
a ovlivněna filosofií GNU, se během let rozrostla do organizace sestávající z
asi 1000 vývojářů.

Vývojáři jsou zapojeni do mnoha aktivit zahrnujících správu služeb WWW a FTP,
vytváření grafického designu, právní analýzy softwarových licencí, psaní
dokumentace a samozřejmě správu softwarových balíků.

V zájmu sdělování své filosofie a přilákání vývojářů, kteří věří tomu, co
Debian reprezentuje, jsme publikovali množství dokumentů, které vysvětlují naše
hodnoty a slouží jako návody těm, kteří se chtějí stát debianími vývojáři.

  • Novým vývojářem se může stát kdokoli, kdo souhlasí se závazky plynoucími z
    Debian Social Contract. Každý vývojář může k distribuci připojit další
    softwarový balík za předpokladu, že program je podle našich kritérií volně
    šiřitelný a balík splňuje naše standardy kvality.

  • Dokument Debian Free Software Guidelines je jasný a výstižný souhrn
    kritérií, která Debian klade na svobodný software. Tento dokument má ve
    světě svobodného softwaru velký vliv a je základem pro The Open Source
    Definition.

  • Debian má rozsáhlé specifikace standardů kvality obsažené v Debian Policy
    Manual. Dokument určuje podmínky, které musí splňovat každý balík v naší
    distribuci.

Vývojáři Debianu jsou rovněž zainteresováni v řadě dalších projektů, z nichž
některé úzce souvisí přímo s Debianem, jiné se dotýkají celé linuxové komunity.
Například:

  • Přispívání do Linux Standard Base (LSB). Projekt LSB se zaměřuje na
    standardizaci základního systému GNU/Linuxu, což umožní vývojářům softwaru
    a hardwaru třetích stran vyvíjet pro GNU/Linux takové programy a zařízení,
    které budou fungovat v Linuxu obecně a ne jen v konkrétních vybraných
    distribucích.

  • Projekt Filesystem Hierarchy Standard (FHS) se snaží standardizovat
    umístění souborů v linuxovém systému. Softwaroví vývojáři se tak budou moci
    plně koncentrovat na vývoj svých programů a nebudou se muset dále starat o
    to, zda jejich balík bude fungovat na jiné distribuci GNU/Linuxu.

  • Debian Jr. je interní projekt Debianu zaměřený především na naše nejmenší
    uživatele.

Pokud se chcete o Debianu dozvědět víc, podívejte se na Debian FAQ.

1.2. Co je GNU/Linux?

Linux je operační systém, což je skupina programů, které vám mimo jiné umožňují
komunikovat s počítačem a spouštět další programy.

Operační systém se skládá z řady základních programů, které potřebuje každý
počítač, aby byl vůbec schopen pracovat s různými periferiemi (např. pracovat s
daty na discích a páskách, obsluhovat tiskárny, přidělovat paměť, ...),
komunikovat s uživatelem a spouštět programy. Nejdůležitější částí operačního
systému je jádro, což je v systému GNU/Linux právě Linux. Zbytek systému okolo
jádra je tvořen nejrůznějšími programy, z nichž spousta byla napsána v rámci
projektu GNU. Protože jádro samotné netvoří funkční operační systém,
preferujeme pro označení takovýchto systémů termín "GNU/Linux". (Lidé obvykle
říkají "Linux", ale mají tím na mysli GNU/Linux.)

Linux byl od počátku navržen jako operační systém unixového typu s podporou
souběžné práce více uživatelů, kteří mohou mít najednou spuštěno několik
programů (multitasking). Na rozdíl od některých jiných operačních systémů Linux
nikdo nevlastní a velkou měrou se na jeho vývoji podílí neplacení dobrovolníci.

Počátky toho, co se později stalo GNU/Linuxem, sahají do roku 1984, když Free
Software Foundation zahájila vývoj svobodného operačního systému podobného
Unixu nazvaného GNU.

Projekt GNU vytvořil úplnou sadu svobodných softwarových nástrojů použitelných
s operačním systémem Unix (tm) a systémy Unixu podobnými, jako je třeba Linux.
Tyto nástroje umožňují uživateli provádět celou škálu úloh od rutinních operací
jako je kopírování nebo mazání souborů přes důmyslnou úpravu dokumentů až po
zábavné programování a překlad programů.

Přestože k vývoji Linuxu přispělo mnoho skupin i jednotlivců, největším
přispěvatelem je stále Free Software Foundation (FSF), která nejen že vytvořila
většinu nástrojů používaných v Linuxu, ale také dala vzniknout filozofii a
komunitě vývojářů, bez kterých by se Linux nikdy nerozšířil.

První linuxové jádro se objevilo v roce 1991 a napsal jej Fin Linus Torvalds,
tehdejší student Helsinské univerzity, jako náhradu za Minix (viz Historie
Linuxu).

Nyní na jádře aktivně pracuje několik stovek lidí z celého světa a Linus
koordinuje vývoj za pomoci několika správců jednotlivých podsystémů. Jádro
Linux má své vlastní webové stránky. Informace o konferenci linux-kernel můžete
najít na stránce linux-kernel mailing list FAQ.

Uživatelé Linuxu mají nesmírnou svobodu ve výběru svého software -- například
si mohou vybrat z tuctu různých příkazových interpretů a několika grafických
prostředí. Na druhou stranu je to právě tato svoboda výběru, která mate
uživatele jiných operačních systémů, protože nejsou zvyklí uvažovat o
příkazovém řádku nebo grafickém prostředí jako o něčem, co mohou změnit.

Již zmíněné vlastnosti Linuxu spolu s jeho stabilitou a vyšší bezpečností
přilákaly mnoho nadšenců a Linux se stal nejrychleji rostoucím serverovým
operačním systémem. Se svou větší popularitou se později Linux začal prosazovat
i ve firmách a mezi domácími uživateli.

1.3. Co je Debian GNU/Linux?

Kombinace filosofie a metodologie Debianu spolu s nástroji GNU, jádrem Linux a
dalším svobodným softwarem vyústila do unikátní softwarové distribuce, která je
známá pod názvem Debian GNU/Linux. Distribuci Debian tvoří množství
softwarových balíků. Jednotlivé balíky sestávají ze spustitelných souborů,
skriptů, dokumentace a konfiguračních souborů. Každý balík má svého správce,
který za něj zodpovídá (udržuje balík aktuální, sleduje hlášení o chybách a
komunikuje s autorem, jehož software balíčkuje). Díky poměrně velké základně
uživatelů v kombinaci se systémem hlášení chyb bývají problémy v balících
nalezeny a odstraněny velice rychle.

Debian je obzvláště populární mezi pokročilými uživateli, kteří si cení jeho
stabilitu, technickou preciznost a přizpůsobitelnost. Systém může vystupovat v
různých rolích -- od minimalistického firewallu přes vědeckou pracovní stanici
až po vysoce výkonný síťový server. Během vývoje distribuce vzniklo mnoho
průkopnických myšlenek, které jsou dnes považovány za zcela samozřejmé.

Debian byl například první linuxovou distribucí, která obsahovala systém pro
správu balíků, čímž se stala instalace programů triviální záležitostí. Debian
byl také první linuxovou distribucí, kterou jste mohli aktualizovat bez
přeinstalování celého systému.

I dnes si Debian zachovává některé unikátní vlastnosti. Například jeho vývojový
proces je ukázkou toho, že model otevřeného vývoje může fungovat i pro tak
rozsáhlý projekt, jako je vývoj a údržba kompletního operačního systému.

Vlastnost, kterou se Debian nejvíc odlišuje od ostatních linuxových distribucí,
je jeho systém pro správu balíků. Tento soubor nástrojů dává administrátorovi
systému Debian úplnou kontrolu nad balíky, ze kterých se systém skládá.
Umožňuje mu například automatickou aktualizaci celé distribuce nebo naopak
označení balíků, které by neměly být aktualizovány. Dokonce je možné upozornit
systém na vlastní přeložené balíky a určit, jaké jsou závislosti mezi nimi a
oficiálními balíky.

Aby byl váš systém ochráněn před trojskými koňmi a jinými zlovolnými programy,
debianí servery automaticky ověřují, že balíky přicházejí do distribuce od
jejich skutečných správců. Debianí vývojáři rovněž usilují o to, aby byly
programy nakonfigurovány bezpečně již při standardním nastavení. Jestliže se u
distribuovaných balíků vyskytnou bezpečnostní problémy, jsou záhy k dispozici
jejich opravy, které si můžete pomocí jednoduchých aktualizačních nástrojů
automaticky stahovat a instalovat přes Internet.

Pokud chcete získat podporu pro svůj systém s Debian GNU/Linuxem, nebo jen
chcete komunikovat s vývojáři distribuce, můžete tak učinit pomocí více jak 317
diskusních klubů, které Debian spravuje. Pro přihlášení do některého z nich
stačí vyplnit formulář na přihlašovací stránce.

1.4. Získání Debianu

Informace o stažení systému Debian GNU/Linux z Internetu nebo seznam míst
dodávajících oficiální CD s Debianem můžete nalézt na distribuční stránce.
Seznam zrcadel Debianu obsahuje kompletní seznam oficiálních serverů, ze
kterých si můžete Debian stáhnout.

Aktualizace Debianu je velmi jednoduchá, protože systém je navržený tak, aby
jej nebylo třeba přeinstalovávat. S prvotním nastavením systému pro budoucí
aktualizace vám pomůže instalační program.

1.5. Získání nejnovější verze této příručky

Tato příručka je živý dokument -- stále se mění, aktualizuje a zlepšuje.
Nejčerstvější informace o systému Debian GNU/Linux verze 10, které se objevily
až po oficiálním vydání, můžete najít na stránkách pro Debian 10. Aktualizovaná
verze této příručky je rovněž k dispozici na stránkách oficiálního instalačního
manuálu.

1.6. Organizace příručky

Tato příručka si klade za cíl sloužit jako manuál pro nové uživatele Debianu a
od čtenáře neočekává žádné speciální znalosti a zkušenosti. Předpokládá však,
že máte obecnou představu o tom, jak funguje váš hardware.

Také uživatelé-experti mohou v tomto dokumentu najít zajímavé informace jako
např. velikost minimální instalace, detaily týkající se hardwaru podporovaného
instalačním systémem Debianu apod. Zkušeným uživatelům doporučujeme některé
pasáže přeskočit.

Obecně lze říct, že je tento dokument pojat přímočaře a provede vás instalačním
procesem krok za krokem. Následující seznam zachycuje jednotlivé kroky
instalace a kapitoly, které se jimi zabývají.

 1. Zjištění, zda-li vaše hardwarová konfigurace umožňuje instalaci systému,
    viz 2 - "Požadavky na počítač".

 2. Záloha dat, naplánování instalace a konfigurace hardwaru předcházející
    instalaci systému, viz 3 - "Než začnete s instalací". Jestliže se chystáte
    instalovat na pevný disk s více operačními systémy, budete možná muset pro
    Debian vytvořit místo na diskovou oblast.

 3. Získání potřebných instalačních souborů pro zvolenou metodu instalace, viz
    4 - "Získání instalačních médií".

 4. 5 - "Zavedení instalačního systému" popisuje zavedení instalačního systému.
    Zde také naleznete různé rady jak postupovat, pokud zavedení systému selže.

 5. Samotnou instalací vás provede 6 - "Používáme instalační program Debianu".
    To zahrnuje výběr jazyka, nastavení modulů zařízení, zprovoznění sítě, aby
    se zbývající instalační soubory mohly stáhnout ze serveru poskytujícího
    Debian (pokud tedy neinstalujete z CD/DVD), rozdělení disku, instalaci
    základního systému a výběr a instalaci úloh. (Technickými detaily pro
    nastavení diskových oblastí se zabývá C - "Poznámky k rozdělování disku".)

 6. Zavedení nově nainstalovaného systému, viz 7 - "Zavedení vašeho nového
    systému".

Jakmile nainstalujete systém, měli byste si přečíst 8 - "Co dál?". Tato
kapitola vysvětluje, kam se máte podívat po dalších informacích o Unixu a
Debianu a jak aktualizovat jádro systému.

Konečně informace o tomto dokumentu a způsobu, jak do něj přispět, obsahuje E -
"Administrivia".

1.7. O licenčních ujednáních

Licenční podmínky většiny programů opravňují k používání programu pouze na
jednom počítači. Debian GNU/Linux taková omezení nemá. Budeme rádi, pokud ho
nainstalujete na další počítače ve škole či zaměstnání, zapůjčíte známým a
pomůžete jim s instalací. Můžete dokonce vyrobit tisíce kopií a prodávat je.
Stačí dodržet jistá pravidla. To všechno je možné díky tomu, že Debian je
založen na svobodném softwaru.

Slovo svobodný neznamená, že software postrádá copyright, nebo že se
distribuuje zdarma na CD. Znamená to, že licence jednotlivých programů
nevyžadují poplatek za právo program kopírovat. Kdokoli může program rozšířit,
přizpůsobit, pozměnit a výsledné dílo šířit dál.

Poznámka

Poznamenejme, že jako pragmatický ústupek svým uživatelům, balíčkují debianí
vývojáři i software, který nesplňuje naši definici svobodného software. Tyto
balíky nejsou součástí oficiální distribuce a jsou dostupné pouze v částech
debianích zrcadel nazvaných contrib a non-free, případně na CD/DVD vyráběných
třetími stranami. Obsah a struktura zrcadel jsou popsány v Debian FAQ pod
názvem "The Debian FTP archives".

Hodně programů v systému je licencovaných podle GNU General Public License
(obecná veřejná licence) neboli krátce GPL. Licence GPL vyžaduje, abyste
kdykoliv, když distribuujete kopii programu, zajistili dostupnost zdrojových
kódů programu; to zaručuje, že vy, jakožto uživatelé, můžete dále modifikovat
kód a přizpůsobit si software svým potřebám. Proto jsou ke všem takovým
programům v systému Debian dostupné i zdrojové kódy.^[1]

Některé programy v Debianu používají i jiná licenční ujednání. Autorská práva a
licenční ujednání ke každému balíku lze nalézt v souboru /usr/share/doc/
jméno-balíku/copyright .

Pokud se chcete dozvědět více o licencích a o tom, co Debian pokládá za
svobodný software, podívejte se na Debian Free Software Guidelines.

Nejdůležitější právní poznámka je, že tento software je bez jakékoliv záruky.
Programátoři, kteří vytvořili tento software, to udělali pro prospěch celé
komunity. Nezaručujeme, že software se bude hodit pro dané účely. Na druhou
stranu, jelikož se jedná o svobodný software, můžete jej měnit tak, aby
odpovídal vašim potřebám -- a využívat kódu ostatních, kteří stejným způsobem
rozšiřují tento software.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[1] Pokud se chcete dozvědět víc o tom, jak vyhledat a rozbalit zdrojové
balíky, podívejte se do Debian FAQ na část "Basics of the Debian Package
Management System".

Kapitola 2. Požadavky na počítač

Obsah

2.1. Podporovaná zařízení

    2.1.1. Podporované počítačové architektury
    2.1.2. Procesory, základní desky a grafické karty
    2.1.3. Notebooky
    2.1.4. Víceprocesorové systémy
    2.1.5. Podpora grafických karet
    2.1.6. Hardware pro připojení k síti
    2.1.7. Braillovy řádky
    2.1.8. Hardwarová syntéza hlasu
    2.1.9. Ostatní zařízení

2.2. Ovladače vyžadující firmware
2.3. Hardware určený pro GNU/Linux

    2.3.1. Vyvarujte se uzavřených technologií

2.4. Instalační média

    2.4.1. CD-ROM/DVD-ROM/BD-ROM
    2.4.2. USB Memory Stick
    2.4.3. Síť
    2.4.4. Pevný disk
    2.4.5. Un*x nebo systém GNU
    2.4.6. Podporovaná datová média

2.5. Požadavky na operační paměť a diskový prostor

V této kapitole se dozvíte informace o hardwarových požadavcích distribuce a
také zde naleznete odkazy na další informace o zařízeních podporovaných jádrem
Linux a GNU programy.

2.1. Podporovaná zařízení

Debian neklade na hardware jiná omezení než ta, která jsou dána jádrem Linuxu
nebo kFreeBSD a programy GNU. Tedy na libovolné počítačové architektuře, na
kterou bylo přeneseno jádro Linuxu nebo kFreeBSD, knihovna libc, překladač gcc
atd., a pro kterou existuje port Debianu, můžete Debian nainstalovat. Viz
stránka s porty (https://www.debian.org/ports/i386/).

Než abychom se snažili popsat všechny podporované konfigurace hardwaru pro
architekturu 32-bit PC , zaměříme se spíše na obecné informace a uvedeme odkazy
na doplňující dokumentaci.

2.1.1. Podporované počítačové architektury

Debian GNU/Linux 10 podporuje deset hlavních počítačových architektur a několik
jejich variant.

┌───────────────────────────┬────────────────┬─────────────────────┬──────────┐
│       Architektura        │   Označení v   │   Podarchitektura   │ Varianta │
│                           │    Debianu     │                     │          │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│                           │                │standardní počítače  │výchozí   │
│založené na Intel x86      │i386            │x86                  │          │
│                           │                ├─────────────────────┼──────────┤
│                           │                │Xen PV               │xen       │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│AMD64 & Intel 64           │amd64           │                     │          │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│ARM                        │armel           │Marvell Kirkwood a   │marvell   │
│                           │                │Orion                │          │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│ARM s hardwarovým FPU      │armhf           │multiplatformní      │armmp     │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│64 bitové ARM              │arm64           │                     │          │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│                           │                │MIPS Malta           │4kc-malta │
│32 bitové MIPS (big endian)│mips            ├─────────────────────┼──────────┤
│                           │                │Cavium Octeon        │octeon    │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│                           │                │MIPS Malta           │5kc-malta │
│64 bitové MIPS             │                ├─────────────────────┼──────────┤
│(little-endian)            │mips64el        │Cavium Octeon        │octeon    │
│                           │                ├─────────────────────┼──────────┤
│                           │                │Loongson 3           │loongson-3│
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│                           │                │                     │          │
│                           │                ├─────────────────────┼──────────┤
│32bit MIPS (little endian) │mipsel          │MIPS Malta           │4kc-malta │
│                           │                ├─────────────────────┼──────────┤
│                           │                │Cavium Octeon        │octeon    │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│Loongson 3                 │loongson-3      │                     │          │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│Power Systems              │ppc64el         │IBM POWER8 nebo      │          │
│                           │                │novější              │          │
├───────────────────────────┼────────────────┼─────────────────────┼──────────┤
│64 bitové IBM S/390        │s390x           │IPL z VM-reader a    │generic   │
│                           │                │DASD                 │          │
└───────────────────────────┴────────────────┴─────────────────────┴──────────┘

Tato verze dokumentu se zabývá instalací Debianu s jádrem Linux na architektuře
32-bit PC . Pro ostatní podporované architektury jsou návody na stránkách
Debian-Ports.

2.1.2. Procesory, základní desky a grafické karty

Úplné informace o podporovaných zařízeních naleznete v Linux Hardware
Compatibility HOWTO. Tato kapitola nastiňuje pouze základní požadavky.

2.1.2.1. Procesory

Jsou podporovány téměř všechny aktivně používané procesory řady x86 (IA-32). To
zahrnuje i 32 bitové procesory AMD Athlon XP, Intel Pentium 4, Intel Xeon nebo
Via C3.

Debian GNU/Linux buster nepoběží na procesorech třídy 586 (Pentium) a starších.

Poznámka

Pokud je váš počítač postaven na 64 bitovém procesoru z rodiny AMD64 nebo Intel
64 (např. Intel Core i5), budete pravděpodobně chtít použít instalátor pro
architekturu amd64. Díky zpětné kompatibilitě však můžete použít i 32 bitový
instalátor pro architekturu i386.

2.1.2.2. V/V sběrnice

Systémová sběrnice je částí základní desky, která umožňuje procesoru komunikaci
s perifériemi jako jsou například datová média. Váš počítač musí být vybaven
sběrnicí PCI, PCIe nebo PCI-X.

2.1.3. Notebooky

Z technického pohledu jsou notebooky obyčejné počítače, tudíž se na ně vztahuje
vše napsané o stolních systémech. V dnešní době funguje většina notebooků bez
problémů, od automatického uspávání po zavření víka, až po speciální tlačítka
pro vypnutí Wi-Fi ("režim v letadle"). Jestliže notebook obsahuje nestandardní
nebo proprietární hardwarové prvky, je možné že tyto speciální funkce nebudou
fungovat. Na stránce Linux a notebooky zjistíte, zda na vašem notebooku GNU/
Linux poběží.

2.1.4. Víceprocesorové systémy

Tato architektura umožňuje využití více procesorů -- tzv. symetrický
multiprocesing (SMP). Standardní jádro v distribuci Debian GNU/Linux 10 bylo
sestaveno s podporou SMP-alternatives, což znamená, že jádro samo rozpozná
počet procesorů (nebo procesorových jader) a na jednoprocesorových počítačích
podporu SMP automaticky vypne.

Více procesorů v počítači bylo původně doménou výkonných serverů, ale s
uvedením konceptu vícejádrových procesorů, kdy jeden fyzický čip obsahuje
několik procesorových jednotek, tzv. "jader", se s nimi dnes setkáváme
prakticky všude.

2.1.5. Podpora grafických karet

Podpora grafických karet v grafickém režimu závisí na tom, zda pro kartu
existuje ovladač v projektu X.Org a v jádru. Základní podpora grafického
framebufferu je poskytována jádrem, desktopová prostředí používají X.org.
Podpora pokročilých vlastností, jako je hardwarová akcelerace 3D a videa,
závisí na použitém hardwaru a v některých případech i na instalaci dodatečného 
"firmware" (viz 2.2 - "Ovladače vyžadující firmware").

Na moderních počítačích by měl grafický režim fungovat zcela automaticky. Sice
byly zaznamenány případy, kdy byl firmware pro grafickou kartu vyžadován i pro
základní podporu grafického režimu, ale to se jednalo o výjimky. Pro spoustu
hardwaru funguje zcela automaticky i akcelerace 3D, ovšem stále existuje
hardware, který pro správnou funkčnost vyžaduje "binární blob"
(nezdokumentovaná hromada binárního kódu, o kterém není jisté, co vlastně
dělá).

Podrobnosti o podporovaných grafických kartách a ukazovacích zařízeních
naleznete na https://wiki.freedesktop.org/xorg/. Debian GNU/Linux 10 je dodáván
se systémem X.Org verze 7.7.

2.1.6. Hardware pro připojení k síti

Libovolná síťová karta (NIC) podporovaná jádrem Linux by měla být podporována i
instalačním systémem. Ovladače by se měly zavádět automaticky. To zahrnuje
většinu PCI/PCI-Express karet včetně notebookových PCMCIA/Express Cards. 
Podporováno je i mnoho starších karet pro sběrnici ISA.

ISDN je podporováno, ale ne během instalace.

2.1.6.1. Bezdrátové síťové karty

Bezdrátové síťové karty jsou obecně podporovány, nicméně mnoho bezdrátových
síťových adaptérů vyžaduje (nesvobodný) firmware.

Jestliže je vyžadován firmware, instalační systém vás během instalace vyzve k
jeho nahrání. Více informací o nahrávání firmware během instalace naleznete v
části 6.4 - "Nahrání chybějícího firmwaru".

Síťové karty, které nejsou podporovány oficiálním jádrem, lze obvykle pod
Debianem zprovoznit, avšak nejsou podporovány během instalace.

Jestliže bezdrátová karta zlobí a pro instalaci nemůžete použít jinou síťovou
kartu, stále lze pro instalaci Debianu použít obraz velkého CD nebo DVD. V
takovém případě přeskočte konfiguraci sítě a instalujte pouze balíky z CD nebo
DVD. Potřebný ovladač pak můžete spolu s firmwarem doinstalovat po dokončení
instalace a následném restartu do nového systému.

Pokud ovladač pro kartu existuje, ale není dostupný jako debianí balík, můžete
si stáhnout z Internetu jeho zdrojové kódy a následně zkompilovat, což však
přesahuje rozsah této příručky. Neexistuje-li svobodný ovladač, je vaší
poslední možností balík ndiswrapper, který umí použít ovladače z Windows.

2.1.7. Braillovy řádky

Podpora braillových řádků se odvíjí od jejich podpory v brltty. Měla by
fungovat většina řádků připojených přes sériový port, USB nebo bluetooth.
Podrobnosti o podporovaných zařízeních naleznete na webových stránkách brltty.
Debian GNU/Linux 10 obsahuje brltty verze 5.6.

2.1.8. Hardwarová syntéza hlasu

Podpora pro hardwarovou syntézu hlasu se odvíjí od jejich podpory v balíku
speakup. speakup podporuje pouze integrované karty a externí zařízení připojená
k sériovému portu. USB zařízení, zařízení připojená přes sériové-USB převodníky
nebo přes PCI nejsou podporována. Podrobnosti o podporovaných zařízeních pro
hardwarovou syntézu hlasu naleznete na webových stránkách speakupu. Debian GNU/
Linux 10 obsahuje speakup verze 3.1.6.

2.1.9. Ostatní zařízení

Linux umožňuje používat nejrůznější hardwarové vybavení jako myši, tiskárny,
scannery, televizní karty a zařízení PCMCIA/CardBus/ExpressCard a USB. Většina
z nich však není pro instalaci nutná. Některé USB klávesnice mohou na starých
počítačích vyžadovat speciální nastavení (viz 3.6.5 - "Různé hardwarové
problémy"), ale na soudobých počítačích pracují USB myši a klávesnice bez
dalšího nastavovaní.

2.2. Ovladače vyžadující firmware

Některý hardware vyžaduje kromě samotného ovladače zařízení také firmware nebo
mikrokód, který je třeba do zařízení před použitím nahrát. Nejčastěji se s tím
setkáte u síťových karet (obzvláště bezdrátových), ale jsou známa i některá USB
zařízení a dokonce řadiče disků. U mnoha grafických karet je základní funkčnost
dostupná i bez dodatečného firmware, nicméně pro využití pokročilejších
vlastností je třeba mít v systému nachystaný příslušný soubor s firmwarem.

Ve starších zařízeních býval firmware nahrán permanentně v EEPROM nebo Flash
paměti zařízení přímo od výrobce. To už se dnes příliš nenosí a proto je nutné
soubor s firmwarem do zařízení nahrát při každém startu počítače. Naštěstí to
nemusíme dělat ručně, ale postará se o to operační systém.

Ve většině případů je firmware dle definice Debianu nesvobodný a tudíž jej
nelze zařadit ani do distribuce, ani do instalačního systému. Jestliže je
ovladač samotný součástí Debianu a firmware je možno legálně distribuovat, je
možné, že ho naleznete jako samostatný balík v sekci non-free.

Naštěstí to neznamená, že takový hardware nemůžete pro instalaci použít.
Počínaje Debianem 5.0 podporuje debian-installer nahrávání firmwaru z výměnných
médií, jako jsou diskety nebo USB klíčenky. Tomuto tématu se podrobněji věnuje
kapitola 6.4 - "Nahrání chybějícího firmwaru".

Pokud se instalační systém zeptá na soubor s firmwarem pro nějaké zařízení a vy
zrovna firmware nemáte, nebo nechcete do systému instalovat nesvobodný balík,
můžete zkusit pokračovat i bez firmware. Je docela možné, že zařízení bude
fungovat, pouze nebudou dostupné některé pokročilé funkce (toto je případ
některých síťových karet s ovladačem tg3).

2.3. Hardware určený pro GNU/Linux

V současnosti již někteří prodejci dodávají počítače s nainstalovaným Debianem,
případně jinou distribucí GNU/Linuxu. Patrně si za tuto výhodu něco připlatíte,
ale zbavíte se starostí, poněvadž máte jistotu, že hardware počítače je se
systémem GNU/Linux plně kompatibilní.

Budete-li nuceni zakoupit počítač se systémem Windows, přečtěte si pozorně
jejich licenci, jestli můžete software odmítnout a zda vám budou vráceny
peníze. Více najdete na Internetu, když budete hledat klíčová slova "Windows
refund".

Ať už zakoupíte počítač se systémem GNU/Linux nebo bez něj, je důležité se
přesvědčit, že je hardware podporován jádrem operačního systému. Zkontrolujte
si, jestli jsou všechna zařízení v počítači uvedena ve výše zmíněných odkazech
jako podporovaná. Při nákupu se netajte tím, že kupujete počítač, na kterém
poběží Linux. Dejte přednost zboží, jehož výrobci Linux podporují.

2.3.1. Vyvarujte se uzavřených technologií

Někteří výrobci hardwaru nám neposkytují informace potřebné k napsání ovladačů
pro Linux, případně požadují podepsat smlouvu o uchování těchto informací v
tajnosti před třetími osobami, což znemožňuje uveřejnění zdrojového kódu pro
takový ovladač.

Z důvodu nedostupnosti dokumentace pro tento hardware neexistují ovladače pro
Linux.

V mnoha případech existují standardy (nebo alespoň nepsané standardy), které
popisují, jak má operační systém komunikovat s určitou skupinou zařízení.
Všechna zařízení, která takový (nepsaný) standard dodržují, mohou být
obsluhována jediným společným ovladačem. Konkrétním příkladem skupin zařízení,
kde to funguje extrémně dobře, jsou třeba USB Human Interface Devices
(klávesnice, myši, herní ovladače) nebo USB Mass Storage Devices (USB klíčenky
a čtečky paměťových karet), kde prakticky každé zařízení na trhu odpovídá
standardům.

Naproti tomu třeba v oblasti tiskáren je situace výrazně horší. I když existují
tiskárny, které se dají ovládat několika (více či méně) standardními ovládacími
jazyky a tudíž je lze zprovoznit v téměř libovolném operačním systému, existuje
dost modelů, které rozumí pouze proprietárním příkazům, ke kterým neexistuje
žádná dostupná dokumentace. Takové tiskárny se ve svobodných operačních
systémech buď nedají používat vůbec, nebo pouze s uzavřeným ovladačem od
výrobce.

V případě existence uzavřeného ovladače od výrobce mějte na paměti, že
praktická životnost takového zařízení je omezena na dobu, po kterou je dostupný
ovladač. Se zkracováním životního cyklu výrobku není neobvyklé, že výrobce
přestane aktualizovat ovladač krátce po ukončení výroby daného zařízení. Pokud
po aktualizaci systému přestane uzavřený ovladač fungovat, stává se tím jinak
funkční zařízení hromadou nepoužitelného šrotu. Takovému hardwaru je dobré se
zdaleka vyhnout a to bez ohledu na operační systém, se kterým chcete zařízení
provozovat.

Pomoci můžete tím, že výrobce uzavřeného hardwaru požádáte o uvolnění nezbytné
dokumentace, podle které můžeme napsat svobodné ovladače pro jejich hardware.

2.4. Instalační média

Tato podkapitola popisuje různé druhy instalačních médií, která můžete použít
pro instalaci Debianu. Výhody a nevýhody jednotlivých médií pak podrobněji
rozebírá kapitola 4 - "Získání instalačních médií".

2.4.1. CD-ROM/DVD-ROM/BD-ROM

Poznámka

Kdykoliv v této příručce uvidíte napsáno "CD-ROM", čtěte to jako "CD-ROM,
DVD-ROM nebo BD-ROM", protože z hlediska operačního systému není mezi těmito
technologiemi žádný rozdíl.

Většina architektur umožňuje instalaci z CD. I v případě, že váš počítač neumí
zavádět systém přímo z CD, můžete CD-ROM využít po počátečním zavedení systému
z jiného média, viz 5 - "Zavedení instalačního systému".

Využít můžete SATA, SCSI a IDE/ATAPI CD-ROM. Podporovány jsou také externí USB
CD-ROM mechaniky a některá FireWire zařízení pracující s ovladači ohci1394 a
sbp2.

2.4.2. USB Memory Stick

USB flash disky (též "klíčenky") se staly běžně používanými a levnými úložišti.
Většina moderních počítačů z nich umí zavádět a obzvláště u netbooků a tenkých
notebooků bez CD mechaniky se předpokládá, že k instalaci operačního systému
použijete právě USB klíčenku.

2.4.3. Síť

Během instalace můžete pro stažení potřebných souborů použít síť (konkrétně
služny HTTP nebo FTP). To, zda se síť použije, závisí na typu instalace, který
si zvolíte, a na vašich odpovědích během instalace. Instalační systém podporuje
většinu typů síťových připojení včetně PPPoE, výjimkou jsou ISDN nebo PPP. Po
instalaci můžete svůj systém nastavit i pro tato připojení.

Instalační systém také můžete zavést ze sítě bez použití dalšího média jako CD/
DVD nebo USB klíčenky.

Příjemnou možností je bezdisková instalace. Systém se zavede z lokální sítě a
všechny lokální souborové systémy se připojí přes NFS.

2.4.4. Pevný disk

Pro mnoho architektur je také zajímavá možnost zavedení instalačního systému z
pevného disku. To však vyžaduje jiný operační systém, pomocí kterého nahrajete
na disk instalační program.

2.4.5. Un*x nebo systém GNU

Pokud používáte jiný unixový systém, můžete jej využít pro instalaci Debianu a
úplně tak obejít debian-installer popisovaný ve zbytku příručky. Tento způsob
instalace je vhodný zejména pro uživatele s podivným hardwarem, který jinak
není podporován instalačními médii, nebo na počítačích, které si nemohou
dovolit prostoje. Jestliže vás zmíněná technika zajímá, přeskočte na D.3 - "Jak
nainstalovat Debian GNU/Linux ze stávajícího unixového/linuxového systému".

2.4.6. Podporovaná datová média

Zaváděcí disky Debianu obsahují jádro s velkým množstvím ovladačů, aby
fungovaly na co nejširší škále počítačů.

Instalační systém Debianu obsahuje podporu pro IDE disky (též známé jako PATA),
SATA a SCSI řadiče a jednotky, USB i FireWire. Systém umí pracovat se
souborovými systémy FAT, FAT s rozšířením Win-32 (VFAT), NTFS a dalšími.

2.5. Požadavky na operační paměť a diskový prostor

K běžné instalaci potřebujete alespoň 400MB operační paměti a 850MB volného
místa na disku. Toto jsou opravdu minimální hodnoty. Reálnější pohled naleznete
v části 3.4 - "Splnění minimálních hardwarových požadavků".

Instalace na systémech s menší pamětí^[2] nebo dostupným místem na disku se
může podařit, ale je doporučena pouze pro zkušené uživatele.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[2] Instalační obrazy podporující grafickou instalaci vyžadují více paměti než
obrazy pouze s textovou instalací a neměly by se používat na systémech s méně
než 400MB paměti. Máte-li možnost výběru mezi grafickou a textovou instalací,
měli byste zvolit tu textovou.

Kapitola 3. Než začnete s instalací

Obsah

3.1. Přehled instalačního procesu
3.2. Zálohujte si svá data!
3.3. Dále budete potřebovat

    3.3.1. Dokumentace
    3.3.2. Hledání zdrojů informací o hardwaru
    3.3.3. Hardwarová kompatibilita
    3.3.4. Nastavení sítě

3.4. Splnění minimálních hardwarových požadavků
3.5. Předrozdělení disku pro více operačních systémů
3.6. Než začnete s instalací ...

    3.6.1. Vyvolání menu systému BIOS
    3.6.2. Výběr zaváděcího zařízení
    3.6.3. Systémy s firmwarem UEFI
    3.6.4. Vypnutí "rychlého spuštění" u Windows 8
    3.6.5. Různé hardwarové problémy

Tato kapitola se zabývá přípravou pro instalaci Debianu ještě před zavedením
instalačního programu. To zahrnuje zazálohování dat, zjištění informací o
hardwaru a další nezbytné kroky.

3.1. Přehled instalačního procesu

Jenom na okraj bychom chtěli poznamenat, že kompletní reinstalace Debianu je
velmi výjimečná událost, kterou má nejčastěji na svědomí mechanická závada
pevného disku.

Na rozdíl od mnoha známých operačních systémů, které musíte při přechodu na
novější verzi instalovat úplně znovu, nebo alespoň přeinstalovat aplikace,
Debian GNU/Linux se umí aktualizovat za běhu. Pokud by nová verze programu
vyžadovala nové verze ostatních balíků, nebo byla nějakým způsobem konfliktní s
jiným programem, balíčkovací systém Debianu se o vše postará. Protože máte k
dispozici mocné aktualizační nástroje, měli byste o kompletní reinstalaci
uvažovat pouze jako o poslední možnosti. Instalační systém není navržen
aktualizaci staršího systému.

Následuje stručný přehled instalačního procesu:

 1. Nejprve si zazálohujete všechna důležitá data (hlavně dokumenty).

 2. Poté posbíráte co nejvíce informací o svém počítači a seženete si potřebnou
    dokumentaci (např. dokumenty odkazované z této příručky).

 3. Stáhnete si soubory instalačního systému, potřebné ovladače a soubory s
    firmwarem.

 4. Připravíte si zaváděcí média jako CD/DVD/USB klíčenky, nebo vytvoříte
    síťovou infrastrukturu pro zavedení instalace ze sítě.

 5. Zavedete instalační systém.

 6. Zvolíte jazyk pro instalaci.

 7. Nastavíte síťové připojení.

 8. Bude-li třeba, vytvoříte místo pro Debian zmenšením stávajících oblastí na
    cílovém pevném disku.

 9. Vytvoříte a připojíte oblasti pro Debian.

10. Můžete pozorovat automatické stažení, instalaci a nastavení základního
    systému.

11. Volitelně můžete nainstalovat další software pomocí předpřipravených úloh.

12. Nainstalujete zavaděč, kterým budete spouštět Debian GNU/Linux (případně i
    původní operační systém).

13. Spustíte svůj nově nainstalovaný systém.

Na architektuře 32-bit PC můžete použít i grafickou verzi instalačního systému.
Více informací naleznete v kapitole 5.1.8 - "Grafický instalátor".

Pokud máte s některým instalačním krokem problémy, je dobré vědět, který balík
je za danou situaci zodpovědný. Nuže, představujeme vám hlavní softwarové role
v tomto instalačním dramatu:

debian-installer (instalační program) je hlavní náplní této příručky.
Rozpoznává hardware a nahrává správné ovladače, rozděluje disky, instaluje
jádro systému a dohlíží na programy dhcp-client, aby nastavil síťové připojení,
debootstrap, aby nainstaloval balíky základního systému a tasksel, aby
doinstaloval dodatečný software. V této fázi instalace hraje své epizodní role
mnohem více herců, ale úloha debian-installeru končí s prvním zavedením nového
systému.

Díky programu tasksel, si můžete jednoduše doinstalovat celé skupiny programů
jako "webový server" nebo "desktopové prostředí" a přizpůsobit si tak systém
svým potřebám.

Pro začínajícího uživatele je jedním z důležitých rozhodnutí během instalace
instalace desktopového grafického prostředí, se skládá ze systému X Window a
jednoho z populárních desktopových prostředí. Pokud desktopové prostředí
nenainstalujete, budete mít k dispozici relativně jednoduchý systém ovládaný z
příkazové řádky. Grafické prostředí je volitelné proto, protože hodně systémů
Debian GNU/Linux slouží jako servery, a ty ke své činnosti grafické rozhraní
nepotřebují.

Vezměte, prosím, na vědomí, že X Window System je od instalačního systému úplně
oddělen a protože je mnohem více komplikovaný, nezabýváme se jím ani v této
příručce.

3.2. Zálohujte si svá data!

Před instalací si vytvořte zálohu všech souborů, které máte na disku, protože
byste o ně při instalaci mohli přijít. Je totiž velmi pravděpodobné, že budete
muset přerozdělit pevný disk, abyste si pro Debian GNU/Linux udělali místo. Při
rozdělování disku byste vždy měli počítat s tím, že můžete ztratit všechna
data. Instalační programy jsou docela spolehlivé a většina z nich je prověřená
lety používání, ale jedna chybná odpověď by se vám mohla zle vymstít. I po
uchování obsahu disků buďte opatrní a promyslete si odpovědi a kroky při
instalaci. Dvě minuty přemýšlení mohou ušetřit hodiny zbytečné práce.

Jestliže budete instalovat Linux na počítač, kde již máte jiný operační systém,
přesvědčete se, že máte po ruce média pro jeho instalaci. Obvykle to není
potřeba, ale zvlášť v případě, kdy byste se chystali přerozdělit systémový
disk, by se vám mohlo stát, že bude nutné znovu nainstalovat zavaděč původního
systému, nebo dokonce celý systém.

3.3. Dále budete potřebovat

3.3.1. Dokumentace

3.3.1.1. Instalační manuál

(Právě čtete.) Manuál je k dispozici ve formátech ASCII, HTML nebo PDF.

  • install.cs.txt

  • install.cs.html

  • install.cs.pdf

3.3.1.2. Domumentace k hardwaru

Obsahuje spousty užitečných informací o konfiguraci resp. provozování různého
hardwaru.

  • Debian Hardware Wiki

3.3.2. Hledání zdrojů informací o hardwaru

V mnoha případech umí instalační program rozpoznat hardware automaticky, ale
podle hesla "vždy připraven" doporučujeme, abyste se před instalací se svým
hardwarem seznámili poněkud důvěrněji.

Informace o hardwaru můžete získat:

  • Z manuálů, které jste získali spolu s příslušným hardwarem.

  • Z BIOSu vašeho počítače. K těmto informacím se dostanete, když během startu
    počítače stisknete určitou kombinaci kláves. Často to bývá klávesa Delete
    nebo F2. Obvykle je tato klávesa zmíněna na obrazovce při startu počítače,
    nebo v příručce k základní desce.

  • Z krabic, ve kterých byly části hardware zabaleny.

  • Z Ovládacích panelů systému Windows.

  • Ze systémových příkazů nebo nástrojů původního operačního systému. Zvláště
    užitečné informace jsou o pevném disku a paměti RAM.

  • Od vašeho správce nebo poskytovatele Internetu. Tyto informace vám mohou
    pomoci při nastavení sítě a elektronické pošty.

Tabulka 3.1. Hardwarové informace užitečné pro instalaci

┌───────────────┬───────────────────────────────────────────────────────────┐
│   Hardware    │                    užitečné informace                     │
├───────────────┼───────────────────────────────────────────────────────────┤
│               │Počet.                                                     │
│               ├───────────────────────────────────────────────────────────┤
│               │Jejich pořadí v systému.                                   │
│               ├───────────────────────────────────────────────────────────┤
│               │Typ IDE (též známé jako PATA), SATA nebo SCSI              │
│Pevné disky    ├───────────────────────────────────────────────────────────┤
│               │Dostupné volné místo.                                      │
│               ├───────────────────────────────────────────────────────────┤
│               │Diskové oddíly.                                            │
│               ├───────────────────────────────────────────────────────────┤
│               │Oddíly, na kterých jsou nainstalovány jiné operační systémy│
├───────────────┼───────────────────────────────────────────────────────────┤
│Síťová rozhraní│Výrobce a model síťových adaptérů.                         │
├───────────────┼───────────────────────────────────────────────────────────┤
│Tiskárna       │Výrobce a model.                                           │
├───────────────┼───────────────────────────────────────────────────────────┤
│Grafická karta │Výrobce a model.                                           │
└───────────────┴───────────────────────────────────────────────────────────┘


3.3.3. Hardwarová kompatibilita

Mnoho výrobků pracuje v operačním systému Linux bez problémů a podpora hardwaru
pro něj se zlepšuje každým dnem. Přes to všechno Linux nepodporuje tolik typů
hardwaru jako některé jiné operační systémy.

Ovladače v jádře Linux většinou nejsou psány pro konkrétní "výrobek" nebo "
značku", ale pro konkrétní čipovou sadu. Mnoho na první pohled odlišných
zařízení/značek bývá založeno na stejném hardwaru, často přímo na tzv.
referenčním návrhu, který poskytuje výrobce čipu a ostatní firmy jej pak
prodávají pod svými vlastními názvy.

To má výhody i nevýhody. Výhodou je, že ovladač pro jednu čipovou sadu funguje
se širokou škálou zařízení od různých výrobců. Nevýhodou je, že často není
jednoduché poznat, který čip je v jakém zařízení použit, protože někteří
výrobci občas změní hardware produktu bez změny názvu zařízení, nebo alespoň
verze. Může se tak stát, že stejný výrobek koupený později, může mít zcela jiný
hardware, pro který je potřeba použít jiný ovladač, nebo pro něj dokonce ani
ovladač existovat nemusí.

Pro USB a PCI/PCI-Express/ExpressCard zařízení se dá zjistit identifikační
číslo zařízení (ID) a podle něj pak dohledat čipovou sadu, na které je výrobek
založen.

V Linuxu můžete tato ID zjistit příkazem lsusb pro USB zařízení, nebo příkazem 
lspci -nn pro zařízení PCI/PCI-Express/ExpressCard. ID obvykle vypadá jako dvě
čísla v šestnáctkové soustavě oddělená dvojtečkou, např. "1d6b:0001", kde "1d6b
" je ID výrobce a "0001" je ID zařízení.

Příklady výstupů obou příkazů:

# lsusb
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub

# lspci -nn
03:00.0 Ethernet controller [0200]: Realtek Semiconductor Co., Ltd. RTL8111/8168B PCI Express Gigabit Ethernet controller [10ec:8168] (rev 06)
04:00.0 VGA compatible controller [0300]: Advanced Micro Devices [AMD] nee ATI RV710 [Radeon HD 4350] [1002:954f]

Na druhém příkladu vidíme dvě zařízení - síťovou kartu od výrobce s ID "10ec" a
grafickou kartu od výrobce s ID "1002".

Na systémech Windows můžete zjistit ID zařízení ve Správce zařízení na záložce 
"Podrobnosti". ID výrobce má předponu "VEN_", ID zařízení pak předponu "DEV_".
U Windows 7 a novějších navíc musíte na záložce Podrobnosti vybrat ze seznamu
vlastnost "Hardwarová ID", jelikož jinak byste ID neviděli.

Vyzbrojeni ID pak můžete vyrazit do hlubin Internetu a pátrat po informacích
ohledně ovladače pro danou čipovou sadu. Nebudete-li úspěšní, můžete zkusit
hledat podle kódových jmen čipů, která jsou taktéž vidět ve výpisu příkazů 
lsusb a lspci. V našem případě to je "RTL8111"/"RTL8168B" pro síťovou kartu a "
RV710" pro kartu grafickou.

3.3.3.1. Testování kompatibility hardware pomocí Live systému

Debian GNU/Linux je též na některých architekturách dostupný ve formě tzv. "
live systému". Jedná se o předpřipravené obrazy systému, které se dají spustit
přímo z USB klíčenky, CD nebo DVD a bez dalšího nastavování okamžitě používat.
Výhodou je, že se v takovém systému ve výchozím nastavení nic nezapisuje na
disk, vše se odehrává jen v operační paměti a po restartu počítače se vše vrátí
do původního stavu. Nejpohodlnější cestou ke zjištění, zda je daný hardware
systémem Debian GNU/Linux podporován, je tedy spustit Debian live a zkusit ho
chvíli používat.

Při používání live systému je třeba mít na paměti několik omezení. Jelikož se
vše odehrává v paměti počítače, je třeba mít dostatek paměti. Dalším omezením
pro testování hardwarové kompatibility může být fakt, že oficiální live obrazy
systému Debian GNU/Linux obsahují pouze svobodné součásti, což znamená, že na
nich nenaleznete například nesvobodný firmware. Ten sice můžete následně
doinstalovat ručně, ale nebude to tak automatické, jako když se
debian-installer sám dotázal po chybějících souborech s firmwarem.

Podrobnější informace o dostupných obrazech Debian live můžete nalézt na
stránce Debian Live.

3.3.4. Nastavení sítě

Pokud bude váš počítač trvale připojen do sítě (myslí se ethernetové a obdobné
připojení, ne PPP), kterou spravuje někdo jiný, zjistěte si od správce sítě
následující informace.

  • Název počítače (možná si počítač pojmenujete sami).

  • Název vaší domény.

  • IP adresu vašeho počítače.

  • Síťovou masku.

  • IP adresu brány tj. počítače spojujícího vaši síť s další sítí (nebo
    Internetem), pokud na vaší síti brána je.

  • IP adresu jmenného serveru, který zprostředkovává převod názvů počítačů na
    IP adresy (DNS).

Pokud daná síť používá pro nastavení parametrů DHCP (Dynamic Host Configuration
Protocol), nemusíte tyto informace zjišťovat, protože DHCP server nastaví váš
počítač automaticky.

Při připojení přes DSL nebo kabelovou televizi obvykle dostanete router, přes
který se připojujete, a na kterém obvykle bývá DHCP zapnuto.

Hodně zjednodušeně: pokud jste ve svém předchozím operačním systému nemuseli
síť nastavovat ručně, nebudete ji muset nastavovat ani v systému Debian GNU/
Linux.

Používáte-li bezdrátové připojení, měli byste navíc zjistit:

  • ESSID (jméno) vaší bezdrátové sítě.

  • Bezpečnostní klíč WEP nebo WPA/WPA2 pro přístup k síti (pokud jej
    používáte).

3.4. Splnění minimálních hardwarových požadavků

Porovnejte seznam svého hardware s následující tabulkou, ve které zjistíte, zda
můžete použít zamýšlený typ instalace.

Skutečné minimální požadavky mohou být nižší než uvádí tabulka, ale většina
uživatelů by asi nebyla spokojena s rychlostí systému. Vždy záleží na
konkrétních požadavcích a možnostech.

Pro pracovní stanice je minimální doporučený procesor Pentium 4 na 1GHz.

Tabulka 3.2. Doporučené minimální požadavky

┌──────────────────────────┬───────────────┬────────────────┬──────────┐
│      Typ instalace       │RAM (minimální)│RAM (doporučená)│Pevný disk│
├──────────────────────────┼───────────────┼────────────────┼──────────┤
│Bez desktopového prostředí│128 MB         │512 MB          │2 GB      │
├──────────────────────────┼───────────────┼────────────────┼──────────┤
│Desktopové prostředí      │256 MB         │1 GB            │10 GB     │
└──────────────────────────┴───────────────┴────────────────┴──────────┘


Konkrétní minimální paměťové požadavky jsou o něco nižší, čísla uváděná v
tabulce. Podle architektury je možné instalovat Debian s pouhými 60MB RAM (na
amd64). Něco podobného platí i pro požadavky na diskový prostor a hodně závisí
na tom, které aplikace si nainstalujete. Více informací naleznete v tabulce D.2
- "Místo potřebné pro úlohy".

I na starších systémech je možné provozovat grafické desktopové prostředí, ale
v takovém případě je doporučeno nainstalovat méně náročné prostředí než KDE
Plasma nebo GNOME. Mezi populární alternativy patří xfce4, icewm a wmaker, ale
na výběr máte i přehršle dalších.

Pro serverové nasazení je téměř nemožné určit paměťové nebo diskové požadavky,
protože ty se liší podle konkrétního nasazení.

Pamatujte, že všechny uvedené velikosti jsou orientační a že neobsahují další
věci, které obvykle v systému bývají (jako třeba pošta, soubory uživatelů,
data). Při přidělování místa pro své vlastní soubory a data je vždy lepší být
velkorysý.

Dále je potřeba dávat pozor na oblast /var, která obsahuje hodně dat závislých
na konkrétní situaci. Například soubory programu dpkg mohou klidně zabrat 40MB,
ani nevíte jak. Dále sem zapisuje třeba apt, který zde odkládá stažené balíky
před samotnou instalací. Pokud přidáme velikost logovacích souborů (většinou v
řádech MB) a ostatní proměnlivá data, měli byste pro /var uvažovat o alokování
minimálně 200MB. Plánujete-li instalaci grafického desktopového prostředí, tak
i mnohem více. Do /var také implicitně ukládají své databáze databázové
systémy.

3.5. Předrozdělení disku pro více operačních systémů

Rozdělením disku se na disku vytvoří několik vzájemně nezávislých oddílů (angl.
partition). Každý oddíl je nezávislý na ostatních. Dá se to přirovnat k bytu
rozčleněnému zdmi -- přidání nábytku do jedné místnosti nemá na ostatní
místnosti žádný vliv.

Jestliže už na počítači máte nějaký operační systém (Windows 9x, Windows NT/
2000/XP/2003/Vista/7, OS/2, MacOS, Solaris, FreeBSD, ...) a chcete na stejný
disk ještě umístit Debian, patrně se nevyhnete přerozdělení disku. Debian pro
sebe potřebuje vlastní diskové oblasti a nemůže být nainstalován na oblasti
systému Windows nebo třeba MacOS X. Je sice možné sdílet některé oblasti s
jinými systémy, ale popis je mimo rozsah tohoto dokumentu. Minimálně budete
potřebovat jednu oblast pro kořenový souborový systém.

Informace o aktuálním rozdělení disku můžete získat dělicím programem svého
stávajícího operačního systému, jako je Správa disků ve Windows nebo fdisk v
DOSu . Každý dělicí nástroj umožňuje prohlížet oblasti bez jejich modifikace.

Obecně změna oddílu, na kterém je souborový systém, znamená ztrátu dat, takže
si raději disk před změnami do tabulky diskových oddílů zazálohujte. Podle
analogie s bytem a zdmi, z bytu také raději vynesete veškerý nábytek, než
budete přestavovat zdi.

Přestože některé moderní operační systémy zvládají přesun a změnu velikosti
některých oddílů bez zničení obsahu, takže by se dalo vytvořit místo pro Debian
beze ztráty dat, jedná se o inherentně nebezpečnou operaci a proto byste to
měli spáchat až po kompletní záloze všech dat. Oblasti typu FAT/FAT32 a NTFS se
dají bezeztrátově upravovat například ze Správy disků ve Windows 7, nebo během
instalace přímo z debian-installeru (viz 6.3.3 - "Rozdělení disku a výběr
přípojných bodů").

Varování

Pokud startujete instalační systém z pevného disku a potom tento disk
rozdělíte, smažete si zaváděcí soubory a musíte doufat, že se instalace povede
napoprvé. (Minimálně v tomto případě je dobré mít u sebe nástroje pro oživení
počítače, jako jsou zaváděcí diskety nebo CD s původním systémem a podobně.)

I když s diskovými oblastmi mohou manipulovat jak debian-installer, tak
nástroje ve stávajícím operačním systému, vždy bývá nejlepší, když si své
oblasti vytváří vždy ten systém, který je bude používat, protože sám nejlépe
ví, co mu chutná. To znamená, že oblasti pro Debian GNU/Linux byste měli
vytvořit v debian-installer.

Jestliže budete mít na počítači více operačních systémů, měli byste tyto
systémy instalovat před Debianem. Instalační programy Windows a jiných systémů
by mohly zabránit startu Debianu nebo vás navést k přeformátování některých
důležitých oblastí.

Tyto problémy můžete úspěšně vyřešit, případně se jim úplně vyhnout, ale
nejjistější je instalovat Debian jako poslední systém.

3.6. Než začnete s instalací ...

Tato část vás provede nastavením hardwaru, který je občas potřeba před vlastní
instalací mírně připravit. Obecně se tím myslí kontrola a případná změna
nastavení BIOSu/systémového firmware. "BIOS" nebo "systémový firmware" je
nejnižší úroveň softwaru, který je využíván zařízeními v počítači, a
rozhodujícím způsobem ovlivňuje start počítače po jeho zapnutí.

3.6.1. Vyvolání menu systému BIOS

BIOS zabezpečuje základní funkce nutné pro zavedení operačního systému. Váš
počítač patrně umožňuje vyvolání menu, ze kterého lze BIOS nastavit. Vstup do
BIOSu se liší od výrobce k výrobci, ale často to bývá klávesou Delete nebo F2
po zapnutí počítače.

3.6.2. Výběr zaváděcího zařízení

V systémech BIOS si obvykle můžete vybrat pořadí médií, na kterých se bude
hledat zaveditelný operační systém. V seznamu obvykle naleznete interní pevné
disky, CD/DVD mechaniky a bloková USB zařízení jako USB klíčenky nebo externí
USB disky. Často také nechybí zavádění ze sítě pomocí PXE.

Dle zvolené instalační metody nastavte pořadí zařízení tak, aby se jako první
spustil instalační systém.

Často můžete použít zkratku a příslušné zaváděcí zařízení vybrat hned po
zapnutí počítače bez vstupování do BIOSu. Výhodou je, že na rozdíl od nastavení
v BIOSu, platí tato změna pouze pro tento jeden start počítače. Nevýhoda je pak
ta, že se klávesa pro vyvolání této nabídky liší mezi systémy ještě více, než
samotný vstup do BIOSu. Správnou klávesu vám prozradí návod k základní desce,
obvykle to bývá klávesa F12, F11 nebo F8.

Některé počítače mají bohužel chybové verze BIOSu a zavedení instalačního
systému z USB klíčenky nemusí fungovat, i když jste vše nastavili správně.
Někdy se dají počítače ošálit tím, že v BIOSu místo "USB harddisk" nebo "USB
stick" vyberete typ zařízení "USB ZIP" nebo "USB CDROM". Změna na "USB CDROM"
pomáhá obzvláště v případech, kdy na USB klíčence používáte CD/DVD obraz typu
isohybrid (viz 4.3.1 - "Příprava USB klíčenky s hybridním CD/DVD obrazem").

Jestliže se vám nepodaří přemluvit BIOS, aby zavedl instalaci přímo z USB,
můžete zkusit zavést instalaci z pevného disku (dle kapitoly 4.4 - "Příprava
souborů pro zavedení z pevného disku") a v kroku, kdy bude instalační systém
hledat na pevném disku obraz instalačního CD, ho nasměrovat na USB zařízení, na
kterém bude tento obraz ležet.

3.6.3. Systémy s firmwarem UEFI

UEFI ("Unified Extensible Firmware Interface") je nový typ systémového
firmwaru, který se používá na mnoha moderních systémech a, mimo jiné, by měl v
počítačích nahradit klasický BIOS.

Většina počítačů s UEFI zatím ve firmwaru používá CSM ("Compatibility Support
Module"), který operačnímu systému poskytuje stejná rozhraní, jako poskytoval
tradiční BIOS, tudíž je zatím možno používat software napsaný přímo pro BIOS
beze změn. To však jednou skončí, protože UEFI nebude tuto kompatibilní vrstvu
podporovat navždy. Již nyní existuje mnoho systémů s UEFI bez CSM.

Při instalaci operačního systému na počítačích s UEFI je potřeba vzít v úvahu
několik věcí, protože systém zavádění se mezi BIOSem (resp. UEFI v režimu CSM)
a nativním UEFI zásadně liší. Jednou významnou změnou je způsob dělení pevného
disku na oblasti. Tradiční BIOS a UEFI v režimu CSM používají DOSovou tabulku
oddílů, nativní UEFI používá systém GPT ("GUID Partition Table"). Na jednom
disku může být použita pouze jedna z nich, a v případě, že používáte více
operačních systémů na jednom disku, znamená to, že všechny systémy musí
podporovat zvolený typ rozdělení disku. Zavádění z disku s GPT je možné pouze v
nativním režimu UEFI, což se může zdát jako nevýhoda, ale s tím, jak rostou
velikosti disků, se používání GPT rozšiřuje, jelikož tradiční DOSová tabulka
oddílů neumí adresovat disky větší než 2 TB.

Dalším zásadním rozdílem mezi BIOSem (resp. UEFI v režimu CSM) a nativním UEFI
je v tom, odkud se načítá zavaděč a jaký používá formát, což znamená, že se v
obou případech jedná o různé zavaděče. To je důležité pro debian-installer na
systémech s UEFI v režimu CSM, jelikož debian-installer si zjistí, zda byl
spuštěn na počítači s BIOSem nebo na počítači s nativním UEFI a podle toho
nainstaluje příslušný zavaděč. To obvykle funguje k plné spokojenosti, ale
přesto může nastat problém na systémech, které mají více možností zavádění. Na
některých UEFI systémech v režimu CSM se totiž způsob zavádění může lišit mezi
zaváděním z pevného disku a zaváděním z výměnných médií. To může způsobit, že
instalační systém zavedený z USB klíčenky používá jiný režim, než systém
nainstalovaný na pevném disku, čímž dojde k instalaci špatného zavaděče a po
dokončení instalace se pak systém nemusí spustit. Některé systémy nabízí při
volbě zaváděcího zařízení dvě samostatné položky pro každé zařízení, takže si
uživatel může vybrat, zda se má zavádění provést v kompatibilním režimu CSM,
nebo v nativním UEFI.

Dalším tématem spojeným s UEFI je takzvaný "secure boot". Secure boot je
mechanismus některých UEFI implementací, které umí uzamknout zavádění a
umožňují pak spouštět pouze kód, který byl kryptograficky podepsán určitými
klíči a tím pádem blokovat (potenciálně škodlivý) software, který není
podepsaný, nebo je podepsaný neznámými klíči. V praxi to znamená, že na většině
UEFI systémů se secure bootem je akceptován pouze klíč od Microsoftu, kterým je
podepsán zavaděč Windows. Jelikož zavaděč používaný debian-installerem není
podepsaný Microsoftem, je nutno před zavedením instalace secure boot vypnout.
Často se to týká počítačů, na kterých je předinstalovaná 64 bitová verze
Windows 8. Bohužel neexistuje unifikovaný postup, kterým by se dal secure boot
vypnout. Na některých systémech se tato možnost objeví až po té, co uživatel
nastaví heslo do BIOSu. Pokud je tedy secure boot zapnutý a nikde nevidíte
možnost jeho vypnutí, zkuste nastavit heslo do BIOSu, restartovat počítač a
podívat se znovu, zda se možnost neobjevila.

3.6.4. Vypnutí "rychlého spuštění" u Windows 8

Windows 8 nabízí možnost nazvanou rychlé spuštění, které zkracuje dobu k
nastartování Windows. Je-li tato možnost povolena, Windows se při vypínání
nevypnou zcela, ale provedou něco, jako částečné uspání, aby tím urychlily
následný start. To samo o sobě ničemu nevadí, ale pokud máte na počítači i jiný
operační systém, který může přistupovat ke stejným oblastem, jako Windows, může
dojít k porušení a ztrátě dat, jelikož se může skutečný stav souborového
systému lišit od toho, jak si jej Windows pamatují a zápisy na takový souborový
systém mohou vést k jeho porušení. V případě zavádění různých operačních
systémů je tedy vhodné "rychlé spuštění" ve Windows vypnout, aby k porušení
souborového systému nedocházelo.

"Rychlé spuštění" je někdy potřeba vypnout už jen proto, abyste se dostali do
nastavení UEFI, kde si můžete zvolit, že chcete zavést jiný operační systém,
nebo debian-installer. Některé UEFI systémy totiž zkracují čas zavedení tím, že
neinicializují řadič klávesnice nebo USB zařízení a klávesnice pak při zavádění
nereaguje. V takovém případě je nezbytné nastartovat Windows a "rychlé spuštění
" vypnout.

3.6.5. Různé hardwarové problémy

BIOS a USB klávesnice.  Pokud nemáte k dispozici standardní PS/2 klávesnici,
ale pouze USB model, je možné, že budete muset v BIOSu nastavit emulaci
klasické klávesnice. Hledejte položky jako "Legacy keyboard emulation" nebo "
USB keyboard support". Toto nastavení změňte pouze v případě, že instalační
program klávesnici nerozpozná.

Kapitola 4. Získání instalačních médií

Obsah

4.1. Oficiální sada CD/DVD-ROM
4.2. Stažení souborů ze zrcadel Debianu

    4.2.1. Kde se nalézají instalační obrazy?

4.3. Příprava souborů pro zavedení z USB zařízení

    4.3.1. Příprava USB klíčenky s hybridním CD/DVD obrazem
    4.3.2. Ruční kopírování souborů
    4.3.3. Ruční kopírování souborů -- pružná cesta

4.4. Příprava souborů pro zavedení z pevného disku

    4.4.1. Zavedení instalačního systému programem LILO nebo GRUB
    4.4.2. Zavedení instalačního systému programem loadlin

4.5. Příprava souborů pro zavedení ze sítě pomocí TFTP

    4.5.1. Nastavení DHCP serveru
    4.5.2. Nastavení BOOTP serveru
    4.5.3. Povolení TFTP serveru
    4.5.4. Přesun TFTP obrazů na místo

4.6. Automatická Instalace

    4.6.1. debian-installer

4.1. Oficiální sada CD/DVD-ROM

Nejsnazší cesta k instalaci Debianu vede přes oficiální sadu CD/DVD s Debianem
(viz seznam dodavatelů). Pokud máte rychlé připojení k síti a vypalovací
mechaniku, můžete si stáhnout obrazy CD/DVD z debianího zrcadla a vyrobit si
vlastní sadu. (Postup naleznete na webové stránce debianích CD.) Jestliže již
CD máte a váš počítač z nich umí zavést systém, můžete přeskočit rovnou na 5 -
"Zavedení instalačního systému". Přestože Debian zabírá mnoho CD, je
nepravděpodobné, že byste potřebovali všechny disky, protože balíky jsou na
nich seřazeny podle oblíbenosti, takže většinu programů nainstalujete z prvního
CD. Také můžete použít DVD verzi, která vám ušetří místo na poličce a navíc se
vyhnete diskžokejské práci s hromadou CD.

Poznámka

Poznamenejme, že obě hlavní desktopová prostředí GNOME a KDE jsou tak rozsáhlá,
že se nevejdou na jediné CD a proto při instalaci počítejte s tím, že budete
muset použít více CD, nebo nechat stáhnout zbývající balíky ze sítě.

Pokud sice CD máte, ale váš počítač nepodporuje zavádění z CD-ROM, můžete
zahájit instalaci zavedením instalačního systému z pevného disku, usb klíčenky,
ze sítě, nebo ručním zavedením jádra z CD. Soubory, které potřebujete k
zavedení instalačního systému alternativními cestami, se rovněž nachází na CD.
Organizace adresářů na CD je shodná se strukturou debianího archívu na
Internetu, takže cesty k souborům uváděné dále v dokumentu můžete jednoduše
vyhledat jak na CD, tak i na síti.

Po zavedení instalačního systému do paměti se již budou všechny potřebné
soubory kopírovat z CD.

Pokud sadu CD nemáte, budete si muset stáhnout soubory instalačního sytému a
nakopírovat je na usb klíčenku nebo na pevný disk nebo na připojený počítač
tak, aby se z nich mohl zavést instalační systém.

4.2. Stažení souborů ze zrcadel Debianu

Nejbližší (a tedy pravděpodobně nejrychlejší) zrcadlo naleznete v seznamu
zrcadel Debianu.

Budete-li stahovat soubory z debianího zrcadla pomocí FTP, použijte binární
mód, ne textový nebo automatický.

4.2.1. Kde se nalézají instalační obrazy?

Instalační obrazy jsou umístěny na každém zrcadle Debianu v adresáři debian/
dists/buster/main/installer-i386/current/images/. Význam jednotlivých obrazů
popisuje soubor MANIFEST.

4.3. Příprava souborů pro zavedení z USB zařízení

Pro přípravu USB zařízení budete potřebovat počítač s nainstalovaným GNU/
Linuxem a podporou USB. Dnešní systémy GNU/Linuxu by měly USB klíčenku
rozpoznat automaticky. Pokud tomu tak není, ověřte, zda je nahraný jaderný
modul usb-storage. Po zasunutí USB klíčenky ji systém naváže na zařízení /dev/
sdX, kde X je písmeno z rozsahu a-z. Přesný název zařízení zjistíte z příkazu 
dmesg, kde by měl být o zasunutí a rozpoznání USB zařízení záznam. Pokud
klíčenka obsahuje ochranu proti zápisu, vypněte ji.

Varování

Postupem popsaným dále v kapitole si smažete všechna data, která se na zařízení
nachází! Před spuštěním příkazů se raději několikrát ujistěte, že jste zařízení
zadali správně, protože i drobný překlep může způsobit, že si smažete data na
pevném disku.

4.3.1. Příprava USB klíčenky s hybridním CD/DVD obrazem

Obrazy debianích CD/DVD mohou být zapsány přímo na USB klíčenku, což je
nejjednodušší způsob vytvoření zaváděcího USB zařízení. Stačí si podle 4.1 -
"Oficiální sada CD/DVD-ROM" stáhnout některý z obrazů, který se vejde na vaši
USB klíčenku.

Jestliže máte opravdu malou klíčenku v řádu megabajtů, můžete z adresáře
netboot stáhnout obraz mini.iso (viz kapitola 4.2.1 - "Kde se nalézají
instalační obrazy?"), nicméně tato varianta zavede pouze minimální instalační
systém a zbytek stahuje ze sítě.

Zvolený obraz CD/DVD byste měli zapsat přímo na USB klíčenku, čímž přepíšete
všechna data, která na ní byla. Například na systému s GNU/Linuxem můžete obraz
CD/DVD zapsat na USB klíčenku následovně (ujistěte se, že žádný souborový
systém z klíčenky není připojený):

# cp debian.iso /dev/sdX
# sync

Na systémech s Windows můžete pro zápis obrazu použít nástroj win32diskimager.

Důležité

Obraz je nutno zapsat na celé zařízení, ne jen do případné oblasti, tj.
například do /dev/sdb a ne /dev/sdb1. Také nepoužívejte nástroje jako 
unetbootin, které zapisovaný obraz mění.

Důležité

Vytvoření instalační USB klíčenky tímto způsobem by mělo fungovat většině
uživatelů. Ostatní možnosti popsané níže slouží spíše lidem se speciálními
požadavky.

Hybridní obraz na USB klíčence obvykle nezabírá veškerý prostor, což přímo
vybízí použití volného místa pro uložení potřebných souborů s firmwarem,
speciálních balíků, nebo jiných souborů. Veškeré soubory jsou pak pěkně
pohromadě na jednom médiu.

Stačí na USB klíčence vytvořit druhou oblast typu FAT, připojit ji a
nakopírovat nebo rozbalit do ní příslušné soubory s firmwarem (viz 6.4 -
"Nahrání chybějícího firmwaru"). Například takto:

# mount /dev/sdX2 /mnt
# cd /mnt
# tar zxvf /cesta/k/firmware.tar.gz
# cd /
# umount /mnt

Jestliže jste na USB klíčenku nakopírovali obraz mini.iso, nemusíte druhou
oblast vytvářet, protože už je tam předchystaná. Po odpojení a novém zasunutí
USB klíčenky by se měly objevit obě dvě oblasti.

4.3.2. Ruční kopírování souborů

Jiný způsob vytvoření instalační USB klíčenky je ruční nakopírování
instalačního systému a obrazu malého instalačního CD. USB klíčenka by měla mít
velikost alespoň 1 GB. Menší velikosti jsou podporovány pouze při ruční výrobě
podle 4.3.3 - "Ruční kopírování souborů -- pružná cesta".

K dispozici máte soubor hd-media/boot.img.gz, který obsahuje všechny instalační
soubory (včetně jádra), zavaděč syslinux a jeho konfigurační soubor.

I když je tento způsob vytvoření zaváděcího USB média pohodlný, má jednu
zásadní nevýhodu: logická velikost zařízení bude vždy omezena na 1 GB, i když
je skutečná kapacita USB klíčenky mnohonásobně větší. Budete-li ji chtít někdy
v budoucnu použít k jinému účelu a budete-li vyžadovat její celou kapacitu,
budete ji muset přerozdělit a znovu vytvořit souborový systém.

Jediné co musíte se staženým boot.img.gz udělat, je rozbalit ho na USB
zařízení:

# gzip -dc boot.img.gz >/dev/sdX

Na klíčence nyní bude jedna velká oblast typu FAT16. Připojte ji (mount /dev/
sdX /mnt) a nakopírujte na ni ISO obraz instalačního CD. Nyní stačí klíčenku
odpojit (umount /mnt) a je hotovo.

4.3.3. Ruční kopírování souborů -- pružná cesta

Pokud máte rádi více pružnosti, nebo jen chcete zjistit "co se děje za oponou",
můžete použít následující metodu, ve které mj. ukážeme, jak místo celého USB
zařízení použít pouze první oblast.

4.3.3.1. Rozdělení USB zařízení

Poznámka

Protože má většina USB klíčenek přednastavenou jednu velkou oblast typu FAT16,
pravděpodobně nemusíte klíčenku přeformátovávat. Pokud to však musíte provést,
použijte pro vytvoření této oblasti cfdisk nebo podobný nástroj pro dělení
disku^[3], nainstalujte MBR příkazem

# install-mbr /dev/sdX

z balíku mbr a vytvořte souborový systém

# mkdosfs /dev/sdX1

Příkaz mkdosfs je obsažen v balíku dosfstools. Pozorně se přesvědčete, že
používáte správný název zařízení!

Pro zavedení jádra z klíčenky je zapotřebí zavaděče. Přestože byste mohli
použít téměř libovolný zavaděč (např. lilo), je zvykem používat syslinux,
protože používá oblast typu FAT16 a jeho nastavení se provádí úpravou
jednoduchého textového souboru. Díky tomu můžete zavaděč konfigurovat z téměř
libovolného operačního systému.

Pro instalaci syslinuxu na 1. oblast USB klíčenky musíte mít nainstalované
balíky syslinux a mtools a daná oblast nesmí být připojená. Poté zadejte příkaz

# syslinux /dev/sdX1

čímž se na začátek oblasti zapíše zaváděcí sektor a vytvoří se soubor
ldlinux.sys, který obsahuje hlavní část zavaděče.

4.3.3.2. Přidání obrazu instalačního systému

Připojte oblast (mount /dev/sdX1 /mnt) a nakopírujte na ni následující soubory:

  • vmlinuz nebo linux (jádro)

  • initrd.gz (obraz ramdisku)

Chcete-li použít grafickou verzi instalátoru, použijte soubory z podadresáře
gtk. Pokud si chcete soubory přejmenovat, pamatujte, že syslinux umí pracovat
pouze s DOSovými názvy souborů (8.3).

Dále si vytvořte konfigurační soubor syslinux.cfg, který by měl obsahovat
alespoň následující řádek (pokud jste použili obraz netboot, změňte jméno
souboru s jádrem na "linux"):

default vmlinuz initrd=initrd.gz

Pro grafickou instalaci byste na řádek měli přidat ještě parametr vga=788 a
případné další parametry.

Chcete-li povolit interaktivní přidávání parametrů při zavádění instalačního
systému, přidejte ještě řádek:

prompt 1

Pokud jste použili obraz hd-media, měli byste nyní na klíčenku nakopírovat ISO
obraz s instalací Debianu (jako běžný soubor)^[4] a následně USB klíčenku
odpojit (umount /mnt).

4.4. Příprava souborů pro zavedení z pevného disku

Instalační systém můžete zavést ze zaváděcích souborů umístěných na stávající
oblasti pevného disku buď přímo BIOSem, nebo z původního operačního systému.

Můžete tak dosáhnout "čistě síťové" instalace a vyhnout se vzrušující loterii
při použití spousty nespolehlivých disket, potažmo neskladných CD.

4.4.1. Zavedení instalačního systému programem LILO nebo GRUB

Tato část vysvětluje, jak zavést instalaci z existující linuxové distribuce za
pomoci programu LILO, resp. GRUB.

Oba zavaděče totiž kromě jádra umí zavést do paměti také obraz disku. Ten pak
můžete použít jako kořenový souborový systém.

Z archivu Debianu si stáhněte následující soubory a přesuňte je na vhodné místo
(například do /boot/newinstall/). Pozor na to, že LILO neumí zavést soubory
ležící na souborovém systému NTFS.

  • vmlinuz (vhodné jádro)

  • initrd.gz (obraz ramdisku)

Nastavení zavaděče popisuje 5.1.5 - "Zavedení z Linuxu programem LILO nebo GRUB
".

4.4.2. Zavedení instalačního systému programem loadlin

Tato část vysvětluje, jak zavést instalaci z DOSu za pomoci programu loadlin.

Z instalačního CD Debianu zkopírujte do c:\ následující adresáře:

  • /install.386 (jádro a obraz ramdisku)

  • /tools (nástroj loadlin)

4.5. Příprava souborů pro zavedení ze sítě pomocí TFTP

Pokud je váš počítač připojen do lokální sítě, můžete jej zavést ze sítě pomocí
TFTP. Jestliže chcete pomocí TFTP zavést instalační systém, musíte na vzdáleném
počítači nakopírovat zaváděcí soubory do specifických adresářů a povolit
zavádění vaší stanice.

Musíte nastavit TFTP server a často i DHCP server nebo BOOTP server.

BOOTP je IP protokol, který informuje počítač o jeho IP adrese a prozradí mu,
odkud si má stáhnout zaváděcí obraz. DHCP (Dynamic Host Configuration Protocol)
je flexibilnější, zpětně kompatibilní rozšíření protokolu BOOTP. Některé
systémy mohou být nastaveny pouze pomocí DHCP.

Pro přenos zaváděcího obrazu ke klientovi se používá protokol TFTP (Trivial
File Transfer Protocol). Teoreticky můžete použít server na libovolné
platformě, která jej implementuje. Ukázky v této kapitole se vztahují k
operačním systémům SunOS 4.x, SunOS 5.x (neboli Solaris) a GNU/Linux.

Poznámka

Pokud na serveru běží Debian, doporučujeme použít TFTP server tftp-hpa od
stejného autora jako zavaděč syslinux, protože by mezi nimi mělo nastat nejméně
problémů. Vhodnou alternativou je i atftpd.

4.5.1. Nastavení DHCP serveru

Jedním ze svobodných DHCP serverů je ISC dhcpd. Debian GNU/Linux jej obsahuje
jako balík isc-dhcp-server. Následuje ukázka jednoduchého konfiguračního
souboru (obvykle /etc/dhcp/dhcpd.conf):

option domain-name "priklad.cz";
option domain-name-servers ns1.priklad.cz;
option subnet-mask 255.255.255.0;
default-lease-time 600;
max-lease-time 7200;
server-name "karel";

subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.200 192.168.1.253;
  option routers 192.168.1.1;
}

host clientname {
  filename "/tftpboot.img";
  server-name "karel";
  next-server dalsiserver.priklad.cz;
  hardware ethernet 01:23:45:67:89:AB;
  fixed-address 192.168.1.90;
}

V tomto příkladu máme jeden server jménem karel, který obstarává práci DHCP a
TFTP serveru a také slouží jako brána do sítě. Ve svém nastavení si musíte
změnit alespoň doménové jméno, jméno serveru a hardwarovou adresu klienta.
Položka filename by měla obsahovat název souboru, který si klient stáhne přes
TFTP.

Po úpravách konfiguračního souboru musíte restartovat dhcpd příkazem /etc/
init.d/isc-dhcp-server restart.

4.5.1.1. Povolení PXE zavádění

Další příklad souboru dhcp.conf tentokrát využívá metodu PXE (Pre-boot
Execution Environment) protokolu TFTP.

option domain-name "priklad.cz";

default-lease-time 600;
max-lease-time 7200;

allow booting;
allow bootp;

# Následující odstavec si musíte upravit dle skutečnosti
subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.200 192.168.1.253;
  option broadcast-address 192.168.1.255;
# adresa brány
# (například pro přístup k internetu)
  option routers 192.168.1.1;
# dns server, který chcete použít
  option domain-name-servers 192.168.1.3;
}

group {
  next-server 192.168.1.3;
  host tftpclient {
    # hardwarová adresa tftp klienta
    hardware ethernet  00:10:DC:27:6C:15;
    filename "pxelinux.0";
  }
}

Při PXE zavádění není soubor pxelinux.0 obraz jádra, ale zavaděč (viz 4.5.4 -
"Přesun TFTP obrazů na místo" dále v textu).

4.5.2. Nastavení BOOTP serveru

V GNU/Linuxu můžete použít v zásadě dva BOOTP servery. Jednak je to CMU bootpd
a druhý je vlastně DHCP server -- ISC dhcpd. V distribuci Debian GNU/Linux jsou
k dispozici v balících bootp a isc-dhcp-server.

Pokud chcete použít CMU bootpd, musíte nejprve odkomentovat (nebo přidat) jeden
důležitý řádek v souboru /etc/inetd.conf. V systému Debian GNU/Linux můžete
spustit update-inetd --enable bootps a následně restartovat inetd pomocí /etc/
init.d/inetd reload. V jiných systémech přidejte řádku, která bude vypadat
zhruba takto:

bootps  dgram  udp  wait  root  /usr/sbin/bootpd  bootpd -i -t 120

Nyní musíte vytvořit soubor /etc/bootptab. Jeho struktura je velmi podobná té,
co používají staré dobré soubory printcap, termcap a disktab ze systému BSD.
Bližší informace jsou v manuálové stránce bootptab. Pokud používáte CMU bootpd,
musíte rovněž znát hardwarovou (MAC) adresu klienta. Následuje příklad souboru
/etc/bootptab:

client:\
  hd=/tftpboot:\
  bf=tftpboot.img:\
  ip=192.168.1.90:\
  sm=255.255.255.0:\
  sa=192.168.1.1:\
  ha=0123456789AB:

Z příkladu budete muset změnit minimálně volbu "ha", která značí hardwarovou
adresu klienta. Volba "bf" specifikuje soubor, který si klient stáhne
protokolem TFTP, viz 4.5.4 - "Přesun TFTP obrazů na místo".

V kontrastu s předchozím je nastaveni BOOTP pomocí ISC dhcpd velmi jednoduché,
protože dhcpd považuje BOOTP klienty za speciální případ DHCP klientů. Některé
architektury však vyžadují pro zavádění klientů pomocí BOOTP komplikované
nastavení. Je-li to váš případ, přečtěte si 4.5.1 - "Nastavení DHCP serveru". V
opačném případě stačí v konfiguračním souboru /etc/dhcp/dhcpd.conf vložit do
bloku podsítě, ve které se nachází klient, direktivu allow bootp. Potom
restartujte dhcpd server příkazem /etc/init.d/isc-dhcp-server restart.

4.5.3. Povolení TFTP serveru

Aby vám TFTP server fungoval, měli byste nejprve zkontrolovat, zda je tftpd
povolen.

V případě balíku tftpd-hpa existují dva způsoby, jak službu provozovat. Jednak
se může tftpd-hpa spouštět jako samostatný daemon při startu systému, nebo může
jeho spuštění zajišťovat systémový daemon inetd v okamžik, kdy je ho potřeba.
Způsob, který zrovna používáte, můžete zvolit při instalaci balíku, respektive
ho můžete kdykoliv změnit rekonfigurací balíku.

Poznámka

TFTP servery historicky používaly pro uložení nabízených obrazů adresář /
tftpboot. Aby byl Debian v souladu se standardem FHS, mohou debianí balíky
používat jiná umístění. Například tftpd-hpa implicitně používá adresář /srv/
tftp. Je proto možné, že budete muset cesty uváděné v této kapitole upravit pro
konkrétní situaci.

Všechny alternativní in.tftpd v Debianu by měly automaticky zaznamenávat
všechny požadavky, které jim byly zaslány, do systémových logů. To se hodí
zejména v situaci, kdy zavádění neprobíhá tak, jak má. Některé TFTP servery umí
zvýšit svou upovídanost parametrem -v.

4.5.4. Přesun TFTP obrazů na místo

Dále je potřeba umístit příslušný TFTP obraz (viz 4.2.1 - "Kde se nalézají
instalační obrazy?") do adresáře, kde má tftpd uloženy obrazy. Bohužel TFTP
klient očekává jméno souboru v určitém tvaru, pro který neexistují žádné
závazné standardy. Proto ještě musíte na příslušný obraz vytvořit odkaz, který 
tftpd použije pro zavedení konkrétního klienta.

Pro PXE zavádění by mělo být vše potřebné v souboru netboot/netboot.tar.gz.
Tento archiv stačí rozbalit do adresáře, kde tftpd uchovává zaváděcí obrazy.
Ujistěte se, že je váš dhcp server nastaven tak, aby jako jméno souboru pro
zavedení zasílal pxelinux.0.

4.6. Automatická Instalace

Pokud spravujete více obdobných počítačů, můžete využít plně automatickou
instalaci. Příslušné balíky se jmenují fai-quickstart a samozřejmě
debian-installer Více informací o FAI naleznete na domovské stránce FAI.

4.6.1. debian-installer

Instalační program Debianu podporuje automatické instalace pomocí
předkonfiguračních souborů. Předkonfigurační soubor obsahuje odpovědi na
otázky, které se debian-installer ptá během instalace. Tento soubor můžete
nahrát ze sítě nebo z vyměnitelného média.

Kompletní dokumentaci o přednastavení včetně funkčního příkladu naleznete v B -
"Automatizování instalací pomocí přednastavení".


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[3] Nezapomeňte oblasti nastavit "zaváděcí" příznak.

^[4] Použít můžete obrazy typu netinst, nebo, pokud se vejde, klidně celé první
CD/DVD (viz část 4.1 - "Oficiální sada CD/DVD-ROM"). Poznamenejme, že netboot
obraz mini.iso není pro tento účel vhodný.

Kapitola 5. Zavedení instalačního systému

Obsah

5.1. Zavedení instalátoru na 32-bit PC

    5.1.1. Zavedení z USB "klíčenky"
    5.1.2. Zavedení z CD-ROM
    5.1.3. Zavedení z Windows
    5.1.4. Zavedení z DOSu pomocí loadlin
    5.1.5. Zavedení z Linuxu programem LILO nebo GRUB
    5.1.6. Zavedení z TFTP
    5.1.7. Zaváděcí obrazovka
    5.1.8. Grafický instalátor

5.2. Zpřístupnění

    5.2.1. Uživatelské rozhraní instalačního systému
    5.2.2. Braillův řádek připojený na USB
    5.2.3. Braillův řádek připojený na sériový port
    5.2.4. Softwarová syntéza hlasu
    5.2.5. Hardwarová syntéza hlasu
    5.2.6. Zařízení připojená rovnou na sběrnici
    5.2.7. Kontrastní téma
    5.2.8. Změna velikosti písma
    5.2.9. Záchranný režim, expertní a automatizované instalace
    5.2.10. Zpřístupnění v nainstalovaném systému

5.3. Zaváděcí parametry

    5.3.1. Zavěděcí konzole
    5.3.2. Parametry instalačního programu
    5.3.3. Použití zaváděcích parametrů pro zodpovězení otázek
    5.3.4. Předávání parametrů jaderným modulům
    5.3.5. Zapsání jaderných modulů na černou listinu

5.4. Problémy s instalačním systémem

    5.4.1. Spolehlivost CD
    5.4.2. Zaváděcí konfigurace
    5.4.3. Softwarová syntéza hlasu
    5.4.4. Běžné instalační problémy na 32-bit PC
    5.4.5. Význam hlášek při zavádění jádra
    5.4.6. Hlášení problémů s instalací
    5.4.7. Pošlete nám zprávu o instalaci

5.1. Zavedení instalátoru na 32-bit PC

Varování

Máte-li na svém počítači jiné operační systémy, které chcete zachovat (tzv.
duální zavádění), měli byste se před zavedením instalačního systému ujistit, že
jsou tyto operační systémy skutečně vypnuté a ne jen uspané. Instalace nového
operačního systému může narušit stav uspaného operačního systému (což může po
jeho probuzení vést k nestabilitě systému nebo i ztrátě dat).

Poznámka

Informace o zavedení grafického instalátoru naleznete v kapitole 5.1.8 -
"Grafický instalátor".

5.1.1. Zavedení z USB "klíčenky"

Předpokládejme, že jste si připravili vše nezbytné z 3.6.2 - "Výběr zaváděcího
zařízení" a 4.3 - "Příprava souborů pro zavedení z USB zařízení". Nyní
jednoduše zapojte klíčenku do volného USB portu a restartujte počítač. Systém
by měl nastartovat a měl by zobrazit úvodní obrazovku s grafickou nabídkou^[5].
Zde si můžete vybrat z různých možností instalačního systému, nebo prostě
zmáčknout Enter.

5.1.2. Zavedení z CD-ROM

Pokud máte sadu instalačních CD Debianu a váš počítač podporuje zavádění z CD, 
nastavte podle 3.6.2 - "Výběr zaváděcího zařízení" zavádění z CD, vložte CD do
mechaniky, restartujte počítač a přejděte k další kapitole.

Některé CD mechaniky mohou vyžadovat použití speciálních ovladačů a tím pádem
nemusí být dostupné v prvních fázích instalace. Pokud na vašem hardwaru
nefunguje standardní cesta zavádění z CD, přečtěte si pasáž o alternativních
jádrech a o jiných instalačních metodách.

I když není možné zavést instalaci přímo z CD-ROM, můžete z CD-ROM instalovat
základní systém a balíčky. Jednoduše zaveďte systém pomocí jiného instalačního
média. Když dojde na instalaci základního systému a dalších balíků, zadejte, že
budete instalovat z CD-ROM mechaniky.

Pokud máte problémy se zaváděním, prostudujte si 5.4 - "Problémy s instalačním
systémem".

5.1.3. Zavedení z Windows

Pro zavedení instalátoru z Windows můžete buď

  • získat instalační CD/DVD, případně USB klíčenku, jak popisuje kapitola 4.1
    - "Oficiální sada CD/DVD-ROM", resp. 4.3 - "Příprava souborů pro zavedení z
    USB zařízení", nebo

  • stáhnout samostatnou Windows aplikaci dostupnou na zrcadlech Debianu jako
    tools/win32-loader/stable/win32-loader.exe.

Při použití instalačního CD nebo DVD, by se měl příslušný program spustit
automaticky při vložení média do mechaniky. Pokud jej Windows nespustí, nebo
pokud používáte USB klíčenku, můžete (před)instalační program spustit ručně
tak, že se přepnete na příslušné zařízení a spustíte setup.exe.

Po spuštění programu budete dotázáni na několik předběžných otázek a následně
bude váš systém upraven pro zavedení instalačního systému Debianu.

5.1.4. Zavedení z DOSu pomocí loadlin

Zaveďte operační systém DOS (ne Windows) například ze záchranného nebo
diagnostického média.

Pokud z DOSu můžete přistupovat na CD mechaniku, vložte do ní instalační CD a
přepněte se na ni příkazem

d:

kde d je označení vaší CD mechaniky. Pokud CD mechaniku nemáte, nebo není z
DOSu dostupná, nachystejte si předem příslušné soubory podle 4.4.2 - "Zavedení
instalačního systému programem loadlin" a přepněte se na disk, kam jste soubory
umístili.

Přesuňte se do podadresáře s preferovanou variantou jádra, např.

cd \install.386

. Preferujete-li grafickou instalaci, přejděte ještě do podadresáře gtk

cd gtk

. Nyní spusťte dávku install.bat. Zavede se jádro, které automaticky spustí
instalační systém.

5.1.5. Zavedení z Linuxu programem LILO nebo GRUB

Pro zavedení instalátoru z pevného disku musíte nejprve stáhnout potřebné
soubory a umístit je podle kapitoly 4.4 - "Příprava souborů pro zavedení z
pevného disku".

Plánujete-li z disku jenom nastartovat a poté již všechno stáhnout ze sítě,
měli byste použít soubor netboot/debian-installer/i386/initrd.gz a odpovídající
jádro netboot/debian-installer/i386/linux. To vám umožní přerozdělit disk, ze
kterého jste instalaci spustili.

Pokud během instalace nebudete upravovat diskovou oblast, na které jsou soubory
instalačního systému, můžete použít hd-media/initrd.gz, příslušné jádro a také
obraz CD nebo DVD (musí končit na .iso). Instalační systém pak nebude vyžadovat
připojení k síti.

Pro zavaděč LILO musíte v souboru /etc/lilo.conf nastavit dvě důležité věci:

  • říci zavaděči, že má při zavádění použít soubor initrd.gz jako RAMdisk,

  • říci jádru vmlinuz, že má tento RAMdisk použít jako svou kořenovou oblast.

Následuje příklad /etc/lilo.conf:

image=/boot/newinstall/vmlinuz
       label=newinstall
       initrd=/boot/newinstall/initrd.gz

Pokud vás zajímají pikantní detaily, prozkoumejte manuálové stránky initrd(4) a
lilo.conf(5). Nyní stačí spustit lilo a restartovat počítač.

Postup pro GRUB1 je velmi podobný. Do souboru menu.lst v adresáři /boot/grub/
(občas též /boot/boot/grub/) přidejte následující záznam (předpokládejme, že /
boot leží na první oblasti prvního disku):

title  Instalace Debianu
root   (hd0,0)
kernel /boot/newinstall/vmlinuz
initrd /boot/newinstall/initrd.gz

a restartujte počítač.

Postup pro GRUB2 je podobný jako u předchůdce, jenom soubor se místo menu.lst
jmenuje grub.cfg a změnil se jeho formát:

menuentry 'Instalace Debianu' {
  insmod part_msdos
  insmod ext2
  set root='(hd0,msdos1)'
  linux  /boot/newinstall/vmlinuz
  initrd /boot/newinstall/initrd.gz
}

Od teď by neměl být mezi jednotlivými zavaděči žádný rozdíl.

5.1.6. Zavedení z TFTP

Zavedení se sítě vyžaduje síťové připojení, funkční TFTP server a nejspíš i
DHCP, RARP nebo BOOTP server pro automatické nastavení sítě.

Nastavení zavádění ze sítě je popsáno v 4.5 - "Příprava souborů pro zavedení ze
sítě pomocí TFTP".

Na architektuře i386 existuje několik možností zavedení z TFTP.

5.1.6.1. Síťová karta s podporou PXE

Novější síťové karty podporují zavádění metodou PXE, což je reimplementace TFTP
od Intel (tm)u. Zde by mělo stačit příslušně nastavit BIOS.

5.1.6.2. Síťová karta s bootROM

Je možné, že vaše síťová karta nabízí možnost zavedení z TFTP.

5.1.6.3. Etherboot

Projekt Etherboot nabízí kromě zaváděcích disket také paměti do síťových karet,
které umí zavádět z TFTP.

5.1.7. Zaváděcí obrazovka

Při zavádění instalačního programu se objeví grafická obrazovka s logem Debianu
a nabídkou:

Debian GNU/Linux installer boot menu

Graphical install
Install
Advanced options             >
Help
Install with speech synthesis

Poznámka

Tato obrazovka může vypadat trošku jinak podle toho, zda se systém zavede v
režimu BIOS nebo v režimu UEFI, ale nabídka možností zůstává stejná.

V závislosti na zvoleném způsobu instalace nemusí být dostupná možnost grafické
instalace ("Graphical install"). Obrazy pro duální architektury navíc obsahují
položky pro 64 bitové varianty, což téměř zdvojnásobuje počet položek v
nabídce.

Pro běžnou instalaci vyberte šipkami buď položku "Install" (instalace v
textovém režimu), nebo "Graphical install" (instalace v grafickém režimu) a
potvrďte klávesou Enter. Na položku se také můžete dostat stiskem prvního
zvýrazněného písmena.

Položka "Advanced options" otevře další nabídku, kde si můžete zvolit pokročilé
způsoby instalace, jako je expertní režim, záchranný režim a automatizovaná
instalace.

Pokud potřebujete jádru nebo instalačnímu systému předat nějaké zaváděcí
parametry, stiskněte na zvolené položce klávesu Tab (při zavedení v režimu
BIOS), nebo e, třikrát down arrow a pak end (při zavedení v režimu UEFI).
Zobrazí se výzva boot:, na které bude vypsán celý příkaz k zavedení instalace.
Sem můžete přidat požadované parametry, nebo upravit stávající (nejběžnější
parametry jsou zmíněny v nápovědě - viz níže). Ze zaváděcího řádku můžete
zavést instalaci klávesou Enter (režim BIOS) nebo F10 (režim UEFI), případně se
klávesou Esc vrátit na úvodní obrazovku a vrátit tak provedené změny.

Položka "Help" zobrazí první obrazovku nápovědy se stručným přehledem
nápovědných obrazovek. Zde se můžete porozhlédnout po nápovědě, která se skrývá
pod klávesami F1 až F10, nebo můžete stisknout Enter a zavést systém s
výchozími hodnotami. Ze stránek nápovědy se můžete vrátit zpět do hlavní
nabídky příkazem menu. Příkazy můžete zadat do příkazového řádku, který se
nachází na každé nápovědné obrazovce:

Press F1 for the help index, or ENTER to boot:

Za příkazem pro zavedení instalace (výchozí je install) můžete zadat volitelné
parametry, které jsou popsány v nápovědě. Celý řádek by tedy vypadal třeba
takto: install fb=false. Jestliže stisknete pouze Enter, je to stejné, jako
kdyby jste zadali install bez dalších parametrů.

Poznámka

Klávesnice se nyní chová podle standardního rozložení americké angličtiny, což
by v našich krajích neměl být problém, protože základní rozložení je až na
prohozené Y/Z stejné, liší se pouze horní řada a pomocné znaky, které bývají na
klávesnicích předtištěny v obou variantách. Horší to mají třeba Francouzi s
jejich rozložením AZERTY -- v takovém případě snad pomůže článek z Wikipedie
zabývající se US rozložením.

Poznámka

Instalujete-li na systému, který má v BIOSu nastaveno použití sériové konzole,
je možné že neuvidíte grafickou část obrazovky a někdy dokonce ani zaváděcí
nabídku. To stejné vás může potkat v případech, kdy instalujete přes zařízení
pro vzdálenou správu, jež nabízí textové rozhraní k VGA konzoli (např. Compaq "
integrated Lights Out" (iLO), nebo HP "Integrated Remote Assistant" (IRA)).

Můžete se pokusit naslepo stisknout klávesu Esc, a přepnout se na textovou
zaváděcí výzvu, případně stisknout "H" a následně Enter, což by vás mělo
přepnout na (textovou) obrazovku s nápovědou popsanou výše. Zde by už mělo
fungovat echo, tj. znaky, které na klávesnici napíšete, by měly být normálně
vidět na řádku se zaváděcí výzvou. Chcete-li instalačnímu systému zakázat
použití grafického framebufferu ve zbytku instalace, přidejte na řádek parametr
vga=normal fb=false.

5.1.8. Grafický instalátor

Grafická verze instalačního systému je dostupná pouze na několika
architekturách, kam patří i 32-bit PC . Funkcionalita grafického instalátoru je
shodná s textovou verzí, protože se jedná o stejné programy, liší se pouze
vzhled.

I když je funkcionalita stejná, přesto přináší grafická verze několik výhod.
Tou hlavní je, že podporuje více jazyků, konkrétně ty, jejichž znaková sada se
nedá zobrazit v textovém rozhraní "newt". Grafické rozhraní také zlepšuje
použitelnost tím, že můžete volitelně používat myš a že je v některých
případech zobrazeno více otázek na jediné obrazovce (typicky zadání hesla a
jeho ověření).

Grafický instalátor je dostupný na všech obrazech CD a také při instalaci z
pevného disku metodou hd-media. Pro zavedení grafického instalátoru jednoduše z
menu vyberte příslušnou položku. Expertní a záchranný režim grafického
instlátoru je schovaný v menu "Advanced options". Dříve používané příkazy
installgui, expertgui resp. rescuegui stále můžete použít, ovšem musíte z
nabídky vybrat položku "Help", která mj. zobrazí výzvu boot:.

Existuje i obraz grafického instalátoru, který je možno zavést ze sítě, a
speciální "mini" ISO obraz^[6], ktery se používá hlavně pro testování.

Při startu grafického instalátoru můžete používat zaváděcí parametry stejně,
jako u textové verze.

Poznámka

Grafický instalátor vyžaduje pro běh mnohem více paměti než textová verze:
550MB. Pokud instalace zjistí nedostatek paměti, automaticky se přepne do
textového rozhraní "newt".

Máte-li však méně paměti než 400MB, je možné, že se grafická instalace vůbec
nezavede, zatímco textová verze může stále fungovat. Pro počítače s minimem
dostupné paměti je doporučeno použít rovnou textovou verzi.

5.2. Zpřístupnění

Někteří uživatelé mohou vyžadovat speciální podporu, například z důvodu
zrakového postižení. Braillovy řádky připojené přes USB jsou rozpoznány
automaticky (s výjimkou sériových modelů připojených přes USB převodník), ale
většinu zpřístupňujících vlastností je třeba zapnout ručně. Na počítačích,
které to podporují, se v zaváděcím menu ozve pípnutí (jednou pro systémy s
BIOSem, dvakrát pro systémy s UEFI). Toto pípnutí signalizuje, že je menu
připraveno zpracovávat stisky kláves. Poté můžete přidat zaváděcí parametry,
které zapnou některé další zpřístupňující vlastnosti (viz 5.1.7 - "Zaváděcí
obrazovka"). Zavaděče na většině architektur interpretují klávesnici jako
QWERTY.

5.2.1. Uživatelské rozhraní instalačního systému

Instalační systém Debianu podporuje několik rozhraní pro komunikaci s
uživatelem, které se liší v míře zpřístupnění. Například rozhraní text používá
čistý text, zatímco rozhraní newt využívá textová dialogová okna. Konkrétní
rozhraní si můžete zvolit před zavedením instalačního systému, jak je popsáno v
dokumentaci proměnné DEBIAN_FRONTEND v kapitole 5.3.2 - "Parametry instalačního
programu".

5.2.2. Braillův řádek připojený na USB

Braillovy řádky připojené na USB by měly být rozpoznány automaticky. V takovém
případě se instalace automaticky přepne do textového rozhraní a podpora
braillova řádku se automaticky doinstaluje do instalovaného systému. V
zaváděcím menu tedy stačí pouze stisknout Enter. Po startu brltty si můžete v
nastaveních zvolit vhodnou braillovu tabulku. Dokumentaci ohledně rozložení
kláves naleznete na stránkách brltty.

5.2.3. Braillův řádek připojený na sériový port

Braillovy řádky připojené na sériový port nelze rozpoznat automaticky, protože
by to některé modely mohlo poškodit. Musíte tedy použít zaváděcí parametr
brltty=ovladač,port, kterým brltty řeknete, který ovladač a port má použít.
ovladač je dvoupísmenný kód ovladače připojeného řádku (viz příručka k BRLTTY).
port je název sériového portu, ke kterému je řádek připojen; výchozí hodnotou
je ttyS0. Při použití USB převodníku se port obvykle jmenuje ttyUSB0. Volitelný
třetí parametr určuje braillovu tabulku pro daný jazyk (viz příručka k BRLTTY 
); výchozí je anglická tabulka. Tabulku můžete změnit i později v nastaveních
brltty. Čtvrtým parametrem lze předat parametry ovladači braillova řádku (např.
protocol=xzy), což je potřeba u některých raritních kousků. Dokumentaci ohledně
rozložení kláves naleznete na stránkách brltty.

5.2.4. Softwarová syntéza hlasu

Podporu softwarové syntézy hlasu naleznete ve všech variantách grafického
instalátoru a můžete ji aktivovat v zaváděcím menu stiskem klávesy s (vybere
příslušnou položku menu) a potvrdit klávesou Enter. Instalace se pak
automaticky spustí v textovém režimu a podpora hlasové systézy se automaticky
doinstaluje i do nového systému.

První otázka (výběr jazyka) je přečtena v angličtině, zbytek instalace probíhá
ve zvoleném jazyce (pokud jej espeak podporuje).

Výchozí rychlost řeči je docela pomalá, urychlit ji můžete stiskem CapsLock+6.
Naopak pro zpomalení použijte kombinaci CapsLock+5. Podobně můžete měnit i
hlasitost: klávesami CapsLock+2 hlasitost zvýšíte, klávesami CapsLock+1
ztišíte.

Další klávesové zkratky naleznete v příručce programu Speakup.

Chcete-li při instalaci zvolit výchozí odpověď na otázku, jednoduše na promptu
stiskněte Enter. Pro zadání prázdné odpovědi napište do promptu vykřičník ! a
pro návrat k předchozí otázce do promptu zadejte <.

5.2.5. Hardwarová syntéza hlasu

Podpora pro hardwarovou syntézu hlasu funguje pouze v textovém režimu, nicméně
kvůli své velikosti je dostupná pouze na médiích s podporou grafického
instalátoru. V zaváděcím menu tedy musíte vybrat grafickou instalaci "Graphical
install".

Zařízení pro hardwarovou syntézu hlasu nelze rozpoznat automaticky a proto
musíte použít zaváděcí parametr speakup.synth=ovladač, kterým speakupu
prozradíte, který ovladač má použít. Jako ovladač zadejte dvoupísmenný kód
ovladače vašeho zařízení (viz seznam kódů). Instalace se pak automaticky přepne
do textového režimu a do instalovaného systému přidá podporu pro hlasovou
syntézu.

5.2.6. Zařízení připojená rovnou na sběrnici

Některá zařízení pro zpřístupnění jsou dodávána jako karty zapojené uvnitř
počítače, které čtou text přímo z videopaměti. Aby tyto karty fungovaly, musíte
vypnout framebuffer zaváděcím parametrem vga=normal fb=false. Tím však také
snížíte počet dostupných jazyků.

Pokud chcete, je možné aktivovat textovou verzi zavaděče ještě před přidáním
zaváděcího parametru stiskem klávesy h následované klávesou Enter.

5.2.7. Kontrastní téma

Uživatelé se zhoršeným zrakem mohou při instalaci použít vysoce kontrastní
téma, které by mělo zlepšit čitelnost. Pro zapnutí stačí přidat zaváděcí
parametr theme=dark.

5.2.8. Změna velikosti písma

Grafický instalátor obsahuje základní podporu pro změnu velikosti písma.
Klávesovými zkratkami Control++ resp. Control+- lze velikost písma zvětšit,
resp. zmenšit.

5.2.9. Záchranný režim, expertní a automatizované instalace

Zpřístupnění funguje i v režimech Expert, Rescue a Automatizovaná instalace. V
zaváděcím menu je naleznete pod nabídkou "Advanced options", do které se
dostanete stiskem klávesy a. Na systémech s BIOSem (v zaváděním menu se ozvalo
jedno pípnutí) musíte každou volbu potvrdit ještě klávesou Enter. Pro povolení
syntézy hlasu stiskněte klávesu s (na systémech s BIOSem opět následovanou
klávesou Enter). Zde můžete použít klávesy x pro expertní režim, r pro
záchranný režim nebo a pro automatizovaný režim.

Volba automatizované instalace umožňuje nainstalovat Debian zcela automaticky
pomocí přednastavení. Tomuto způsobu se podrobně věnuje kapitola B - "
Automatizování instalací pomocí přednastavení".

5.2.10. Zpřístupnění v nainstalovaném systému

Problematikou zpřístupnění v nainstalovaném systému se zabývá wiki stránka
Debian Accessibility.

5.3. Zaváděcí parametry

Parametry pro zavádění jsou vlastně parametry pro jádro Linuxu, které se
používají v případech, kdy chceme zajistit, aby jádro korektně pracovalo s
neposlušnými zařízeními. Ve většinou je jádro schopno rozpoznat všechna
zařízení automaticky, ale v některých speciálních případech mu musíte trochu
pomoci.

Při prvním zavádění systému zkuste, zdali systém rozpozná všechna potřebná
zařízení jen s implicitními parametry (tj. nenastavujte pro začátek žádné
vlastní hodnoty). Systém obvykle naběhne. V případě, že se tak nestane, můžete
systém zavést později poté, co zjistíte, jaké parametry je potřeba zadat, aby
jádro korektně rozpoznalo váš hardware.

Poznatky o nejrůznějších zaváděcích parametrech a podivných zařízeních jsou k
nalezení v Linux BootPrompt HOWTO. Následující text obsahuje popis jen
stěžejních parametrů. Vybrané problémy popisuje 5.4 - "Problémy s instalačním
systémem".

5.3.1. Zavěděcí konzole

Jádro by mělo být schopno rozpoznat, že zavádíte systém ze sériové konzoly.
Pokud máte v zaváděném počítači rovněž grafickou kartu (framebuffer) a
připojenou klávesnici, měli byste při zavádění zadat parametr console=zařízení,
kde zařízení je vaše sériové zařízení, což je obvykle něco jako ttyS0.

Někdy je potřeba zadat konkrétní parametry sériového portu, jako je jeho
rychlost a parita, např. console=ttyS0,9600n8. Další obvyklé rychlosti bývají
57600 a 115200. Ujistěte se, že tento parametr přidáte až za "---", aby se toto
nastavení zkopírovalo i do konfigurace zavaděče v instalovaném systému. (Pokud
to instalátor pro daný zavaděč umožňuje.)

Abyste zajistili, že instalace používá typ terminálu kompatibilní s vaším
emulátorem terminálu, můžete přidat parametr TERM=typ. Instalační systém
podporuje následující typy terminálů: linux, bterm, ansi, vt102 a dumb. Pro
sériovou konzoli v debian-installer je výchozím typem vt102. Používáte-li IPMI
konzoli, nebo virtualizační nástroj (např. QEMU/KVM), který sám o sobě nenabízí
konverzi do daných typů terminálu, můžete jej spustit uvnitř screen. To totiž
zajistí automatický převod na typ terminálu screen, který je velmi podobný typu
vt102.

5.3.2. Parametry instalačního programu

Instalační systém rozpoznává několik užitečných parametrů^[7].

Mnoho parametrů má i svou zkrácenou formu, která usnadňuje zadávání a také
pomáhá obejít omezení příkazové řádky jádra. Pokud má parametr zkrácenou formu,
bude uvedena v závorce za dlouhou podobou. Krátkou formu preferujeme i v
příkladech této příručce.

debconf/priority (priority)

    Nastavením tohoto parametru můžete změnit nejnižší prioritu zobrazených
    otázek.

    Standardní instalace používá nastavení priority=high, což znamená, že se
    zobrazí jak kritické, tak důležité hlášky, ale normální a nevýznamné zprávy
    jsou přeskočeny. Jestliže se vyskytne problém, instalátor upraví priority
    otázek podle potřeb.

    Když použijete parametr priority=medium, zobrazí se instalační menu a
    získáte nad instalací větší kontrolu. Při použití priority=low, nic se
    nepřeskakuje a zobrazí se všechny hlášky instalačního programu (to je
    ekvivalentní zaváděcí metodě expert). Hodnotou priority=critical se potlačí
    všechny zprávy a otázky se stupněm důležitosti menším než kritickým. Pro
    tyto potlačené otázky se použijí přednastavené hodnoty.

DEBIAN_FRONTEND

    Ovlivňuje uživatelské rozhraní, ve kterém bude instalace probíhat. Dostupné
    volby jsou:

      □ DEBIAN_FRONTEND=noninteractive

      □ DEBIAN_FRONTEND=text

      □ DEBIAN_FRONTEND=newt

      □ DEBIAN_FRONTEND=gtk

    Výchozí rozhraní je DEBIAN_FRONTEND=newt. Pro instalaci přes sériovou
    konzolu může být vhodnější DEBIAN_FRONTEND=text. Některé specializované
    typy instalačních médií mohou nabízet jen omezený výběr rozhraní, nicméně
    rozhraní newt a text by měla být dostupná na většině instalačních médií. Na
    architekturách, kde to je možné, využívá grafický instalátor rozhraní gtk.

BOOT_DEBUG

    Tímto parametrem můžete kontrolovat množství zpráv, které se zapíší do
    instalačního logu.

    BOOT_DEBUG=0

        Toto je standardní hodnota.

    BOOT_DEBUG=1

        Upovídanější než obvykle.

    BOOT_DEBUG=2

        Spousty ladících informací.

    BOOT_DEBUG=3

        Pro opravdu detailní ladění se během zavádění několikrát spustí shell,
        ve kterém můžete kontrolovat a ovlivňovat náběh systému. Když shell
        ukončíte, bude zavádění pokračovat.

INSTALL_MEDIA_DEV

    Hodnota tohoto parametru zadává cestu k zařízení, ze kterého se má nahrát
    instalační systém, například INSTALL_MEDIA_DEV=/dev/floppy/0

    Normálně se totiž zaváděcí disketa snaží najít kořenovou disketu na všech
    dostupných disketových mechanikách. Tímto parametrem jí sdělíte, že se má
    podívat jenom na zadané zařízení.

log_host, log_port

    Způsobí, že instalátor nebude ukládat logovací hlášky jen do lokálního
    souboru, ale bude je také posílat přes síť vzdálenému syslogu běžícímu na
    zadaném počítači a portu. Jestliže parametr log_port vynecháte, bude se
    předpokládat standardní port syslogu 514.

lowmem

    Může vynutit, aby instalátor použil agresivnější nízkopaměťový režim, než
    by nastavil podle skutečně dostupné paměti. Možné hodnoty jsou 1 a 2. Více
    naleznete v 6.3.1.1 - "Kontrola dostupné paměti / nízkopaměťový režim".

noshell

    Zabrání instalátoru, aby na druhé a třetí virtuální konzoli nabízel
    interaktivní shell, což je užitečné při automatizovaných vzdálených
    instalacích, kdy je fyzická bezpečnost omezena.

debian-installer/framebuffer (fb)

    Některé architektury využívají pro instalaci v různých jazycích jaderný
    framebuffer (grafická konzole). Pokud na svém systému zaznamenáte symptomy
    jako chybové hlášky o btermu a boglu, černou obrazovku nebo zamrznutí
    instalace po několika minutách od spuštění, můžete framebuffer vypnout
    parametrem vga=normal fb=false.

debian-installer/theme (theme)

    Téma určuje vzhled uživatelského rozhraní instalačního systému (barvy,
    ikony, atd.). Dostupná témata se liší podle použitého rozhraní. Rozhraní
    newt i gtk nyní podporují pouze alternativní téma "dark", které bylo
    navrženo pro zrakově postižené uživatele. Téma můžete nastavit zaváděcím
    parametrem theme=dark.

netcfg/disable_autoconfig

    Standardně se debian-installer snaží získat nastavení sítě přes automatické
    nastavení sítě IPv6 a DHCP. Je-li získáno nějaké nastavení, instalační
    systém se na nic nebude ptát a automaticky bude pokračovat v instalaci. K
    ručnímu nastavení sítě se dostanete pouze v případě, že automatické
    nastavení selže.

    Máte-li tedy na místní síti DHCP server nebo IPv6 router, ale z nějakého
    důvodu jej nechcete použít (protože např. pro účely instalace vrací špatné
    hodnoty), můžete použít parametr netcfg/disable_autoconfig=true, kterým
    zabráníte automatickému nastavení sítě (ať už verze 4 nebo 6) a rovnou
    budete požádáni o ruční nastavení síťových údajů.

hw-detect/start_pcmcia

    Pokud chcete zabránit startu PCMCIA služeb, nastavte tento parametr na
    hodnotu false. Některé notebooky jsou totiž nechvalně známé tím, že při
    startu PCMCIA služeb zaseknou celý systém.

disk-detect/dmraid/enable (dmraid)

    Chcete-li v instalačním systému zapnout podporu disků připojených k
    sériovému ATA RAIDu (též známému jako ATA RAID, BIOS RAID nebo falešný
    RAID), nastavte parametr na hodnotu true. Tato podpora je zatím
    experimentální. Více informací naleznete v v Debian Installer Wiki.

preseed/url (url)

    Zde můžete zadat url k souboru s přednastavením, podle kterého se má
    provést automatická instalace, viz 4.6 - "Automatická Instalace".

preseed/file (file)

    Zde můžete zadat soubor s přednastavením, podle kterého se má provést
    automatická instalace, viz 4.6 - "Automatická Instalace".

preseed/interactive

    Nastavením na hodnotu true se zobrazí i otázky, které byly přednastaveny.
    To může být užitečné pro testování nebo ladění souboru s přednastavením.
    Nastavení se neprojeví u otázek, které byly zadány jako parametry při
    zavádění systému. Pro ty však existuje speciální syntaxe, viz B.5.2 -
    "Použití přednastavení pro změnu výchozích hodnot".

auto-install/enable (auto)

    Při nastavení na hodnotu true odsune otázky obvykle zobrazované před
    začátkem přednastavení až za nastavení sítě. Podrobnosti o automatizaci
    instalací pomocí této možnosti naleznete v části B.2.3 - "Automatický
    režim".

finish-install/keep-consoles

    Během instalací skrze sériovou nebo správcovskou konzoli jsou tradiční
    virtuální konzoly (VT1-VT6) v souboru /etc/inittab zakázány. Chcete-li tomu
    zabránit, nastavte na hodnotu true.

cdrom-detect/eject

    Před restartem debian-installer do nového systému se implicitně vysune
    optické médium použité během instalace. To někdy není potřeba (např. systém
    není nastaven pro automatické zavádění z CD-ROM) a v některých případech
    může být vysunutí dokonce nežádoucí. Například pokud mechanika neumí nahrát
    médium sama a uživatel zrovna není na místě, aby to provedl ručně.
    Příkladem takovýchto mechanik jsou mechaniky v přenosných počítačích a
    mechaniky se štěrbinovým podáváním.

    Pro zakázání automatického vysunutí nastavte parametr na hodnotu false.

base-installer/install-recommends (recommends)

    Nastavením na hodnotu false se systém pro správu balíků nebude pokoušet o
    instalaci doporučených balíků jak během instalace, tak později v
    nainstalovaném systému. Více naleznete v kapitole 6.3.4 - "Instalace
    základního systému".

    Použitím této volby můžete získat štíhlejší systém, ale také je možné, že
    zmizí některé vlastnosti, které byste normálně od systému očekávali. Pro
    získání požadované funkcionality pak můžete ručně doinstalovat některé
    vybrané doporučované balíky, nicméně musíte vědět, které balíky potřebujete
    a proto by tuto možnost měli používat pouze zkušení harcovníci.

debian-installer/allow_unauthenticated

    Instalační systém vyžaduje, aby byly všechny repositáře autentizovány
    známým gpg klíčem. Nastavením na hodnotu true můžete autentizaci potlačit. 
    Varování: Nebezpečné, není doporučeno.

rescue/enable

    Nastavíte-li tento parametr na hodnotu true, spustí se místo běžné
    instalace záchranný režim. Viz 8.7 - "Obnovení poškozeného systému".

5.3.3. Použití zaváděcích parametrů pro zodpovězení otázek

Na stejném místě, kam se zadávají parametry pro jádro nebo instalační program,
můžete zadat odpověď na téměř každou otázku, se kterou se můžete při instalaci
potkat. Tato možnost se využívá spíše ve specifických případech a je zde
vypsáno jen několik příkladů. Podrobnější informace naleznete v dodatku B.2.2 -
"Použití zaváděcích parametrů jako formy přednastavení".

debian-installer/language (language), debian-installer/country (country), 
    debian-installer/locale (locale)

    Existují dva způsoby, jak nastavit jazyk, zemi a místní prostředí (locale)
    instalace a následně nainstalovaného systému.

    První a nejjednodušší je použít pouze parametr locale. Jazyk a země se pak
    z této hodnoty odvodí automaticky. Například locale=de_CH vybere jako
    výchozí jazyk němčinu, jako zemi Švýcarsko a výchozí locale v
    nainstalovaném systému bude de_CH.UTF-8. Nevýhodou je skutečnost, že takto
    nelze nastavit všechny možné kombinace jazyka, země a locale.

    Druhou, pružnější, možností je zadat jazyk (language) a zemi (country)
    samostatně, přičemž můžete volitelně použít i parametr locale, kterým
    nastavíte výchozí locale instalovaného systému. Například můžete systému
    sdělit, že se nacházíte v Německu, ale rádi byste používali anglické
    prostředí v jeho britském standardu: language=en country=DE locale=
    en_GB.UTF-8.

anna/choose_modules (modules)

    Pomocí tohoto parametru můžete nechat automaticky nahrát komponenty
    instalačního systému, které se implicitně nenahrávají. Příkladem užitečných
    komponent jsou openssh-client-udeb (během instalace můžete využívat scp) a
    ppp-udeb (podporuje nastavení PPPoE, viz D.5 - "Jak nainstalovat Debian GNU
    /Linux pomocí PPP přes Ethernet (PPPoE)").

mirror/protocol (protocol)

    Instalační systém standardně používá pro stažení souborů ze zrcadel Debianu
    protokol http a při standardní prioritě otázek nelze za běhu změnit na ftp.
    nastavením tohoto parametru na hodnotu ftp můžete instalátor donutit, aby
    použil právě tento protokol. Ftp zrcadlo nemůžete vybrat z připraveného
    seznamu, vždy jej musíte zadat ručně.

tasksel:tasksel/first (tasks)

    Tímto parametrem můžete nainstalovat úlohy, které nejsou při instalaci v
    interaktivním seznamu úloh dostupné. Příkladem budiž úloha kde-desktop.
    Více informací naleznete v části 6.3.5.2 - "Výběr a instalace softwaru".

5.3.4. Předávání parametrů jaderným modulům

Jestliže jsou ovladače zakompilovány přímo do jádra, můžete jim předávat
parametry tak, jak je popsáno v dokumentaci k jádru. Pokud však jsou ovladače
zkompilovány jako moduly, znamená to, že jsou při instalaci zaváděny odlišným
způsobem než při zavádění nainstalovaného systému a nemůžete jim předat
parametry klasickým postupem. Musíte použít speciální syntaxi, kterou
instalátor rozpozná a zařídí, aby se tyto parametry uložily do příslušných
konfiguračních souborů a posléze se v pravý čas použily. Tyto parametry se
automaticky přenesou i do nainstalovaného systému.

Poznamenejme, že v dnešní době je používání parametrů modulů téměř raritou,
protože jádro ve většině případů správně rozpozná přítomný hardware a nastaví
pro něj vhodné hodnoty automaticky. Pokud tomu tak není, stále můžete použít
ruční nastavení.

Syntaxe pro nastavení parametrů modulu je následující:

název_modulu.název_parametru=hodnota

Potřebujete-li modulu předat několik parametrů, stačí syntaxi několikrát
zopakovat. Například pro nastavení staré síťové karty 3Com, aby použila
konektor BNC (koaxiální) a IRQ 10, zadali-byste:

3c509.xcvr=3 3c509.irq=10

5.3.5. Zapsání jaderných modulů na černou listinu

Někdy je nutné zanést modul na černou listinu a zabránit tak jádru a udevu, aby
jej automaticky zavedli. Jedním z důvodů bývá ten, že modul způsobuje na vašem
hardwaru problémy. Někdy také jádro registruje pro jedno zařízení dva ovladače,
což může vytvářet problémy v případech, kdy jsou tyto ovladače navzájem
konfliktní, nebo pokud zařízení funguje správně jen s jedním z ovladačů a jádro
nejprve zavede ten chybný ovladač.

Moduly můžete na černou listinu přidat následovně: jméno_modulu.blacklist=yes.
Prakticky to znamená, že se modul zapíše do souboru /etc/modprobe.d/
blacklist.local, což ho vyřadí jak během instalace, tak v nově nainstalovaném
systému.

Poznamenejme, že modul stále může být zaveden explicitně přímo instalačním
systémem. Předejít tomu můžete instalací v expertním režimu a odebráním modulu
ze seznamu modulů, který se zobrazuje během několika fází rozpoznávání
hardwaru.

5.4. Problémy s instalačním systémem

5.4.1. Spolehlivost CD

Občas, obzvláště se staršími CD mechanikami, se nemusí podařit zavést
instalační systém. Dokonce je možné, že se systém zavede, ale poté již CD
mechaniku nenalezne, nebo během instalace bude čtení vracet chyby.

Možných příčin je spousta a můžeme zde vypsat jen ty nejběžnější, resp. můžeme
zmínit obecné postupy. Zbytek je na vás.

Nejprve byste měli vyzkoušet dvě nejjednodušší věci.

  • Pokud z CD nejde zavést, zkontrolujte, že je disk vložen správně a že není
    špinavý.

  • Pokud systém sice naběhne, ale rozpoznání CD selže, zkuste z menu opakovaně
    vybrat možnost Rozpoznat a připojit CD-ROM. Je známo, že se tím vyřeší
    některé problémy s DMA muzeálních CD mechanik.

Jestliže to stále nepomohlo, zkuste některý z návrhů níže. Většina návrhů platí
jak pro CD mechaniky, tak pro DVD, Blu-Ray a podobné mechaniky.

Jako poslední záchrana zde stále existuje možnost zvolit instalaci z jiného
média, např. ze sítě.

5.4.1.1. Běžné problémy

  • Některé starší CD mechaniky nepodporují čtení disků vypálených na novějších
    vypalovačkách vyššími rychlostmi.

  • Některé hodně staré CD mechaniky nefungují správně při povoleném DMA "
    direct memory access".

5.4.1.2. Jak zjistit o problému co nejvíce (a možná jej vyřešit)

Pokud se nedaří z CD zavést systém, zkuste následující.

  • Zkontrolujte, zda je v BIOSu povoleno zavádění z CD a že vaše CD mechanika
    podporuje média, která používáte.

  • Pokud jste si stáhli iso obraz, zkontrolujte, že souhlasí kontrolní součet
    s tím, který se nachází v souboru MD5SUMS. Soubor by měl ležet na stejném
    místě, ze kterého jste stáhli obraz.

    $ md5sum debian-testing-i386-netinst.iso
    a20391b12f7ff22ef705cee4059c6b92  debian-testing-i386-netinst.iso

    Dále zkontrolujte, že kontrolní součet souhlasí i po vypálení obrazu.

    $ dd if=/dev/cdrom | \
    > head -c `stat --format=%s debian-testing-i386-netinst.iso` | \
    > md5sum
    a20391b12f7ff22ef705cee4059c6b92  -
    262668+0 records in
    262668+0 records out
    134486016 bytes (134 MB) copied, 97.474 seconds, 1.4 MB/s

Pokud se podařilo zavést instalační systém, ale ten už CD nerozpozná, postačí
někdy z hlavního instalačního menu znovu spustit krok rozpoznání CD. Máte-li
více mechanik, zkuste použít nějakou jinou. Jestliže to nepomáhá, nebo se při
čtení objevují chyby, zkuste některou z rad níže. Pro následující kroky je
třeba základní znalost jádra Linux. Pro spouštění různých příkazů byste se měli
přepnout na druhou virtuální konzolu (VT2) a aktivovat tam spící shell.

  • Zkontrolujte podezřelé hlášky na čtvrté virtuální konzoli, nebo si editorem
    nano prohlédněte obsah souboru /var/log/syslog. Poté zkontrolujte výstup
    příkazu dmesg.

  • Ve výpisu příkazu dmesg se podívejte, zda byla vaše CD mechanika nalezena.
    Měli byste tam vidět něco podobného (ne nutně v tomto pořadí):

    ata1.00: ATAPI: MATSHITADVD-RAM UJ-822S, 1.61, max UDMA/33
    ata1.00: configured for UDMA/33
    scsi 0:0:0:0: CD-ROM            MATSHITA DVD-RAM UJ-822S  1.61 PQ: 0 ANSI: 5
    sr0: scsi3-mmc drive: 24x/24x writer dvd-ram cd/rw xa/form2 cdda tray
    cdrom: Uniform CD-ROM driver Revision: 3.20

    Nevidíte-li nic podobného, je možné, že řadič, ke kterému je vaše CD
    mechanika připojena, nebyl rozpoznán, nebo není podporován. Jestliže víte,
    který ovladač je vyžadován pro váš řadič, můžete jej zkusit nahrát ručně
    příkazem modprobe.

  • Zkontrolujte, zda se v adresáři /dev/ vytvořil soubor zařízení odpovídající
    vaší CD mechanice. Podle výše uvedeného příkladu by to byl soubor /dev/sr0.
    Také by měl existovat symbolický odkaz /dev/cdrom.

  • Příkazem mount se přesvědčte, zda je CD připojeno. Pokud ne, zkuste je
    připojit ručně.

    $ mount /dev/hdc /cdrom

    Podívejte se, zda tento příkaz nevyvolal nějaká chybová hlášení.

  • Zkontrolujte, zda je DMA zapnuté:

    $ cd /proc/ide/hdc
    $ grep using_dma settings
    using_dma      1       0       1       rw

    Číslo "1" v prvním sloupci za textem using_dma znamená, že je DMA povoleno.
    Pokud je, zkuste je vypnout:

    $ echo -n "using_dma:0" >settings

    Před spuštěním příkazu se ujistěte, že jste v adresáři zařízení, které
    odpovídá vaší CD mechanice.

  • Pokud se během instalace vyskytnou problémy, zkuste zkontrolovat integritu
    média pomocí volby v hlavním menu instalačního systému. Toto menu můžete
    použít jako rozumný test, zda je možné spolehlivě přečíst celé CD.

5.4.2. Zaváděcí konfigurace

Pokud se jádro zasekne během zavádění, nerozezná připojená zařízení, nebo disky
nejsou korektně rozpoznány, v prvé řadě zkontrolujte parametry jádra, kterými
se zabývá 5.3 - "Zaváděcí parametry".

V některých případech může za nefunkčnost zařízení chybějící firmware, jak
popisují části 2.2 - "Ovladače vyžadující firmware" a 6.4 - "Nahrání
chybějícího firmwaru".

5.4.3. Softwarová syntéza hlasu

Pokud softwarová syntéza hlasu nefunguje, bývá to obvykle problém se zvukovou
kartou. Buď není její ovladač součástí instalátoru, nebo její mixer používá
atypické názvy kanálů, které jsou vevýchozím nastavení ztišené. Měli byste to
nahlásit jako chybu a přiložit k ní výpisy násedujících příkazů spuštěných na
daném počítači z jiného linuxového systému, na kterém zvuk funguje (například z
Live CD).

  • dmesg

  • lspci

  • lsmod

  • amixer

5.4.4. Běžné instalační problémy na 32-bit PC

V praxi se můžete potkat s instalačními problémy, které lze vyřešit, nebo je
aspoň obejít, zadáním určitých zaváděcích parametrů instalačnímu programu.

Jestliže je obraz na obrazovce během zavádění jádra "divný", jako třeba čistě
bílý, naprosto černý, nebo se zobrazuje barevné "smetí", máte problematickou
grafickou kartu, která se neumí správně přepnout do grafického režimu. V
takovém případě pomůže zaváděcí parametr fb=false, kterým vypnete grafický
framebuffer. Během instalace však bude k dispozici pouze podmnožina dostupných
jazyků, protože některé jazyky nejdou v čistě textovém režimu zobrazit.
Zaváděcí parametry popisuje 5.3 - "Zaváděcí parametry".

5.4.4.1. Systém zamrzne během konfigurování PCMCIA

Některé staré modely notebooků firmy Dell jsou známé tím, že se zhroutí, když
automatické rozpoznávání PCMCIA zařízení přistoupí na určité hardwarové adresy.
Toto chování mohou vykazovat i některé notebooky jiných výrobců. Pokud se u vás
tento problém projevuje a pro instalaci podporu PCMCIA nepotřebujete, můžete ji
vypnout zaváděcím parametrem hw-detect/start_pcmcia=false. Služby PCMCIA můžete
zprovoznit později po instalaci.

Alternativně můžete instalační program zavést v expertním režimu. Pak budete
mimo jiné dotázáni na rozsah zdrojů, které váš hardware vyžaduje. Například
pokud máte jeden z výše zmíněných Dellů, měli byste zde zadat exclude port
0x800-0x8ff. Seznam obvyklých rozsahů se nachází například v System resource
settings section of the PCMCIA HOWTO. Při zadávání rozsahů do instalačního
programu vynechejte všechny čárky (pokud se v rozsazích nachází).

5.4.5. Význam hlášek při zavádění jádra

Během zavádění systému můžete vidět spoustu hlášení typu can't find ..., ...
not present, can't initialize ... nebo this driver release depends on ....
Většina těchto hlášení je neškodná. Vy je vidíte proto, že jádro instalačního
systému je přeloženo tak, aby mohlo běžet na počítačích s odlišnými
hardwarovými konfiguracemi a mnoha různými periferními zařízeními. Samozřejmě
že žádný počítač asi nebude mít všechna zařízení, tudíž systém nahlásí několik
nenalezených zařízení. Také se může stát, že se zavádění na chvíli zastaví. To
se stává při čekání na odpověď od zařízení, které v systému chybí. Pokud se vám
zdá doba, za kterou systém naběhne, příliš dlouhá, můžete si později vytvořit
vlastní jádro (viz 8.6 - "Kompilace nového jádra").

5.4.6. Hlášení problémů s instalací

Jestliže se dostanete přes úvodní fázi zavedení systému, ale nemůžete instalaci
dokončit, můžete použít menu Uložit záznamy pro pozdější ladění. Tato volba vám
umožní uložit na disketu nebo zpřístupnit přes webové rozhraní chybové hlášky,
stav systému a jiné užitečné informace, které vám mohou naznačit, v čem je
problém a jak ho vyřešit. Tyto údaje nám také můžete poslat spolu s hlášením o
chybě.

Další užitečné informace můžete najít během instalace v adresáři /var/log/ a
později v novém systému ve /var/log/installer/.

5.4.7. Pošlete nám zprávu o instalaci

Pokud problém přetrvává, prosíme vás o zaslání zprávy o průběhu instalace.
Zprávu o instalaci můžete zaslat i v případě, že vše proběhlo bez problémů --
získáme tak přehled o nejrůznějších hardwarových konfiguracích.

Zprávy o instalaci budou publikovány v našem systému sledování chyb (BTS, Bug
Tracking System) a budou přeposlány do veřejného diskusního listu. Proto se
ujistěte, že použijete emailovou adresu, u které vám nevadí, že bude
zveřejněna.

Máte-li funkční systém s Debianem, je nejjednodušší zaslat zprávu pomocí balíku
reportbug. Nainstalujte si potřebné balíky (apt install installation-report
reportbug), nastavte reportbug podle kapitoly 8.5.2 - "Odesílání pošty mimo
systém" a spusťte příkaz reportbug installation-reports.

Při psaní zprávy můžete využít následující šablonu, kterou pak zašlete jako
hlášení o chybě vůči pseudobalíku installation-report na adresu <
submit@bugs.debian.org>.

Package: installation-reports

Boot method: <Jak jste zavedli instalaci? CD? Disketa? Síť?>
Image version: <Celé url, odkud jste stáhli obraz(y)>
Date: <Datum a čas instalace>

Machine: <Popis počítače (např. IBM Thinkpad T41)>
Processor:
Memory:
Partitions: <Výstup příkazu df -Tl;>

Output of lspci -knn (or lspci -nn):

Base System Installation Checklist:
[O] = OK, [E] = Error (please elaborate below), [ ] = didn't try it

Initial boot:           [ ]
Detect network card:    [ ]
Configure network:      [ ]
Detect CD:              [ ]
Load installer modules: [ ]
Detect hard drives:     [ ]
Partition hard drives:  [ ]
Install base system:    [ ]
Clock/timezone setup:   [ ]
User/password setup:    [ ]
Install tasks:          [ ]
Install boot loader:    [ ]
Overall install:        [ ]

Comments/Problems:

<Zde se můžete rozepsat o způsobu instalace, zmínit nápady
      a postřehy, které vás napadly během instalace.>

V samotné zprávě podrobně popište problém, včetně posledních viditelných hlášek
jádra v okamžiku zaseknutí počítače. Také nezapomeňte popsat kroky, kterými
jste se do problémové části dostali.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[5] Jestliže to hardware podporuje a pokud jste nepoužili pružný způsob
vytvoření klíčenky a tuto možnost nezakázali.

^[6] Mini ISO můžete stáhnout ze zrcadla Debianu stejně jako ostatní soubory v
4.2 - "Stažení souborů ze zrcadel Debianu", hledejte něco s názvem netboot/gtk/
mini.iso.

^[7] S aktuálními jádry (od verze 2.6.9) lze použít až 32 parametrů a 32
proměnných prostředí. Pokud tato čísla překročíte, jádro zpanikaří. Další
omezení je, že se celá příkazová řádka jádra musí vejít do 255 znaků. Cokoliv
nad tuto délku může být v tichosti oříznuto.

Kapitola 6. Používáme instalační program Debianu

Obsah

6.1. Základní principy

    6.1.1. Používání grafického instalátoru

6.2. Úvod do komponent
6.3. Použití jednotlivých komponent

    6.3.1. Nastavení instalačního programu a rozpoznání hardwaru
    6.3.2. Nastavení uživatelů a hesel
    6.3.3. Rozdělení disku a výběr přípojných bodů
    6.3.4. Instalace základního systému
    6.3.5. Instalace dodatečného softwaru
    6.3.6. Nastavení zavádění systému
    6.3.7. Dokončení instalace
    6.3.8. Řešení problémů
    6.3.9. Instalace přes síť

6.4. Nahrání chybějícího firmwaru

    6.4.1. Příprava média
    6.4.2. Firmware a instalovaný systém

6.1. Základní principy

Instalační program Debianu se skládá z mnoha malých, jednoúčelových komponent.
Každá komponenta má na starosti jeden krok instalace (od úvodního dialogu pro
výběr jazyka až po závěrečný restart do nového systému). Komponenty se snaží
pracovat samostatně, ale pokud je to nutné, zeptají se uživatele na další
postup.

Otázky samotné mají přiřazeny různé priority. Uživatel si může nastavit úroveň
zobrazených otázek, takže uživatel začátečník se nemusí zatěžovat nepodstatnými
věcmi (instalační program dosadí "rozumné" hodnoty). Implicitně se
debian-installer ptá pouze na otázky s vysokou prioritou, což vede k poměrně
automatickému procesu s minimem uživatelských zásahů.

Pokud se vyskytne problém, zobrazí se chybová obrazovka s popisem problému a
následně se objeví hlavní menu instalačního programu, kde můžete situaci
napravit. V ideálním případě uživatel menu vůbec neuvidí a bude pouze odpovídat
na otázky jednotlivých komponent. Oznámení o vážných problémech mají nastavenou
"kritickou" prioritu, tudíž budou zobrazeny vždy.

Některá výchozí nastavení instalačního programu lze změnit pomocí zaváděcích
parametrů při startu debian-installeru. Například pokud si chcete vynutit
statické nastavení sítě (implicitně se používá DHCP nebo automatické nastavení
IPv6), použijte parametr netcfg/disable_autoconfig=true. Seznam dostupných
parametrů naleznete v kapitole 5.3.2 - "Parametry instalačního programu".

Pokročilí uživatelé jistě ocení přístup do (standardně skrytého) menu, ve
kterém mohou kontrolovat každý krok instalace. Menu vyvoláte tak, že při startu
přidáte zaváděcí parametr priority=medium.

Jestliže váš hardware vyžaduje zadat při instalaci jaderných modulů nějaké
parametry, je nutné spustit instalační program v "expertním" režimu. Toho
docílíte tak, že spustíte instalátor příkazem expert, nebo použijete zaváděcí
parametr priority=low. Expertní režim vám dá plnou kontrolu nad instalačním
procesem.

V textovém režimu nefunguje myš. Pro pohyb v dialogových oknech slouží několik
málo kláves. Pravou šipkou nebo klávesou Tab se přesunujete po zobrazených
prvcích "vpřed", levou šipkou nebo kombinací Shift+Tab zase "zpět". V
nabízených seznamech se můžete pohybovat šipkou nahoru a šipkou dolů, pro větší
skoky lze využít klávesy Page Up a Page Down. Také můžete stisknout nějaké
písmeno, čímž skočíte na první položku začínající tímto písmenem. Mezerník
slouží pro vybírání/odebírání položek ze zaškrtávacích tlačítek. Volby se
potvrzují klávesou Enter.

Některé dialogy mohou obsahovat podrobnější nápovědu, což je indikováno ve
spodním řádku obrazovky textem "F1 nápověda".

Chybové hlášky jsou přesměrovány na čtvrtou konzolu (známou jako tty4). Do této
konzoly se můžete přepnout klávesami Levý Alt+F4 (držte levou klávesu Alt a
stiskněte funkční klávesu F4). Zpět do instalačního programu se vrátíte stiskem
Levý Alt+F1.

Hlášky ze třetí konzoly se také ukládají do souboru /var/log/syslog. Po
instalaci jej naleznete v novém systému pod jménem /var/log/installer/syslog.
Další hlášky instalace můžete najít v adresáři /var/log/, nebo po instalaci ve
/var/log/installer/.

6.1.1. Používání grafického instalátoru

Grafický instalátor pracuje úplně stejně jako instalátor textový a tedy můžete
pro instalaci plně využít informací sepsaných ve zbytku příručky.

Preferujete-li ovládání pomocí klávesnice, měli byste vědět dvě věci. Pro
rozbalení/sbalení seznamu (např. při výběru kontinentů a zemí) můžete použít
klávesy + a -. U otázek, kde můžete vybrat více než jednu možnost (např. výběr
úloh), musíte pro pokračování dále nejprve přeskákat tabulátorem na tlačítko 
Pokračovat a poté stisknout Enter. Pokud byste stiskli Enter rovnou, změnili
byste výběr položky, ale na tlačítko Pokračovat by to nemělo žádný vliv.

Pokud dialog obsahuje další nápovědu, zobrazí se tlačítko Nápověda. Kromě
aktivování tlačítka (myší nebo klávesnicí) můžete nápovědu vyvolat také
klávesou F1.

Pro přepnutí do jiné konzoly musíte kromě Levého Altu a funkční klávesy
stisknout i klávesu Ctrl, stejně jako v systému X Window. Například pro
přepnutí do druhého virtuálního terminálu (kde běží ladicí shell) byste
použili: Ctrl+Levý Alt+F2. Grafická instalace běží na pátém virtuálním
terminálu, takže pro přepnutí zpět můžete použít klávesovou kombinaci Levý Alt+
F2.

6.2. Úvod do komponent

V následujícím seznamu komponent instalačního programu je uveden pouze stručný
popis komponenty. Detaily použití konkrétní komponenty jsou v 6.3 - "Použití
jednotlivých komponent".

main-menu

    Zobrazuje seznam komponent, které můžete spustit. Hlavní menu má prioritu "
    normální", takže se nezobrazí při "vysoké" (přednastaveno) nebo "kritické"
    prioritě. Pokud se vyskytne problém, který vyžaduje zásah uživatele, je
    priorita otázek dočasně snížena a objeví se menu, ve kterém můžete problém
    odstranit.

    Zpět do menu se můžete dostat opakovaným stiskem tlačítka Jít zpět.

localechooser

    Umožní uživateli výběr jazyka, země a národního prostředí, které se použijí
    jak během instalace, tak v novém systému. Za předpokladu, že je překlad
    kompletní, bude instalační program zobrazovat zprávy ve vybraném jazyce.
    Pokud není, některé texty se zobrazí anglicky.

console-setup

    Zobrazí seznam klávesnic, ze kterých si můžete vybrat nejvhodnější model
    odpovídající připojené klávesnici.

hw-detect

    Automaticky rozpozná většinu zařízení připojených k počítači (síťové karty,
    pevné disky, PCMCIA).

cdrom-detect

    Vyhledá a připojí instalační CD Debianu.

netcfg

    Nastaví síťová připojení, aby se mohl zbytek systému instalovat ze sítě.

iso-scan

    Hledá souborové systémy ISO-9660, které se nachází na pevném disku v podobě
    ISO obrazů.

choose-mirror

    Předloží seznam zrcadel s debianími archivy, ze kterého si můžete vybrat,
    odkud se balíky stáhnou.

cdrom-checker

    Zkontroluje integritu CD-ROM. Takto si můžete ověřit, že instalační CD-ROM
    nejsou poškozená.

lowmem

    Lowmem se snaží rozpoznat systémy s malou operační pamětí a poté se v
    určitých okamžicích snaží z paměti odstranit nepotřebné části
    debian-installeru. Poznamenejme, že to provádí na úkor funkčnosti
    instalačního programu.

anna

    Anna's Not Nearly APT, tedy v češtině Anna není ani zdaleka jako APT,
    instaluje stažené balíky.

user-setup

    Nastaví heslo uživatele root a vytvoří neprivilegovaného uživatele pro
    běžnou práci.

clock-setup

    Aktualizuje systémové hodiny a určí, zda jsou nastaveny na univerzální
    koordinovaný čas.

tzsetup

    Podle dříve zvolené kombinace jazyk/země nastaví časové pásmo.

partman

    Umožní vám rozdělit disky připojené k systému, vytvořit souborové systémy
    na vybraných oblastech a svázat je s přípojnými body. Součástí programu je
    i možnost automatického rozdělení disku, nebo podpora pro LVM. Partman je
    nyní v Debianu upřednostňovaným dělicím programem.

partitioner

    Umožní vám rozdělit disky připojené k systému. Pro dělení se vybere program
    dle architektury vašeho počítače.

partconf

    Zobrazí seznam oblastí a podle vašich pokynů na nich vytvoří souborové
    systémy.

lvmcfg

    Pomůže s nastavením LVM (Logical Volume Manager, tedy česky manažer
    logických svazků).

mdcfg

    Umožní vám nastavit softwarový RAID (Redundant Array of Inexpensive Disks).
    Tento softwarový RAID bývá obvykle lepší než levné (pseudohardwarové) RAID
    řadiče na novějších základních deskách.

base-installer

    Nainstaluje základní množinu balíků, které jsou potřeba pro samostatný běh
    Debianu.

apt-setup

    Nastaví apt, což se většinou děje automaticky na základě média, ze kterého
    je spuštěn instalační systém.

pkgsel

    Umožní vybrat a nainstalovat dodatečný software pomocí nástroje tasksel.

os-prober

    Umí rozpoznat operační systémy nainstalované na počítači. Tuto informaci
    pak předá následující komponentě (bootloader-installer), která vám může
    nabídnout možnost přidat objevené operační systémy do startovacího menu
    zavaděče. Takto si můžete při startu počítače vybrat, který operační systém
    chcete zavést.

bootloader-installer

    Nainstaluje na disk některý z dostupných zavaděčů. Tento krok je důležitý,
    protože bez něj byste museli Debian zavádět z diskety nebo CD-ROM. Mnoho
    zavaděčů vám při startu nabídne možnost zavést i jiné operační systémy.

shell

    Umožní vám spustit shell (buď z menu, nebo na druhé konzoli).

save-logs

    Umí na disketu, síť, pevný disk nebo jiné médium uložit informace, které se
    vám mohou hodit při analyzování případného problému.

6.3. Použití jednotlivých komponent

V této části podrobně popíšeme každou komponentu instalačního programu.
Komponenty jsou seskupeny do celků podle kontextu, ve kterém se během instalace
vyskytují. Poznamenejme, že při instalaci se nemusí vždy využít všechny
komponenty -- to závisí na způsobu instalace a na dostupném hardwaru.

6.3.1. Nastavení instalačního programu a rozpoznání hardwaru

Předpokládejme, že debian-installer úspěšně nastartoval a nyní se díváte na
jeho první obrazovku. V tento okamžik je debian-installer ještě poměrně hloupý
a nepoužitelný. Neví nic o hardwaru vašeho počítače, nezná váš preferovaný
jazyk a dokonce ani netuší, jaký úkol mu byl přidělen. Ale nebojte se. Jako
správný průzkumník začne debian-installer zkoumat své okolí a po nějaké době
bude mít slušný přehled o okolním hardwaru. Poté se pokusí nalézt zbytek svých
komponent a sám sebe přemění ve schopný, dobře vychovaný program. Bohužel,
stále existují věci, se kterými si debian-installer nedokáže poradit a proto mu
musíte trošku pomoci (například vybrat jazyk, ve kterém má instalace probíhat,
odsouhlasit rozložení klávesnice a podobně).

Během této fáze si jistě všimnete, že debian-installer několikrát rozpoznává
hardware. Poprvé je úzce zaměřen na hardware, který by mohl obsahovat další
části instalačního programu, tj. CD mechaniky nebo síťové karty. Další
rozpoznávání hardwaru probíhá později, když se hledají pevné disky, protože
před prvním rozpoznáváním ještě nemusí být k dispozici všechny ovladače.

Při rozpoznávání hardwaru si debian-installer kontroluje, zda ovladače pro
nalezený hardware vyžadují zavedeni firmwaru. Jestliže požadovaný firmware není
dostupný, zobrazí se nabídka na jeho nahrání z výměnného média. Podrobnosti
naleznete v části 6.4 - "Nahrání chybějícího firmwaru".

6.3.1.1. Kontrola dostupné paměti / nízkopaměťový režim

Jednou z prvních věcí, které debian-installer zkontroluje, je velikost operační
paměti. Pokud má váš systém málo paměti, tak se tato komponenta pokusí provést
změny v instalačním procesu tak, aby byla instalace možná i na tomto počítači.

Prvním krokem ke snížení paměťové náročnosti je vyhození všech překladů, což
znamená že instalace bude probíhat pouze v angličtině. Samozřejmě, že po
dokončení instalace si můžete systém lokalizovat dle potřeb (viz Lokalizace
Debianu).

Pokud to nestačí, instalace přejde na dietu, při které nahraje pouze ty
komponenty, které jsou nezbytné pro dokončení základní instalace. Tím se o něco
sníží funkčnost systému. Sice budete mít možnost nahrát dodatečné komponenty
ručně, ale mějte na paměti, že každá komponenta znamená další paměť a proto se
může stát, že instalace selže.

Když instalace probíhá v nízkopaměťovém režimu, je doporučeno vytvořit
odkládací oblast o velikosti nejméně (64-128 MB). Odkládací oblast se použije
jako virtuální paměť a tedy zvýší množství dostupné paměti. Instalační systém
se pokusí aktivovat odkládací oblast co nejdříve. Intenzivní využívání
odkládací oblasti výrazně zvýší diskovou aktivitu a sníží výkon celého systému.

I přes tato opatření je možné, že instalace zamrzne, nebo že jádro odstřelí
některé procesy, protože systému dojde paměť (v syslogu a na 4. konzoli by se
to mělo projevit hláškami Out of memory).

Například máme zprávu, že při nedostatku paměti a odkládacího prostoru selže
vytváření velkého souborového systému typu ext3. Pokud nepomůže zvětšení
odkládacího prostoru, můžete zkusit vytvořit souborový systém jako ext2 a
později po instalaci oblast převést na ext3.

Důraznější nízkopaměťový režim lze vynutit i v případech, kdy by podle dostupné
paměti měla fungovat jeho mírnější varianta nebo dokonce i běžná instalace.
Stačí použít parametr "lowmem", jak popisuje část 5.3.2 - "Parametry
instalačního programu".

6.3.1.2. Výběr místního prostředí

První uživateli viditelný krok instalace slouží k výběru národního prostředí,
které se použije jak během instalace, tak později v novém systému. Nastavení se
skládá z výběru jazyka, geografického umístění a tzv. locales.

Nejprve se tedy zobrazí seznam dostupných jazyků, ze kterého si vyberete jazyk,
ve kterém má instalace probíhat^[8]. Jednotlivé položky v seznamu se skládají z
anglického názvu (vlevo) a lokálního názvu v daném jazyce (napravo). Pro
češtinu vypadá záznam nějak takto:

Czech       -      Čeština

Některé jazyky mají k dispozici více variant (např. portugalská a brazilská
portugalština). Seznam je seřazen abecedně podle levého sloupce (anglických
názvů). Drobnou výjimkou z řazení je položka "C" na počátku seznamu.

Poznámka

Vyberete-li ze seznamu položku "C", bude instalace pokračovat v angličtině a
instalovaný systém nebude mít podporu pro národní prostředí, protože se
nenainstaluje balík locales. Tato volba může být zajímavá pro některé správce,
kteří tvrdí, že lokalizace nemá na serveru co dělat.

Zvolíte-li jazyk, který je veden jako oficiální v několika zemích^[9], budete v
další otázce dotázáni na výběr konkrétní země. Pokud vám nabídnutý seznam zemí
nebude vyhovovat, můžete zvolit položku Jiná, což vám nabídne seznam
kontinentů. Po výběru kontinentu se zobrazí seznam zemí, které se na něm
nachází.

Jestliže je s jazykem svázána pouze jediná země, bude automaticky předvybrána,
ale nic vám nebrání si výše popsaným způsobem zvolit zemi, ve které se právě
nacházíte, nebo ve které skutečně žijete.

Proč je výběr geografického umístění tak důležitý? Protože se tato odpověď
použije později v instalaci pro výběr výchozího časového pásma a také pro výběr
vhodného síťového zrcadla s archivem Debianu, které by mělo ležet co nejblíže.
Správné nastavení země může hrát i drobnou roli při výběru klávesnice.

Na základě zvolené kombinace jazyka a umístění se vytvoří výchozí místní
prostředí (locale). Pokud pro takové prostředí neexistuje definiční soubor,
zobrazí se nabídka všech dostupných prostředí pro daný jazyk a budete vyzváni k
výběru jednoho z nich.

Všechna prostředí automaticky používají jako výchozí kódování UTF-8.

Instalujete-li s nízkou prioritou otázek, bude vám nabídnuta možnost výběru
dodatečných prostředí (nezávislých na předchozí volbě jazyka a umístění) a také
možnost instalace zastaralých prostředí^[10]. Jestliže vyberete více prostředí,
budete ještě dotázáni, které z nich se má použít jako výchozí.

6.3.1.3. Výběr klávesnice

Klávesnice bývají obvykle přizpůsobeny znakům používaným v daném jazyce.
Vyberte klávesnici, která odpovídá vašemu národnímu rozložení, nebo je alespoň
velmi podobná. Po skončení instalace si můžete vybrat vhodné klávesové
rozložení z mnohem většího spektra (jako uživatel root spusťte příkaz 
dpkg-reconfigure keyboard-configuration).

Šipkami přesuňte kurzor na vybrané klávesové rozložení a stiskněte Enter.
(Šipky by měly být na všech klávesnicích na stejném místě, takže jsou nezávislé
na zvoleném rozložení.)

6.3.1.4. Hledání instalačního ISO obrazu

Při instalaci metodou hd-media nastane okamžik, kdy budete muset instalační
program navést k ISO obrazu instalačního systému Debianu, na kterém se nachází
zbytek instalačních souborů. Abyste obraz nemuseli hledat ručně, pomůže vám s
tímto úkolem komponenta iso-scan.

iso-scan nejprve připojí všechna bloková zařízení (např. diskové oblasti), na
kterých se nachází známý souborový systém a poté na nich hledá soubory končící
příponou .iso (resp. .ISO). Po nalezení každého iso obrazu si iso-scan
zkontroluje jeho obsah a zjistí, zda se jedná o planý obraz instalačního CD.
Pokud ano, máme vyhráno a instalace může pokračovat. V opačném případě se hledá
další obraz. Pokud toto hledání neuspěje, ještě není vše ztraceno. První pokus
totiž kvůli rychlosti prohledává pouze kořenový adresář a první úroveň jeho
podadresářů. Tzn. nalezne /cokoliv.iso, /data/cokoliv.iso, ale ne /data/tmp/
cokoliv.iso.

Selhalo-li tedy první hledání, iso-scan se zeptá, zda chcete spustit
důkladnější proces. Tento druhý pokus se nedívá pouze do nejvyšších adresářů,
ale opravdu prohledá celý disk.

Pokud iso-scan neuspěje ani na druhý pokus, vraťte se zpět do původního
operačního systému a zkontrolujte, zda má soubor správnou příponu (končící na
.iso), zda je umístěn na souborovém systému, který umí debian-installer
rozpoznat a zda není iso obraz poškozený (zkontrolujte kontrolní součet).
Zkušenější unixoví uživatelé mohou vše provést bez restartu počítače na druhé
konzoli.

6.3.1.5. Nastavení sítě

Pokud na začátku toho kroku instalátor zjistí, že máte více síťových rozhraní,
budete si muset vybrat jedno, které použijete jako hlavní, tj. to, ze kterého
budete instalovat. Zbylá rozhraní zůstanou nenastavena a budete je muset
nastavit po skončení instalace ručně -- viz manuálová stránka interfaces(5).

6.3.1.5.1. Automatické nastavení sítě

Implicitně se debian-installer snaží nastavit síť automaticky přes DHCP. Pokud
DHCP uspěje, vše je nastaveno. Jestliže DHCP skončí s chybou, může být příčina
téměř kdekoliv -- od vypojeného síťového kabelu až po špatně nastaveného DHCP
démona. Také je možné, že na místní síti vůbec DHCP server nemáte. K
přesnějšímu určení problému možná pomohou chybové hlášky na čtvrté konzoli. Ať
už je chyba kdekoliv, budete dotázáni, zda chcete znovu zkusit DHCP, nebo zda
nastavíte síť ručně. DHCP servery jsou někdy docela pomalé, takže pokud jste si
jisti, že vše ostatní je v pořádku, klidně to zkuste znovu. Jestliže
automatické nastavení selhává opakovaně, zvolte ruční nastavení sítě.

6.3.1.5.2. Ruční nastavení sítě

Při ručním nastavení sítě vás netcfg vyzve k zadání údajů z 3.3 - "Dále budete
potřebovat" (IP adresa, Síťová maska, Brána, Adresy jmenných serverů a Název
počítače). Pokud k instalaci používáte bezdrátové připojení, budete dotázáni
ještě na Bezdrátové ESSID (název bezdrátové sítě) a WEP klíč nebo přístupovou
frázi WPA/WPA2.

Poznámka

Pár technických poznámek: program předpokládá, že adresa vaší sítě je bitovým
součinem IP adresy a síťové masky. Výchozí vysílací adresu spočítá jako bitový
součet IP adresy systému a bitového doplňku síťové masky. Program se také
pokusí odhadnout adresu brány. Pokud některý údaj nebudete znát, ponechte u něj
přednastavenou hodnotu. Konfiguraci můžete na nainstalovaném systému upravit v
souboru /etc/network/interfaces.

6.3.1.5.3. IPv4 a IPv6

debian-installer od verze 7.0 ("Wheezy") podporuje kromě "tradičního" síťového
protokolu IPv4 též protokol IPv6. Podporovány jsou všechny kombinace: samotné
IPv4, samotné IPv6, i smíšené nastavení.

Automatické nastavení sítě se v případě IPv4 děje prostřednictvím DHCP (Dynamic
Host Configuration Protocol). Automatické nastavení IPv6 podporuje bezstavové
nastavení pomocí NDP (Neighbor Discovery Protocol - včetně přiřazení
rekurzivního DNS serveru (RDNSS)), stavové nastavení přes DHCPv6 i smíšené
stavové/bezstavové nastavení (přiřazení adresy přes NDP, získání dalších
parametrů přes DHCPv6).

6.3.1.6. Výběr síťového zrcadla

Tato komponenta se spustí pouze v případě, že instalační program potřebuje
nahrát své další komponenty nebo základní systém ze sítě.

Nejprve se zobrazí seznam zemí se zrcadly Debianu, přičemž předvolena bude
země, kterou jste vybrali na začátku instalace.

  • Po výběru země se nabídne seznam zrcadel v dané zemi. Dobrou volbou bývají 
    "hlavní" zrcadla, která mají tvar ftp.kód_země.debian.org.

  • Pokud nechcete použít oficiální zrcadlo, vyberte v seznamu zemí možnost
    zadat informace ručně. Budete dotázáni na jméno počítače, ze kterého se
    mají části Debianu stáhnout.

    Zajímavou volbou může být zrcadlo httpredir.debian.org, což je ve
    skutečnosti jen alias na jedno z oficiálních zrcadel, které by vám zrovna
    mělo být nejblíže.

Další otázka se bude ptát na nastavení proxy serveru. Proxy server slouží jako
prostředník mezi vámi a Internetem -- místo abyste se obrátili přímo na server
v Internetu, komunikujete se svým proxy serverem. Proxy server předává vaše
dotazy cílovému serveru v Internetu, vyzvedne od něj odpověď a tu pak předá
vašemu počítači. Většina domácích uživatelů zde nemusí nastavovat nic, proxy
server se obvykle vyskytuje jako součást firewallu pro větší nebo podnikové
sítě.

Na závěr se zvolené zrcadlo otestuje a automaticky se z něj stáhnou potřebné
balíky. Pokud se vyskytne problém (server není dostupný, neobsahuje zvolenou
verzi Debianu, apod.), můžete si ze seznamu vybrat jiné zrcadlo^[11], případně
zkusit jiné nastavení proxy serveru.

6.3.1.7. Nastavení hodin a časového pásma

Instalační systém se nejprve pokusí získat přesný čas z některého časového
serveru na Internetu (protokolem NTP). Pokud se to nepovede, bude
debian-installer předpokládat, že čas získaný ze systémových hodin při zavádění
instalace je správný. Během instalace není možné nastavit čas ručně.

Podle země vybrané na začátku instalace se může zobrazit seznam časových pásem
dostupných v daném místě. Existuje-li pro zadané místo pouze jediné časové
pásmo, otázka se nezobrazí.

Instalujete-li v expertním režimu, nebo pokud snížíte prioritu otázek na
střední, budete moci navíc zvolit časové pásmo UTC (Univerzální koordinovaný
čas).

Pokud z nějakého důvodu chcete pro instalovaný systém použít časové pásmo,
které neodpovídá zvolenému místu, máte dvě možnosti.

 1. Nejjednodušší možností je počkat s výběrem jiného časové pásma až po
    dokončení instalace. V nainstalovaném systému pak stačí spustit příkaz:

    # dpkg-reconfigure tzdata

 2. Alternativně můžete zadat časové pásmo na úplném začátku instalace přidáním
    zaváděcího parametru time/zone=hodnota, kde hodnota by mělo být platné
    časové pásmo, například Europe/Prague nebo UTC.

Pro automatizované instalace můžete požadované časové pásmo nastavit také
pomocí přednastavení (viz dodatek B - "Automatizování instalací pomocí
přednastavení", přesněji část B.4.6 - "Nastavení hodin a časového pásma").

6.3.2. Nastavení uživatelů a hesel

Těsně před nastavením hodin vám instalační systém umožní nastavit účet "root" a
/nebo účet pro prvního uživatele. Další uživatelské účty můžete vytvořit po
dokončení instalace.

6.3.2.1. Nastavení rootova hesla

Účet root je účtem pro superuživatele, na kterého se nevztahují bezpečnostní
omezení. Měli byste ho používat pouze, když provádíte správu systému, a jen na
dobu nezbytně nutnou.

Uživatelská hesla by měla být sestavena z alespoň 6 písmen, obsahovat malá a
velká písmena včetně dalších znaků (jako ; . ,). Speciální pozornost věnujte
výběru hesla pro roota, protože je to velmi mocný účet. Vyhněte se slovům ze
slovníků, jménům oblíbených postav, jakýmkoliv osobním údajům, prostě
čemukoliv, co se dá lehce uhodnout.

Jestliže vám někdo bude tvrdit, že potřebuje heslo vašeho rootovského účtu,
buďte velice ostražití. V žádném případě byste neměli toto heslo prozrazovat!
Jedině snad, že daný stroj spravuje více spolu-administrátorů.

Jestliže heslo pro uživatele root nezadáte, bude tento účet neaktivní. Aby bylo
možné nový systém spravovat, později se při instalaci automaticky nainstaluje
nástroj sudo, pomocí kterého bude moci první vytvořený uživatel získat
oprávnění uživatele root.

6.3.2.2. Vytvoření uživatelského účtu

Systém se zeptá, zda nyní chcete vytvořit uživatelský účet. (Účet je právo k
používání počítače, tvoří ho jméno uživatele a jeho heslo). Tento účet byste
měli používat ke každodenní práci. Jak již bylo řečeno, nepoužívejte účet
superuživatele pro běžné úkoly.

Proč ne? Případná chyba by mohla mít katastrofické důsledky a dokonce by si
mohla vyžádat novou instalaci systému. Dalším důvodem je možnost, že vám může
být nastrčen program nazývaný trojský kůň, který zneužije práv, jež jako root
máte, a naruší bezpečnost vašeho systému. Kvalitní knihy o administraci
unixového operačního systému vám jistě podrobněji osvětlí danou problematiku.
Jestliže v Unixu začínáte, uvažte četbu na toto téma.

Postupně budete požádáni o zadání celého jména uživatele, jména uživatelského
účtu a hesla. Jméno uživatelského účtu si můžete vybrat zcela libovolně.
Například, pokud se jmenujete Jan Novák, vytvořte si nový účet jan, jnovak nebo
jn.

Pokud budete chtít vytvořit další účet, můžete to udělat kdykoliv po skončení
instalace programem adduser.

6.3.3. Rozdělení disku a výběr přípojných bodů

Nyní, po posledním rozpoznávání hardwaru, by již měl být debian-installer v
plné síle, přizpůsoben podle uživatelských požadavků a připraven na opravdovou
práci. Jak praví název této části, bude se několik následujících komponent
zabývat rozdělením disků, vytvořením souborových systémů, přiřazením přípojných
bodů a volitelně nastavením souvisejících záležitostí, jako jsou LVM, RAID a
šifrovaná zařízení.

Nyní nastal čas rozdělit pevné disky. Pokud se při dělení disků zrovna necítíte
silní v kramflecích, nebo pokud chcete o rozdělování disků dozvědět více,
podívejte se do dodatku C - "Poznámky k rozdělování disku".

Nejprve vám bude nabídnuta možnost automaticky rozdělit buď celý disk, nebo
dostupné volné místo na disku. Tato volba se někdy nazývá "asistované"
rozdělení, protože do dělení můžete sami zasáhnout. Pokud nechcete využít
automatické dělení disku, zvolte z nabídky Ručně.

6.3.3.1. Podporované možnosti dělení disků

Nástroj pro dělení disků v debian-installeru je poměrně všestranný. Umožňuje
vytvářet mnoho různých schémat dělení disků, používat různé tabulky oblastí,
souborové systémy a pokročilá bloková zařízení.

Konkrétní dostupné možnosti závisí převážně na architektuře instalovaného
počítače, ale také na dalších faktorech, jako je velikost operační paměti (při
nedostatku operační paměti nemusí být některé možnosti k dispozici). Lišit se
mohou také výchozí hodnoty. Například typ tabulky rozdělení disku může být
různý pro menší a větší disky. Některé možnosti je možno změnit jen při
instalaci se střední nebo nízkou prioritou otázek. Při vyšších prioritách se
použijí výchozí hodnoty.

Instalační systém umožňuje použít různé druhy pokročilého dělení disku a
zajímavých úložných zařízení, často i kombinovaně.

  • Logical Volume Management (LVM)

  • Softwarový RAID

    Podporovány jsou RAID úrovně 0, 1, 4, 5, 6 a 10.

  • Šifrování

  • Serial ATA RAID (pomocí dmraid)

    Taktéž nazývaný "falešný RAID" nebo "BIOS RAID". Podpora pro Serial ATA
    RAID je dostupná pouze pokud ji povolíte při zavádění instalačního systému.
    Více informací naleznete na naší Wiki.

  • Multipath (experimentální)

    Podpora pro multipath je dostupná pouze pokud ji povolíte při zavádění
    instalačního systému. Více informací naleznete na naší Wiki.

Podporovány jsou následující souborové systémy.

  • ext2, ext3, ext4

    Výchozí souborový systém je ve většině případů ext4. Při použití
    automatického dělení se pro /boot oblast implicitně použije ext2.

  • jfs (není dostupný na všech architekturách)

  • xfs (není dostupný na všech architekturách)

  • reiserfs (volitelný, není dostupný na všech architekturách)

    Podpora pro souborový systém Reiser již není dostupná automaticky, ale
    můžete ji povolit při spuštění instalace se střední nebo nízkou úrovní
    otázek tak, že necháte nahrát komponentu partman-reiserfs. Podporována je
    pouze verze 3.

  • qnx4

    Stávající souborové systémy budou rozpoznány a je možné jim přiřadit
    přípojné body, ale není možné vytvářet nové souborové systémy tohoto typu.

  • FAT16, FAT32

  • NTFS (jen pro čtení)

    U stávajících souborových systémů NTFS je možné změnit jejich velikost a je
    možné jim přiřadit přípojné body, ale není možné vytvářet nové souborové
    systémy tohoto typu.

6.3.3.2. Asistované dělení

Zvolíte-li automatické rozdělování, měli byste mít na výběr několik možností:
vytvořit oblasti přímo na disku (klasický způsob), použít Logical Volume
Management (LVM), nebo použít šifrované LVM^[12]. Ve druhém a třetím případě
vytvoří instalátor většinu oblastí uvnitř jedné veliké; výhoda je ta, že
oblasti uvnitř této veliké oblasti pak můžete relativně jednoduše zvětšovat a
případně zmenšovat. U šifrovaného LVM bude tato veliká oblast šifrovaná a pro
přístup k datům na ní uloženým budete muset znát přístupovou frázi. Šifrované
LVM má ještě jednu výhodu, a to tu, že před použitím se celá oblast přepíše
náhodnými daty, takže nebude možné rozeznat, které části oblasti se aktivně
používají, a také tím zrušíte stopy po předchozích instalacích. Musíte však
počítat s tím, že mazání zabere určitý čas, který může být u větších oblastí
docela značný.

Poznámka

(Šifrované) LVM nemusí být k dispozici na všech architekturách.

Poznámka

Při automatickém rozdělení pomocí LVM (nebo šifrovaného LVM), se budou muset na
zvolený disk zapsat některé změny provedené v tabulce oblastí. Tyto změny z
disku efektivně smažou všechna stávající data a tento krok nebudete moci vrátit
zpět. Před samotným zápisem však budete pro jistotu dotázáni.

Pokračujete-li v automatickém rozdělování (klasickém nebo LVM) celého disku,
budete nejprve požádáni, abyste vybrali disk, který chcete použít. Máte-li více
disků, dejte dobrý pozor, který disk zvolíte, protože pořadí, ve kterém jsou
vypsány, se může lišit od toho, na které jste zvyklí. V identifikaci disků může
pomoci i jejich velikost. Dále si budete moci vybrat z několika připravených
schémat rozdělení disku (viz tabulka níže). Všechny možnosti mají svá pro a
proti, některé argumenty jsou zmíněny v dodatku C - "Poznámky k rozdělování
disku". Pokud si nejste jisti, zvolte první možnost. Pamatujte však, že
asistované dělení vyžaduje určitou minimální velikost volného místa, se kterým
může pracovat. Nemáte-li k dispozici zhruba 1GB volného místa (závisí na
zvoleném způsobu dělení), asistované dělení selže.

┌─────────────────────────────────────┬──────────────┬────────────────────────┐
│            Způsob dělení            │  Minimální   │   Vytvořené oblasti    │
│                                     │    místo     │                        │
├─────────────────────────────────────┼──────────────┼────────────────────────┤
│Všechny soubory v jedné oblasti      │600MB         │/, swap                 │
├─────────────────────────────────────┼──────────────┼────────────────────────┤
│Samostatná oblast pro /home          │500MB         │/, /home, swap          │
├─────────────────────────────────────┼──────────────┼────────────────────────┤
│Samostatné oblasti pro /home, /var a │1GB           │/, /home, /var, /tmp,   │
│/tmp                                 │              │swap                    │
└─────────────────────────────────────┴──────────────┴────────────────────────┘

Pokud jste zvolili automatické rozdělení pomocí (šifrovaného) LVM, vytvoří se
také malá oblast pro /boot. Ostatní oblasti, včetně odkládací, budou vytvořeny
uvnitř LVM.

Jestliže jste instalaci na architektuře 32-bit PC zavedli v režimu EFI, pak se
při automatickém rozdělení disku vytvoří malá zaváděcí oblast pro zavaděč EFI,
formátovaná souborovým systémem FAT32. Tato oblast je známá jako "EFI System
Partition (ESP)". Při ručním dělení disku přibude ve formátovacím menu položka 
Použít oblast jako: systémová oblast EFI.

Na další obrazovce se zobrazí tabulka rozdělení disku(ů) společně s informacemi
o souborových systémech a přípojných bodech. Seznam oblastí může vypadat třeba
takto:

  SCSI1 (0,0,0) (sda) - 6.4 GB WDC AC36400L
       1. primární   32.4 MB  B f ext2       /boot
       2. primární  551.0 MB      swap       swap
       3. primární    5.8 GB      ntfs
          pri/log     8.2 MB      VOLNÉ MÍSTO

  SCSI2 (1,0,0) (hdb) - 80.0 GB ST380021A
       1. primární   15.9 MB      ext3
       2. primární  996.0 MB      fat16
       3. primární    3.9 GB      xfs        /home
       5. logická     6.0 GB    f ext4       /
       6. logická     1.0 GB    f ext4       /var
       7. logická   498.8 MB      ext3
       8. logická   551.5 MB    f swap       swap
       9. logická    65.8 GB      ext3

Jak je vidět, v počítači jsou dva pevné disky rozdělené na několik oblastí.
Každý řádek popisující oblast zobrazuje její pořadí, typ, velikost, volitelné
příznaky, souborový systém a (pokud existuje) přípojný bod. Na prvním disku je
ještě kousek volného místa.

Tímto je automatické rozdělení disků u konce. Pokud jste s navrženým rozdělením
spokojeni, stačí z nabídky vybrat Ukončit rozdělování. V opačném případě můžete
zvolit možnost Vrátit zpět změny provedené na oblastech a znovu spustit
automatické rozdělování, případně podle návodu níže ručně doladit změny v
navrhovaném rozdělení disku.

6.3.3.3. Ruční dělení

Zvolíte-li ruční rozdělení disků, objeví se podobná obrazovka jako o dva
odstavce výše, ale zatím nebude mít přiřazeny přípojné body.

Pokud chcete v tabulce něco změnit, vyberte ze seznamu objekt, který chcete
upravit a stiskněte Enter. Objektem je míněn disk, oblast nebo volné místo. S
každým objektem můžete provádět různé akce.

Jestliže vyberete dosud nedotčený disk, na kterém nejsou ani oblasti ani volné
místo, bude vám nabídnuta možnost vytvoření nové tabulky oblastí (to je nutné k
tomu, abyste mohli vytvářet oblasti). Po této akci se pod vybraným diskem
zobrazí řádka nadepsaná "VOLNÉ MÍSTO".

Vyberete-li volné místo, partman vám nabídne vytvoření nové oblasti. Nejprve
musíte odpovědět několik základních otázek jako velikost nové oblasti, typ
(primární nebo logická) a umístění (na začátku nebo na konci volného místa).
Poté se zobrazí detailní pohled na novou oblast. Naleznete zde položky jako
přípojný bod, volby připojení, zaváděcí příznak nebo způsob použití. Pokud vám
nevyhovují přednastavené hodnoty, můžete je upravit dle libosti. Nejdůležitější
volbou Použít jako: můžete změnit souborový systém dané oblasti včetně možnosti
použít oblast jako odkládací prostor, softwarový RAID, LVM nebo ji nepoužít
vůbec. Až budete s oblastí spokojeni, vyberte položku Skončit s nastavováním
oblasti, což vás vrátí zpět do hlavní obrazovky rozdělování disků.

Pokud se rozhodnete, že chcete něco změnit na stávající oblasti, jednoduše ji
vyberte a stiskněte Enter. Ocitnete se ve stejné obrazovce jako při vytváření
nové oblasti a tedy máte i stejné možnosti nastavení. Jedna věc, která nemusí
být na první pohled zcela zřejmá je fakt, že u většiny oblastí můžete změnit
jejich velikost - stačí vybrat položku, která zobrazuje velikost oblasti. Změna
velikosti by měla fungovat minimálně se souborovými systémy fat16, fat32, ext2,
ext3 a swap. Pokud se vám oblast nelíbí, můžete ji z tohoto menu i smazat.

Nezapomeňte vytvořit aspoň dvě oblasti -- jednu pro odkládací prostor ("swap")
a jednu pro kořenový souborový systém (který musí být připojen jako /). Bez
připojeného kořenového souborového systému vám partman nedovolí pokračovat.
Chcete-li s rozdělováním pomoci, můžete kdykoliv z rozdělovacího menu vybrat
možnost Automaticky rozdělit disk nebo Automaticky rozdělit volné místo.

Pokud zavedete instalaci v režimu EFI, ale zapomenete vytvořit a nastavit
systémovou oblast EFI, partman to zjistí a dokud vše nespravíte, nenechá vás
pokračovat.

Jestliže budete ve vytváření své tabulky oblastí příliš kreativní a uvedete ji
do nepoužitelného stavu, můžete se vždy vrátit do výchozího bodu volbou Vrátit
zpět změny provedené na oblastech^[13].

partman samotný je poměrně malý a hloupý program, avšak jeho schopnosti mohou
být rozšiřovány moduly instalačního programu. Pokud tedy nevidíte všechny
slibované vlastnosti, přesvědčte se, že máte nahrány příslušné moduly (např.
partman-ext3, partman-xfs nebo partman-lvm) a že jsou tyto podporovány vaší
architekturou.

Až budete s rozdělením disků hotovi, vyberte z nabídky Ukončit rozdělování a
zapsat změny na disk. Zobrazí se seznam provedených změn a budete požádáni o
potvrzení, zda opravdu chcete vytvořit nové souborové systémy.

6.3.3.4. Nastavení vícediskových zařízení (Softwarový RAID)

Jestliže máte ve svém počítači více než jeden pevný disk^[14], můžete využít
této skutečnosti nastavit disky pro větší výkon a/nebo pro větší bezpečnost
dat. Výsledek se nazývá Vícediskové zařízení - MD (nebo podle své nejznámější
varianty softwarový RAID).

Jednoduše řečeno je MD množina oblastí umístěných na různých discích. Tyto
oblasti se v mdcfg spojí dohromady a vytvoří logické zařízení. Toto zařízení
pak můžete používat jako běžnou oblast (například v partmanu ji můžete
zformátovat, přiřadit jí přípojný bod atd.).

Co vám tato operace přinese, závisí na typu vícediskového zařízení, které
vytváříte. Momentálně jsou podporovány:

RAID0

    Je hlavně zaměřen na rychlost. RAID0 rozdělí všechna příchozí data na
    proužky (stripes) a ty pak rovnoměrně rozmístí na každý disk v poli. To
    může zvýšit rychlost čtení a zápisu, ovšem pokud jeden z disků odejde do
    věčných lovišť, odejdou s ním všechna data (část informace je stále na
    zdravém disku (discích), zbývající část byla na vadném disku).

    Typicky se RAID0 používá pro oblast na stříhání videa.

RAID1

    Je vhodný systémy, kde je spolehlivost na prvním místě. Skládá se z
    několika (obvykle dvou) stejně velkých oblastí, kde každá oblast obsahuje
    naprosto shodná data. Prakticky to znamená tři věci. Za prvé, pokud jeden z
    disků selže, stále máte data zrcadlena na zbývajících discích. Za druhé, k
    dispozici máte pouze část celkové kapacity (přesněji to je velikost
    nejmenší oblasti v poli). Za třetí, pokud se vyskytne větší počet požadavků
    na čtení, mohou se tyto rovnoměrně rozdělit mezi jednotlivé disky, což může
    přinést zajímavé zrychlení u serverů, kde převažují čtecí operace na
    zápisovými.

    Volitelně můžete mít v poli rezervní disk, který se normálně nevyužívá a v
    případě výpadku jednoho z disků okamžitě nahradí jeho místo.

RAID5

    Je rozumným kompromisem mezi rychlostí, spolehlivostí a redundancí dat.
    RAID5, podobně jako RAID0, rozdělí všechna příchozí data na proužky a poté
    je rovnoměrně rozmístí na disky v poli. Oproti RAID0 je zde však podstatný
    rozdíl v tom, že se samotná data zapisují pouze na n - 1 disků. Zbývající n
    . disk nezahálí, ale zapíše se na něj paritní informace. Paritní disk není
    statický (to by se pak jednalo o RAID4), ale pravidelně se posouvá tak, aby
    byly paritní informace rozmístěny rovnoměrně na všech discích v poli. V
    případě výpadku jednoho z disků se může chybějící informace dopočítat ze
    zbývajících dat a jejich parity. RAID5 se musí skládat z alespoň tří
    aktivních zařízení. Volitelně můžete mít v poli rezervní disk, který se
    normálně nevyužívá a v případě výpadku jednoho z disků okamžitě nahradí
    jeho místo.

    Jak je vidět, RAID5 nabízí podobný stupeň spolehlivosti jako RAID1, ovšem
    dosahuje menší míry redundance dat. Čtecí operace budou stejně rychlé jako
    na RAID0, ovšem zápis bude mírně pomalejší kvůli počítání paritních
    informací.

RAID6

    Je podobný jako RAID5, ale používá pro paritní informace dva disky, což
    vede k tomu, že přežije výpadek dvou disků.

RAID10

    RAID10 kombinuje proužky (RAID0) se zrcadlením (RAID1). Vytvoří n kopií
    příchozích dat a rozmístí je po discích tak, že se žádná z kopií nenachází
    na stejném zařízení. Výchozí hodnota n je 2, ale v expertním režimu můžete
    zvolit jinou hodnotu. Počet použitých oblastí musí být nejméně n. RAID10 má
    pro rozmísťování kopií bloků několik algoritmů. Výchozí jsou "blízké kopie"
    , které ukládají kopie bloku na různá zařízení na stejnou pozici. Další
    možností jsou "vzdálené kopie", které ukládají kopie bloků na různá
    zařízení na zcela jinou pozici. Poslední "offsetové kopie" nekopírují
    jednotlivé kopie, ale celé proužky.

    RAID10 se dá použít pro dosažení spolehlivosti a redundance bez nutnosti
    počítat paritu.

Kdybychom měli shrnout podstatné vlastnosti:

┌──────┬─────────┬─────────┬────────────┬─────────────────────────────────────┐
│      │Minimálně│Rezervní │  Přežije   │                                     │
│ Typ  │zařízení │zařízení │  výpadek   │           Dostupné místo            │
│      │         │         │   disku?   │                                     │
├──────┼─────────┼─────────┼────────────┼─────────────────────────────────────┤
│RAID0 │2        │ne       │ne          │velikost nejmenšího zařízení krát    │
│      │         │         │            │počet aktivních zařízení v in RAIDu  │
├──────┼─────────┼─────────┼────────────┼─────────────────────────────────────┤
│RAID1 │2        │volitelně│ano         │velikost nejmenšího zařízení v RAIDu │
├──────┼─────────┼─────────┼────────────┼─────────────────────────────────────┤
│RAID5 │3        │volitelně│ano         │velikost nejmenšího zařízení krát    │
│      │         │         │            │(počet akt. zařízení v RAIDu - 1)    │
├──────┼─────────┼─────────┼────────────┼─────────────────────────────────────┤
│RAID6 │4        │volitelně│ano         │velikost nejmenšího zařízení krát    │
│      │         │         │            │(počet akt. zařízení v RAIDu - 2)    │
├──────┼─────────┼─────────┼────────────┼─────────────────────────────────────┤
│RAID10│2        │volitelně│ano         │součet všech oblastí děleno počet    │
│      │         │         │            │kopií (standardně dvě)               │
└──────┴─────────┴─────────┴────────────┴─────────────────────────────────────┘

Chcete-li se o Softwarovém RAIDu dozvědět více, rozhodně se podívejte na
Software RAID HOWTO.

Pro vytvoření vícediskového zařízení musí být oblasti, ze kterých se má
zařízení skládat, označeny pro použití v RAIDu. (To se provádí v partmanu v
menu Nastavení oblasti, kde byste měli nastavit položku Použít jako: na hodnotu
fyzický svazek pro RAID.)

Poznámka

Při rozdělování disku počítejte s tím, že při použití RAIDu pro kořenový
souborový systém (/) je obvykle potřeba vytvořit samostatnou oblast pro /boot.
Většina zavaděčů (včetně lila a grubu) podporují zrcadlený RAID1 (pozor, ne
RAID0), takže je např. možné použít RAID5 pro / a RAID1 pro /boot.

Na první obrazovce mdcfg jednoduše vyberte Vytvořit MD zařízení. Bude vám
nabídnut seznam podporovaných typů vícediskových zařízení, ze kterého si jeden
vyberte (např. RAID1). Co bude následovat, závisí na typu vybraného zařízení.

  • RAID0 je velmi jednoduchý -- vaším jediným úkolem je vybrat z nabídnutého
    seznamu RAIDových oblastí ty, které budou tvořit pole.

  • RAID1 je trošku složitější. Nejprve musíte zadat počet aktivních a počet
    rezervních zařízení (oblastí), které budou tvořit RAID. Dále musíte ze
    seznamu dostupných RAIDových oblastí vybrat ty, které mají být aktivní a
    poté ty, které mají být rezervní. Počty vybraných oblastí se musí rovnat
    číslům, která jste zadali před chvílí. Pokud uděláte chybu a vyberete jiný
    počet oblastí, nic se neděje -- debian-installer vás nenechá pokračovat,
    dokud vše nespravíte.

  • RAID5 se nastavuje stejně jako RAID1 s drobnou výjimkou -- musíte použít
    nejméně tři aktivní zařízení.

  • RAID5 se nastavuje stejně jako RAID1 s drobnou výjimkou -- musíte použít
    nejméně čtyři aktivní zařízení.

  • Základní nastavení RAID10 je stejné jako u RAID1. V expertním režimu
    debian-installeru budete navíc dotázáni na na rozložení pole. Rozložení se
    skládá ze dvou částí. První část určuje typ rozložení, druhá pak počet
    kopií každého bloku dat. Typ rozložení může být n (pro blízké kopie), f
    (pro vzdálené kopie) nebo o (pro offsetové kopie). Počet kopií musí být
    menší nebo roven počtu zařízení, aby bylo zaručeno, že se každá kopie
    zapíše na jiné zařízení.

Poznamenejme, že můžete používat více typů vícediskových zařízení najednou.
Například pokud máte pro MD vyhrazeny tři 200 GB pevné disky a na každém máte
dvě 100 GB oblasti, můžete z prvních oblastí všech disků sestavit pole RAID0
(rychlá 300 GB oblast pro střih videa) a ze zbývajících tří oblastí (2 aktivní
a 1 rezervní) sestavit RAID1 (rozumně spolehlivá 100 GB oblast pro domovské
adresáře uživatelů).

Až nastavíte vícedisková zařízení podle chuti, můžete ukončit mdcfg a vrátit se
tak do partmanu, kde těmto zařízením přiřadíte obvyklé atributy jako souborové
systémy a přípojné body.

6.3.3.5. Nastavení manažera logických svazků (LVM)

Pracujete-li s počítači na pozici správce systému nebo pokročilého uživatele,
jistě jste zažili situaci, kdy na jedné (zpravidla velmi důležité) oblasti
docházelo volné místo, zatímco jiná oblast jej měla nadbytek. Zpravidla pak
nastoupilo mazání, přesouvání a propojování adresářů přes symbolické odkazy.

Abyste do budoucna předešli popsané situaci, můžete použít manažer logických
svazků (Logical Volume Manager). Co takový manažer dělá? Jednoduše řečeno,
spojí diskové oblasti (v žargonu LVM se nazývají fyzické svazky) do virtuálního
disku (tzv. skupina svazků), který pak můžete rozdělit na virtuální oblasti (
logické svazky). Jak se tyto virtuální oblasti liší od těch fyzických, na
kterých jsou vybudovány? Pointa je v tom, že logické svazky (a samozřejmě pod
nimi ležící skupiny svazků) se mohou rozprostírat přes několik fyzických disků.

Například nyní, když si všimnete, že potřebujete více místa na starší 160
gigabajtové oblasti s domovskými adresáři, můžete jednoduše dokoupit nový 300GB
disk, připojit jej ke stávající skupině svazků a rozšířit logický svazek, který
slouží jako oblast pro /home. Výsledkem bude jedna velká, 460 gigabajtová
oblast, která uživatelům zase chvíli vystačí. Popsaný příklad je samozřejmě
hodně zjednodušený, ale pěkně nastiňuje využití LVM v praxi. Pokud jste jej
ještě nečetli, měli byste si projít LVM HOWTO.

Nastavení LVM v instalačním programu Debianu je poměrně jednoduché a plně
integrované do partmanu. Nejprve musíte označit fyzické oblasti, které mají být
spravovány přes LVM. To se provádí v menu Nastavení oblasti, kde byste měli
nastavit položku Použít jako: na hodnotu fyzický svazek pro LVM.

Po návratu na hlavní obrazovku partmanu uvidíte nové menu Nastavit manažer
logických svazků (LVM). Po jeho výběru budete nejprve dotázáni, abyste
potvrdili všechny dosud neprovedené změny v tabulce oblastí (pokud takové
existují) a vzápětí se objeví konfigurační menu LVM, nad kterým je zobrazen
krátký přehled současného nastavení. Menu samotné je kontextově závislé a
zobrazuje pouze akce použitelné v daný okamžik. Mezi dostupné akce patří:

  • Zobrazit podrobné nastavení, což zobrazí strukturu LVM zařízení včetně jmen
    a velikostí fyzických svazků, logických svazků a samozřejmě skupin svazků.

  • Vytvořit skupinu svazků z dosud nevyužitých fyzických svazků.

  • Zrušit skupinu svazků a uvolnit tak fyzické svazky, ze kterých se skupina
    skládá.

  • Rozšířit skupinu svazků o nevyužité fyzické svazky.

  • Zmenšit skupinu svazků o některé fyzické svazky a tudíž je dát k dispozici
    jiným skupinám, nebo z nich v partmanu udělat "běžné" oblasti.

  • Vytvořit logický svazek z volného místa ve skupině svazků.

  • Zrušit logický svazek ve skupině svazků.

  • Skončit, čímž se vrátíte zpět do hlavního rozdělovacího menu.

Poznámka

Při vytváření skupiny svazků nebo logického svazku budete požádáni o zadání
jejich názvu. Tyto názvy by měly být krátké a výstižné, protože v běžícím
systému se podle těchto názvů vytvoří nová bloková zařízení v adresáři /dev/,
která se budou používat pro přímý přístup k daným logickým svazkům. Tedy tam,
kde by se běžně použilo např. /dev/hda3 se nyní použije /dev/mapper/
jmskupiny-jmsvazku. (Pěkně to bude vidět v souboru /etc/fstab nebo na výstupu
příkazů mount a df.)

Až budete s nastavením LVM spokojeni, vraťte se zpět do partmanu, kde uvidíte
všechny vytvořené logické svazky. Logické svazky se chovají jako obyčejné
oblasti, tudíž už asi víte, co s nimi máte dělat.^[15]

6.3.3.6. Nastavení šifrovaných svazků

debian-installer umožňuje nastavit šifrované oblasti. Každý soubor, který na
takovou oblast zapíšete, je na disk zapsán v šifrované podobě. Přístup k
šifrovaným datům je povolen pouze po zadání přístupové fráze, kterou si zvolíte
při vytváření šifrované oblasti. Takto můžete chránit citlivá data v případě,
že někdo ukradne váš přenosný počítač nebo pevný disk. Zloděj sice získá
fyzický přístup k pevnému disku, ale bez znalosti přístupové fráze budou
šifrovaná data na disku vypadat jako změť náhodných znaků.

Největší smysl má šifrování oblasti s domovskými adresáři, kde se nachází vaše
soukromá data, a oblasti s odkládacím prostorem, kde se mohou dočasně ocitnout
citlivá data z operační paměti. Samozřejmě vám nic nebrání šifrovat libovolnou
jinou oblast, například /var, kam si ukládají databázové servery své databáze,
poštovní servery poštu, tiskové servery frontu úloh, nebo třeba adresář /tmp,
kde se mohou nacházet potenciálně zajímavá data (dočasné pracovní kopie vašich
dokumentů). Existují i lidé, kteří si šifrují celý systém. Jedinou výjimkou,
která musí zůstat nešifrovaná, je oblast obsahující /boot, protože momentálně
neexistuje způsob, jak zavést jádro ze šifrované oblasti.

Poznámka

Rychlost čtení/zápisu ze šifrovaných oblastí bude o něco nižší než rychlost na
nešifrovaných oblastech, protože se data musí odšifrovat/zašifrovat při každém
čtení a zápisu. Konkrétní vliv na rychlost závisí na výkonu procesoru, zvolené
šifře a délce klíče.

Abyste mohli využívat šifrování, musíte vybrat stávající oblast, což může být
běžná oblast, logický svazek LVM nebo svazek RAID. (Pokud ještě oblast
neexistuje, musíte ji nejprve vytvořit z dostupného volného místa.) V menu pro
nastavení oblasti nastavte možnost Použít jako: na hodnotu fyzický svazek pro
šifrování. Zbytek menu se poté změní a bude obsahovat několik kryptografických
nastavení pro danou oblast.

debian-installer podporuje šifrování pomocí dm-crypt (součástí novějších
linuxových jader, schopný hostit fyzické svazky pro LVM).

Podívejme na možnosti, které jsou k dispozici, pro šifrování přes Device-mapper
(dm-crypt). Pokud jste na pochybách, ponechejte výchozí hodnoty, protože byly
zvoleny s ohledem na bezpečnost. Neuvážená kombinace voleb může způsobit nízkou
kvalitu šifrování, které tak vytváří pouze falešný pocit bezpečí.

Šifrování: aes

    Touto volbou můžete vybrat šifrovací algoritmus (šifru), jež se použije pro
    šifrování dat na dané oblasti. debian-installer nyní podporuje tyto šifry:
    aes, blowfish, serpent a twofish. Kvalita jednotlivých šifer přesahuje
    záběr této příručky, nicméně vám v rozhodování může pomoci informace, že v
    roce 2000 byla šifra AES zvolena americkým úřadem pro standardizaci jako
    standardní šifrovací algoritmus pro ochranu citlivých dat v 21. století.

Velikost klíče: 256

    Zde můžete zadat délku šifrovacího klíče. Obvykle platí, že čím delší klíč,
    tím větší odolnost šifry proti útokům. Na druhou stranu také delší klíč
    většinou znamená menší výkon (výjimkou jsou třeba šifry blowfish a
    twofish). Dostupné velikosti klíče se liší v závislosti na konkrétní šifře.

Algoritmus IV: xts-plain64

    Inicializační vektor nebo též algoritmus IV se používá v kryptografii pro
    zajištění, že aplikováním šifry na stejný nezašifrovaný text za použití
    stejného klíče vždy dostaneme jiný šifrovaný text. Cílem je zabránit
    útočníkovi v odvození informací na základě opakujících se vzorků v
    šifrovaných datech.

    Z nabízených alternativ je xts-plain64 momentálně nejméně zranitelný
    vzhledem ke známým útokům. Ostatní možnosti používejte pouze v případě, kdy
    potřebujete zaručit zpětnou kompatibilitu s dříve instalovaným systémem,
    který neumí používat novější algoritmy.

Šifrovací klíč: Přístupová fráze

    Zde si můžete zvolit typ šifrovacího klíče pro tuto oblast.

    Přístupová fráze

        Šifrovací klíč bude vypočítán^[16] na základě textové fráze, kterou
        zadáte později.

    Náhodný klíč

        Nový šifrovací klíč bude vytvořen z náhodných dat pokaždé, když se
        pokusíte tuto šifrovanou oblast použít poprvé od startu systému. Jinými
        slovy po každém vypnutí/restartu systému bude obsah oblasti ztracen,
        protože se klíč z oblasti smaže. (Samozřejmě že se můžete pokusit
        uhádnout klíč hrubou silou, ale pokud v šifrovacím algoritmu není
        nějaká neznámá slabina, během našeho života se to nepodaří.)

        Náhodné klíče se hodí pro odkládací oblasti, protože se pak nemusíte
        trápit s pamatováním další přístupové fráze, nebo s ručním mazáním dat
        z odkládací oblasti před každým vypnutím počítače. Na druhou stranu to
        také znamená, že nebudete moci využít vlastnost "uspání na disk", která
        je součástí novějších linuxových jader, protože při následujícím startu
        nebude možno obnovit obsah operační paměti, který byl odložen fo
        odkládací oblasti.

Smazat data: ano

    Určuje, zda se má před samotným zašifrováním oblasti přepsat její obsah
    náhodnými znaky. Je doporučeno tuto možnost povolit, protože jinak by mohl
    útočník rozpoznat, které části oblasti se používají a které ne. Kromě toho
    tím ztížíte vydolování dat, která mohla v oblasti zůstat po předchozí
    instalaci^[17].

Po výběru požadovaných parametrů vaší šifrované oblasti se vraťte zpět do
hlavního rozdělovacího menu, kde by měla nově přibýt položka nazvaná Nastavit
šifrované svazky. Po jejím výběru budete požádáni o povolení smazat data na
oblastech, které jste dříve označili pro smazání. U větších oblastí může mazání
dat trvat poměrně dlouho.

Dále budete dotázáni na zadání přístupové fráze (pokud ji používáte). Dobrá
fráze by měla být delší než 8 znaků, měla by se skládat z písmen, číslic a
dalších znaků a neměla by obsahovat běžná slova ze slovníku nebo informace,
které se s vámi dají lehce spojit (jako narozeniny, záliby, jména mazlíčků,
jména členů rodiny nebo příbuzných, apod.).

Varování

Než budete zadávat samotnou frázi, měli byste se ujistit, že je klávesnice
nastavená správně a že generuje očekávané znaky. Může se totiž stát, že se
během instalace přepnete do jiného klávesového rozložení, než budete mít k
dispozici v nově nainstalovaném systému. Doporučujeme si již dříve vyzkoušet
různé klávesy v nějakém textovém poli, případně se přepnout na druhou virtuální
konzoli a napsat něco do příkazového řádku.

Pokud jste zvolili vytvoření šifrovacího klíče z náhodných dat, bude nyní
vytvořen. Protože během této časné fáze instalace ještě nemusí mít jádro
nasbíráno dostatek entropie, bude proces trvat hodně dlouho. Proces můžete
urychlit vytvořením nějaké entropie, například mačkáním náhodných kláves, nebo
přepnutím do shellu na druhé virtuální konzoli a vytvořením síťového či
diskového provozu (stahováním nějakých souborů, kopírování velkých dat do /dev/
null, apod.).

To bude zopakováno pro každou oblast označenou pro šifrování.

Po návratu do hlavního rozdělovacího menu uvidíte všechny šifrované svazky jako
další oblasti, které můžete nastavit úplně stejně jako běžné oblasti.
Následující příklad ukazuje svazek zašifrovaný pomocí dm-crypt.

Šifrovaný svazek (sda2_crypt) - 115.1 GB Linux device-mapper
     #1 115.1 GB  F ext3

Nyní je čas přiřadit svazkům přípojné body a případně změnit ostatní parametry,
pokud vám nevyhovují (souborový systém, rezervované bloky, atd.).

Jedna věc, kterou byste si zde měli poznačit do budoucna, jsou kombinace
identifikátorů v závorkách (v tomto příkladu sda2_crypt) a přípojných bodů,
které jsou ke každému šifrovanému svazku připojeny. Tato informace se vám bude
hodit později, až budete zavádět svůj nový systém. Rozdíly mezi běžným
zaváděním systému a zaváděním se šifrovanými svazky bude včas popsáno v
kapitole 7.2 - "Připojení zašifrovaných svazků".

Až budete s rozdělením disku spokojeni, můžete pokračovat v instalaci.

6.3.4. Instalace základního systému

Přestože je tato část nejméně problematická, zabere dosti času, protože musí
stáhnout, ověřit a rozbalit celý základní systém. Pokud máte pomalý počítač a/
nebo síťové připojení, může to chvíli trvat.

Během instalace základního systému jsou hlášky o rozbalování a nastavování
balíků přesměrovány na třetí virtuální konzoli tty4. Můžete se na ni přepnout
klávesami Levý Alt+F4, zpět se dostanete kombinací Levý Alt+F1.

Tyto jsou hlášky jsou také uloženy do souboru /var/log/syslog, což se může
hodit v případě, že instalujete systém přes sériovou konzoli,

Během instalace se nainstaluje i jádro Linux. Při standardní prioritě vám
debian-installer vybere jádro, které nejvíce odpovídá vašemu hardwaru. Při
nižších prioritách si budete moci sami vybrat ze seznamu dostupných jader.

Při instalaci balíků se automaticky nainstalují také balíky, které jsou
instalovanými balíku doporučovány. Doporučené balíky nejsou pro funčnost
zvoleného software striktně vyžadovány, nicméně nějakým způsobem rozšiřují jeho
funkcionalitu a v očích správců balíků by se měly instalovat společně.

Poznámka

Z technických důvodů se balíky instalované jako součást základního systému
instalují bez doporučených balíků. Pravidlo popsané výše tedy začíná platit až
po instalaci základního systému.

6.3.5. Instalace dodatečného softwaru

V tento okamžik máte sice použitelný, nicméně poněkud omezený systém. Většina
uživatelů si bude chtít do systému doinstalovat další software a upravit tak
systém svým potřebám, s čímž vám instalátor ochotně pomůže. Jestliže máte
pomalejší počítač nebo síťové připojení, může tento krok trvat ještě déle než
instalace základního systému.

6.3.5.1. Nastavení apt

Uživatelé obvykle instalují balíky programem apt z balíku apt, případně
některou nadstavbou typu aptitude nebo synaptic^[18]. Uživatelé si tyto
nadstavby oblíbili pro jejich pokročilé funkce jako je hledání dle různých
kritérií nebo interaktivní řešení závislostí.

Aby aptitude nebo apt věděli, odkud mají získávat balíky, musí se nastavit. S
tím pomůže komponenta apt-setup, která výsledky svého snažení zapíše do souboru
/etc/apt/sources.list a který můžete po instalaci prozkoumat a v případě
potřeby upravit.

Instalujete-li s výchozí prioritou otázek, instalátor nastaví většinu věcí
automaticky na základě typu instalace (síťová, CD/DVD) a dříve zodpovězených
otázek. Jestliže jste například zavedli instalaci ze sítě, zvolili jako výchozí
jazyk češtinu a neměnili nastavení zrcadla, použije se pravděpodobně síťový
zdroj ftp.cz.debian.org. Ve většině případů se automaticky přidá zrcadlo s
bezpečnostními aktualizacemi a v případě stabilní verze distribuce také archiv
služby "stable-updates", která poskytuje novější verze rychle se měnících
balíků, jako jsou vzory a pravidla pro antivirové a antispamové programy.

Při instalaci s nižší prioritou otázek (např. v expertním režimu) můžete
rozhodovat o více nastaveních. Můžete si sami vybrat, zda budete používat
bezpečnostní aktualizace a službu stable-updates a také zda chcete mít
přístupné balíky ze sekcí "contrib" a "non-free".

6.3.5.1.1. Instalace z více CD/DVD

Instalujete-li z CD nebo DVD, které je součástí celé sady, instalátor se zeptá,
zda chcete prozkoumat dodatečná CD/DVD. Pokud taková média máte, doporučujeme
souhlasit, protože pak můžete jednoduše instalovat balíky na nich uložené.

Nemáte-li další média, nic se neděje -- jejich použití není nutné.
Nepoužijete-li ani síťové zrcadlo (další kapitola), znamená to pouze, že se
nemusí nainstalovat všechny balíky z úloh, které si vyberete v příštím kroku.

Poznámka

Balíky jsou na médiích uloženy podle popularity, což znamená, že pro
nejběžnější instalace postačí pouze několik prvních CD. Balíky z posledního CD
využije jen velmi málo uživatelů.

To také znamená, že zakoupení nebo stažení a vypálení celé sady CD je jen
plýtvání, protože většinu médií stejně nevyužijete. Ve většině případů je
rozumné stáhnout nejvýše prvních 8 CD (často postačí první 3) a případné další
balíky instalovat z Internetu. Pro DVD platí něco podobného -- jedno nebo dvě
DVD pokryjí většinu potřeb.

Pořadí, ve kterém necháte média prozkoumat, nehraje žádnou roli. Je ovšem
vhodné nechat prozkoumat média pouze ze stejné sady, protože tak předejdete
potenciálním problémům se závislostmi balíků.

6.3.5.1.2. Používání síťového zrcadla

Jednou z otázek, která se zobrazí téměř ve všech případech, je použití síťového
zrcadla. Většinou stačí použít výchozí možnost, ale existuje několik výjimek.

Pokud neinstalujete z velkého CD nebo DVD, případně z obrazu velkého CD/DVD,
měli byste použití síťového zrcadla povolit, protože jinak skončíte pouze s
minimálním systémem. Máte-li pomalé internetové připojení je lepší v dalším
kroku instalace nevybírat úlohu Desktopové prostředí.

Instalujete-li z jediného velkého CD nebo obrazu CD (ne DVD), není použití
síťového zrcadla nutné, ale rozhodně je doporučované, protože CD obsahuje jen
omezené množství balíků. Máte-li pomalé internetové připojení, je lepší zde
síťové zrcadlo nevybírat a dokončit instalaci jenom s tím, co je na prvním CD.
Další balíky pak můžete doinstalovat po skončení instalace ze svého nového
systému.

Jestliže instalujete z DVD, nebo k instalaci používáte obraz DVD, je potřeba
síťového zrcadla mnohem menší, protože všechny balíky potřebné pro základní
instalaci by se měly nacházet na DVD. To stejné platí v případě, že použijete
sadu několika CD.

Jednou z výhod použití síťového zrcadla je, že pokud od vytvoření médií vyšla
nová minoritní verze Debianu, automaticky získáte aktualizované balíky z
novějších vydání (r1, r2, r3, ...). Můžete tak prodloužit životnost médií bez
obav o bezpečnost nebo stabilitu systému.

Stručně: s výjimkou pomalého internetového připojení je použití síťového
zrcadla dobrý nápad. Bude-li stejná verze balíku k dispozici na síti i na CD/
DVD, instalátor vždy použije balík z CD/DVD. Množství stažených dat závisí na:

 1. úlohách vybraných v dalším kroku

 2. balících, které jsou k dispozici na CD/DVD

 3. zda se na síťových zrcadlech vyskytují novější verze balíků, než jsou na CD
    /DVD (opravy závažných chyb, bezpečnostní aktualizace)

Poslední bod znamená, že i když použití zrcadla zakážete, je možné, že se z
Internetu stáhnou balíky, ve kterých byla nalezena bezpečnostní chyba, nebo pro
které existuje novější verze na službě "stable-updates" (za předpokladu, že
jste použití těchto služeb také nezakázali).

6.3.5.1.3. Výběr síťového zrcadla

Jestliže jste během instalace zvolili použití síťového zrcadla, bude vám
nabídnut seznam geograficky blízkých (a tedy doufejme rychlých) zrcadel. Není v
tom žádná magie, použijí se zrcadla ze země, kterou jste zvolili na počátku
instalace.

Pokud se váš počítač nachází na síti, na které se používá pouze protokol IPv6,
nemusí výchozí nabídnuté zrcadlo fungovat. Všechna zrcadla jsou totiž dostupná
přes IPv4, ale pouze některá přes IPv6. Jelikož se situace mění každým
okamžikem, není tato informace dostupná přímo v instalačním systému. Jestliže
výchozí nabídnuté zrcadlo IPv6 nepodporuje, zkuste nějaké jiné, případně zvolte
možnost "zadat informace ručně" a jako název zrcadla zadejte
ftp.ipv6.debian.org. Nebude to asi nejrychlejší, ale bude to fungovat.

Další možností, zatím ne zcela oficiální, je při ručním zadávání zrcadla zadat
httpredir.debian.org. Nejedná se o fyzické zrcadlo, ale o službu, která vás
automaticky přesměruje na topologicky nejbližší zrcadlo. Služba bere v úvahu i
protokol, kterým k ní přistupujete, takže v případě IPv6 by vás měla
přesměrovat na blízké zrcadlo podporující právě protokol IPv6.

Při ručním zadávání zrcadla je možné kromě jména počítače použít i IP adresu a
volitelně i číslo portu. Při zadávání IPv6 adresy je nutné ji obklopit
hranatými závorkami, např. takto: "[2001:db8::1]".

6.3.5.2. Výběr a instalace softwaru

Během instalace vám bude nabídnuta možnost nainstalovat si další software. V
této fázi sice máte k dispozici 84902 dostupných balíků, ale protože jen jejich
projití zabere hodně (tím myslíme opravdu hodně) času, nabízí debian-installer
instalaci připravených softwarových úloh, které umožní rychlé přizpůsobení
počítače pro danou úlohu.

Nejprve tedy můžete vybírat úlohy a teprve poté doinstalovat konkrétní balíky. 
Úlohy představují různé činnosti, které byste s počítačem mohli provádět.
Například "desktopové prostředí", "webový server" nebo "tiskový server".^[19].
Velikost jednotlivých úloh zmiňuje kapitola D.2 - "Místo potřebné pro úlohy".

Podle odhadnutého typu počítače mohou být některé úlohy předvybrány. (Např.
pokud si debian-installer myslí, že instalujete notebook, předvybere úlohu "
Notebook".) Nesouhlasíte-li s výběrem, můžete nechtěné úlohy zase odebrat.
Dokonce nemusíte instalovat žádnou úlohu.

Tip

Ve výchozím prostředí instalačního systému se úlohy (od)vybírají klávesou 
mezera.

Poznámka

Úloha "Desktopové prostředí" nainstaluje výchozí grafické desktopové prostředí 
Gnome. Preferujete-li jiné prostředí, můžete je zvolit jako alternativní úlohu
přímo během instalace. Dokonce je možné vybrat několik prostředí najednou, ale
u některých kombinací není zaručeno, že se instalace podaří.

To samozřejmě bude fungovat pouze v případě, že jsou balíky tvořící zvolené
desktopové prostředí k dispozici. Naznačujeme tím, že pokud k instalaci
používáte pouze první CD, musí se tyto balíky stáhnout ze síťového zrcadla,
jelikož se na první CD nevejdou. U všech ostatních typů instalace (z DVD nebo
rovnou ze sítě) by se mělo desktopové prostředí nainstalovat bez problémů.

Různé serverové úlohy nainstalují zhruba následující software. Webový server:
apache2; Tiskový server: cups; SSH server: openssh.

Úloha "Standardní systém" nainstaluje všechny balíky s prioritou "standardní".
To zahrnuje spoustu běžných nástrojů, které se obvykle nachází na každém
linuxovém nebo unixovém systému. Pokud zrovna nestavíte minimalistický systém a
pokud přesně nevíte, co děláte, měli byste tuto úlohu ponechat vybranou.

Jestliže jste při výběru jazyka zvolili jakoukoliv jinou možnost než "C", 
tasksel nyní zkontroluje, zda pro zvolený jazyk/místní prostředí neexistuje
lokalizační úloha a automaticky se ji pokusí nainstalovat. Lokalizační úlohy
typicky obsahují balíky se slovníky a fonty vhodnými pro daný jazyk. Pokud jste
zvolili i úlohu "Desktopové prostředí", mohou se doinstalovat další lokalizační
balíky (pokud jsou dostupné).

Až skončíte s výběrem, vyberte tlačítko Pokračovat. Tím se na pozadí spustí 
aptitude, která nainstaluje vybrané balíky.

Programy apt-get a dpkg pak zajistí stažení, rozbalení a instalaci všech balíků
obsažených ve zvolených úlohách. Pokud instalace balíku vyžaduje od uživatele
nějaký vstup, budete dotázáni stejně jako třeba při vytváření nového uživatele.

Měli byste mít na paměti, že úloha desktopové prostředí je opravdu velká.
Pocítíte to obzvláště v případě, kdy instalujete z běžného CD v kombinaci se
síťovým zrcadlem, což může při pomalém připojení trvat poměrně dlouho. Po
zahájení instalace neexistuje žádná uživatelsky jednoduchá možnost, jak
instalaci přerušit.

Instalační systém může některé balíky stahovat ze sítě i v případě, že se
balíky nachází na CD. To se stává tehdy, když se na síťovém zrcadle nachází
novější verze balíků, než na CD. U stabilní distribuce to znamená po vydání
nové revize (po 10r0 vyjde 10r1, 10r2, ...), u testovací distribuce se s tímto
potkáte již několik dnů až týdnů po stažení obrazu CD.

6.3.6. Nastavení zavádění systému

Pokud instalujete bezdiskovou stanici, zavádění systému z lokálního disku
evidentně nebude nejsmysluplnější volba - tento krok přeskočte.

6.3.6.1. Nalezení ostatních operačních systémů

Před instalací zavaděče se debian-installer pokusí vyhledat jiné operační
systémy instalované na počítači. Pokud nějaké najde, budete o tom informováni
během instalace zavaděče a počítač bude nastaven tak, aby kromě Debianu zaváděl
i nalezené operační systémy.

Zavádění více operačních systémů na jednom počítači je stále něco jako černá
magie. Kvalita automatického rozpoznávání operačních systémů a následné
nastavení zavaděče se liší na jednotlivých architekturách a dokonce i na jejich
podarchitekturách. Pokud něco nebude fungovat, měli byste si dobře prostudovat
dokumentaci použitého zavaděče.

6.3.6.2. Instalovat zavaděč Grub na pevný disk

Hlavní zavaděč na architektuře i386 se nazývá "grub". Grub je pružný a robustní
zavaděč, který je vhodný jak pro začátečníky, tak pro zkušené harcovníky.

Implicitně se grub nainstaluje do hlavního zaváděcího záznamu (MBR), kde
převezme kompletní kontrolu nad zaváděním. Pokud si přejete, můžete jej
instalovat i někam jinam. Pak si však raději prostudujte manuál ke grubu.

Nechcete-li grub instalovat, použijte tlačítko Jít zpět, což vás vrátí do
hlavního menu. Zde si můžete vybrat, který zavaděč chcete použít.

6.3.6.3. Instalovat zavaděč LILO na pevný disk

Druhý zavaděč na architektuře i386 se nazývá "LILO". Je to komplexní program
nabízející hodně možností, včetně zavádění DOSu, Windows a OS/2. Máte-li nějaké
speciální požadavky, prostudujte si adresář /usr/share/doc/lilo/ a nezapomeňte
na zajímavý dokument LILO mini-HOWTO.

Poznámka

LILO vytvoří záznamy pro zavádění ostatních operačních systémů pouze pokud může
jejich zavaděče zřetězit za sebe sama. To znamená, že pro operační systémy typu
GNU/Linux nebo GNU/Hurd budete muset přidat příslušné záznamy po instalaci
ručně.

Při instalaci LILA vám debian-installer vám nabídne tři možnosti, kam se má
zavaděč naintalovat:

Hlavní zaváděcí záznam

    LILO bude mít kompletní kontrolu nad zaváděním a bude se starat i o
    zavádění ostatních operačních systémů.

Nová oblast Debianu

    Tuto možnost vyberte, pokud chcete používat jiný zavaděč. LILO se
    nainstaluje na začátek oblasti pro Debian a bude sloužit jako druhotný
    zavaděč.

Jiná volba (Pokročilé)

    Užitečné pro zkušené uživatele, kteří chtějí instalovat LILO někam úplně
    jinam. V tomto případě budete dotázáni na požadované umístění. Cíl
    instalace můžete zadat tradičním názvem zařízení jako /dev/sda.

Pokud něco uděláte špatně a nebudete moci zavést Windows 9x (nebo DOS), budete
muset nastartovat ze zaváděcí diskety Windows 9x (resp. DOSu) a příkazem fdisk
/mbr nainstalovat DOSový MBR (master boot record). To ale znamená, že budete
muset najít nějakou jinou cestu, jak se dostat zpět do Debianu!

6.3.6.4. Pokračovat bez zavaděče

Pomocí této komponenty můžete získat zaveditelný systém, i když se
nenainstaluje žádný zavaděč -- ať už proto, že na této architektuře žádný
neexistuje, nebo proto, že jej nechcete nainstalovat (třeba chcete použít
stávající zavaděč).

V tomto okamžiku je vhodné prozkoumat obsah adresáře /target/boot a poznačit si
název jádra a případného ramdisku (initrd), protože je budete muset sdělit
svému zavaděči spolu s dalšími důležitými informacemi, jako je oblast s
kořenovým souborovým systémem a oblast pro /boot (pokud máte /boot na
samostatné oblasti).

6.3.7. Dokončení instalace

Toto jsou poslední drobnosti, které je třeba vykonat před zavedením nového
systému. Většina práce spočívá v uklizení po debian-installeru.

6.3.7.1. Nastavení systémových hodin

debian-installer se může zeptat, zda jsou hardwarové hodiny počítače nastaveny
na univerzální časové pásmo (UTC). Systém se snaží odpověď odhadnout například
podle nalezených operačních systémů. Při expertní instalaci se otázka zobrazí
vždy. Jestli budou na počítači i Windows nebo DOS, možnost hardwarových hodin v
UTC zamítněte, protože zmíněné systémy s touto možností pracovat neumí.

V tento okamžik se debian-installer pokusí uložit aktuální čas do hardwarových
hodin počítače. V závislosti na předchozí odpovědi bude čas uložen buď v UTC
nebo v místním čase.

6.3.7.2. Dokončení instalace a restart do nového systému

Toto je poslední krok debian-installeru. Budete vyzváni k odstranění zaváděcích
médií (CD, disketa, apod.), která jste použili pro zavedení instalačního
systému. debian-installer provede poslední úklidové práce a restartuje počítač
do vašeho nového systému.

6.3.8. Řešení problémů

Následující komponenty se obvykle do instalačního procesu nezapojují, ale tiše
čekají v pozadí, aby vám pomohly v případě, že se něco pokazí.

6.3.8.1. Uložení záznamů o instalaci

Pokud byla instalace úspěšná, budou záznamy vytvořené během instalace uloženy v
novém systému v adresáři /var/log/installer/.

Pokud během instalace zaznamenáte kritické chyby, může být výhodné uložit si
tyto informace na disketu, síť, pevný disk nebo jiné médium a v klidu si je
prostudovat na jiném počítači, nebo je přiložit k hlášení o chybě. K tomu
slouží právě menu Uložit záznamy pro pozdější ladění.

6.3.8.2. Používání shellu a prohlížení logů

Shell můžete během instalace získat několika způsoby. Pokud zrovna
neinstalujete přes sériovou konzoli, je nejjednodušší se přepnout na druhou 
virtuální konzoli klávesami Levý Alt+F2 (na macintoshí klávesnici Option+F2),
kde běží samostatný klon Bourne shellu nazvaný ash. Zpět do instalátoru se
dostanete klávesovou zkratkou Levý Alt+F1.

Používáte-li grafický instalátor, podívejte se též na kapitolu 6.1.1 -
"Používání grafického instalátoru".

Pokud se nemůžete přepínat mezi virtuálními konzolami, můžete shell spustit z
hlavního menu příkazem Spustit shell. Po vykonání potřebných příkazů se zpět do
menu vrátíte příkazem exit.

V tomto okamžiku běží systém z RAMdisku a nabízí několik základních unixových
nástrojů. Seznam dostupných programů můžete zjistit příkazy ls /bin /sbin /usr/
bin /usr/sbin a help. Shell má některé příjemné vlastnosti svých větších
bratříčků, jako je historie a automatické doplňování příkazů.

Pro úpravu souborů máte k dispozici textový editor nano.

Přestože můžete v shellu provádět téměř cokoliv, co vám dostupné programy
umožní, měli byste raději používat menu instalačního programu -- shell a jeho
příkazy jsou zde jen pro případ, že se něco pokazí. Ruční spouštění příkazů ze
shellu totiž může kolidovat s instalačním procesem. Konkrétně pro inicializaci
odkládací oblasti byste měli použít menu a ne shell, protože instalační program
jinak nepozná, že jste tento krok již provedli.

6.3.9. Instalace přes síť

Jednou ze zajímavějších komponent je network-console, která vám umožní provádět
větší část instalace vzdáleně přes SSH. Použití sítě naznačuje, že budete muset
provést několik prvních kroků instalace (minimálně po nastavení sítě) lokálně a
teprve pak pokračovat vzdáleně. Lokální část však můžete automatizovat použitím
4.6 - "Automatická Instalace".)

Tato komponenta se implicitně nenahrává do instalačního menu a proto o ni
budete muset požádat. Nejprve musíte zavést instalační systém se střední
prioritou otázek, nebo jiným způsobem vyvolat hlavní instalační menu a vybrat
položku Nahrát komponenty instalátoru z CD (nebo ze sítě) a ze seznamu
dodatečných komponent vybrat network-console: Continue installation remotely
using SSH. Úspěšné načtení komponenty se projeví tak, že v menu přibude nová
položka nazvaná Pokračovat v instalaci vzdáleně přes SSH.

Po výběru této nové položky budete požádáni o zadání nového hesla, které se
použije pro připojení do instalovaného systému. Následuje rutinní potvrzení
hesla, zda bylo zadáno správně. Toť vše. Nyní uvidíte obrazovku s nápovědou,
která říká, že se máte vzdáleně připojit k systému jako uživatel installer s
heslem, které jste právě zadali. Další důležitá věc na obrazovce je
kryptografický otisk tohoto systému. Tento otisk musíte zabezpečeně předat
osobě, která bude v instalaci pokračovat vzdáleně.

Pokud byste se náhodou rozhodli pokračovat v instalaci lokálně, můžete vždycky
stisknout Enter, což vás vrátí zpět do hlavního menu, kde můžete vybrat další
krok.

Nyní se přepojme na druhý konec drátu. Nejprve byste se měli ujistit, že máte
terminál přepnutý do kódování UTF-8, protože jej používá instalační systém.
Pokud tak neučiníte, vzdálenou instalaci by to nemělo nijak ovlivnit, ale je
pravděpodobné, že uvidíte na displeji různé artefakty jako porušené rámečky
dialogových oken a rozsypaný čaj z písmen, které nespadají do sedmibitového
ASCII. Pro navázání spojení stačí napsat:

$ ssh -l installer instalovany_pocitac

kde instalovany_pocitac je buď jméno nebo IP adresa instalovaného počítače.
Před samotným přihlášením se zobrazí kryptografický otisk vzdáleného systému,
který budete muset potvrdit, zda je správný.

Poznámka

ssh server v instalačním systému používá výchozí nastavení, které neposílá
pakety pro udržování spojení. Teoreticky to ničemu nevadí, ale prakticky se
může stát, že se po určité době neaktivity spojení rozpadne. Typickým příkladem
může být překlad adres (NAT) někde po cestě mezi klientem a instalovaným
systémem. Opětovné připojení a pokračování v instalace se může, ale nemusí
podařit -- závisí na kroku instalace, ve kterém se spojení přerušilo.

Rozpadávání spojení můžete předejít tak, že při spuštění ssh klienta použijete
parametr -o ServerAliveInterval=hodnota, případně že tento parametr zadáte do
konfiguračního souboru ssh. Mějte však na paměti, že v některých případech může
právě tento parametr způsobit rozpadávání spojení (například pokud se udržovací
paket odešle během krátkodobého výpadku sítě, který by jinak ssh ustálo).

Poznámka

Instalujete-li postupně několik počítačů, které mají stejnou IP adresu nebo
jméno, ssh se odmítne k takovému počítači připojit. Důvodem je odlišný
kryptografický otisk, což obvykle indikuje útok, kdy se záškodník vydává za
cílový počítač. Pokud jste si jisti, že to není tento případ, budete muset ze
souboru ~/.ssh/known_hosts smazat příslušný řádek^[20] a připojení zopakovat.

Po přihlášení vám bude nabídnuta úvodní obrazovka, kde můžete volit mezi
možností Spustit menu a Spustit shell. První možnost vás přenese do hlavního
instalačního menu, kde můžete pokračovat v instalaci obvyklým způsobem. Druhá
možnost spustí shell, ve kterém můžete zkoumat a případně opravit vzdálený
systém. Přestože počet SSH spojení do instalovaného systému není omezen, měli
byste mít pouze jedno spojení, kterým ovládáte instalaci (na rozdíl od shellů,
kterých si můžete spustit dle libosti).

Varování

Po zahájení vzdálené instalace byste se již neměli vracet zpět k lokální
instalaci, protože by to mohlo porušit databázi, ve které je uloženo nastavení
nového systému, což by následně vedlo k nefunkční instalaci nebo k problémům v
novém systému.

6.4. Nahrání chybějícího firmwaru

Jak je zmíněno v 2.2 - "Ovladače vyžadující firmware", některá zařízení
vyžadují pro svou práci kromě ovladače zařízení také firmware. Ve většině
případů znamená chybějící firmware nefunkční zařízení. Existují však výjimky,
kdy zařízení bez firmwaru funguje alespoň v základním režimu a firmware je
potřeba až pro povolení speciálních vlastností.

Pokud ovladač zařízení vyžaduje firmware, který není k dispozici,
debian-installer nabídne jeho nahrání z výměnných médií. Budete-li souhlasit,
debian-installer prozkoumá dostupná zařízení, na kterých hledá buď samotné
soubory s firmwarem, nebo balíky obsahující firmware. Je-li firmware nalezen,
nakopíruje se do /lib/firmware a příslušný modul je znovu zaveden.

Poznámka

To, která zařízení jsou prohledána a které souborové systémy prozkoumány,
závisí na architektuře, typu instalačních médií a fáze instalace. Obzvláště v
počátcích instalace budete mít největší šanci na úspěch s disketou nebo USB
klíčenkou formátovanou souborovým systémem FAT. Na architekturách i386 a amd64
je možné zavést firmware také z MMC nebo SD karty.

Pokud víte, že zařízení není pro instalaci potřeba, nebo pokud zařízení funguje
i bez firmwaru, můžete zavedení firmwaru přeskočit.

debian-installer se ptá pouze na firmware vyžadovaný jadernými moduly
používanými během instalace. Například jedním z ovladačů, které
debian-installer během instalace nepoužívá, je modul radeon pro grafické karty
AMD/ATI. To znamená, že se pro některý hardware nenahraje firmware a takový
hardware pak nemusí být využíván naplno. Pokud máte podezření, že to je váš
případ, zkontrolujte si v nově zavedeném systému výstup příkazu dmesg a
hledejte řádky obsahující slovo "firmware".

6.4.1. Příprava média

Oficiální obrazy CD neobsahují nesvobodný firmware. Nejčastější způsob zavedení
takového firmwaru je z nějakého výměnného média, jako je USB klíčenka.
(Alternativně můžete použít neoficiální obrazy CD z https://cdimage.debian.org/
cdimage/unofficial/non-free/cd-including-firmware/, které obsahují některý
nesvobodný firmware přímo v sobě.) Při přípravě USB klíčenky (nebo jiného média
jako třeba diskové oblasti nebo diskety) se soubory s firmwarem musí nacházet
buď v kořenovém adresáři, nebo v adresáři /firmware. Doporučený souborový
systém je FAT, protože je podporovaný hned v úvodní části instalace.

Archivy obsahující nejnovější balíky pro nejběžnější firmware jsou dostupné z:

  • https://cdimage.debian.org/cdimage/unofficial/non-free/firmware/

Stačí stáhnout archiv pro příslušné vydání a rozbalit jej na médium.

Jestliže se požadovaný firmware v archivu nenachází, můžete se zkusit podívat
do sekce non-free. Následující přehled by měl obsahovat většinu dostupných
balíků s firmwarem (nemusí být úplný):

  • https://packages.debian.org/search?keywords=firmware

Na médium je také možné zkopírovat jednotlivé soubory s firmwarem (tzn. ne
balíky). Takovéto soubory můžete obvykle získat z již instalovaného systému,
nebo od dodavatele hardwaru.

6.4.2. Firmware a instalovaný systém

Všechny firmwary, které se zavedou během instalace, se automaticky nakopírují
do instalovaného systému. To by mělo zajistit, že zařízení vyžadující firmware
budou fungovat i po restartu do nového systému. Stále zde však existuje drobné
riziko v případě, kdy nainstalovaný systém používá jinou verzi jádra, než
instalační systém. V takovém případě je možné, že se firmware nepodaří zavést
kvůli rozdílné verzi.

Pokud byl firmware nainstalován z balíku s firmwarem, debian-installer do
instalovaného systému nainstaluje i tento balík a automaticky přidá do
konfiguračního souboru sources.list sekci non-free. Výhodou je to, že se
firmware bude aktualizovat automaticky.

Jestliže jste při instalaci přeskočili možnost nahrání firmwaru, nebude dané
zařízení nejspíš fungovat ani v nainstalovaném systému. Pro jeho zprovoznění
budete muset doinstalovat firmware ručně.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[8] Ve výjimečných případech se může stát, že ve vybraném jazyce nebudou
některé texty instalace přeloženy -- pak se zobrazí anglicky.

^[9] Technicky řečeno: pokud k jazyku existuje více locales s různými kódy
zemí.

^[10] Zastaralá prostředí jsou taková, která nepoužívají UTF-8, ale starší
standardy kódování, jako ISO 8859-2 (používaný ve střední Evropě) nebo EUC-JP
(používaný v Japonsku).

^[11] Je-li zvolené zrcadlo dlouhodobě nedostupné, je možné, že již neexistuje,
protože seznam zrcadel se vytváří před vyjitím stabilní verze Debianu, což
mohlo být před několika měsíci (a v některých případech i před několika lety).

^[12] Instalátor zašifruje skupinu svazků pomocí 256 bitového klíče AES a
využije pro to "dm-crypt", který je součástí linuxového jádra.

^[13] V určitých případech (jako je použití LVM) nebudete moci vrátit všechny
změny, protože některé z nich jsou již zapsány na disku. Naštěstí vás však
instalační program bude před každou trvalou změnou varovat.

^[14] Ve skutečnosti můžete MD vytvořit i z oblastí ležících na jednom fyzickém
disku, ale nezískáte tím žádnou popisovanou výhodu.

^[15] Nápověda: vytvořit souborové systémy, vybrat přípojné body, apod.

^[16] Použití přístupové fráze jako klíče momentálně znamená, že oblast bude
používat LUKS.

^[17] Obecně se ví, že agenti z třípísmenných agentur umí obnovit data z
magnetooptických médií i po několika přepsáních.

^[18] Ve skutečnosti balíky instaluje program na nižší úrovni: dpkg. dpkg je
podle potřeby volán z nástroje apt, který se stará o získání potřebných balíků
ze sítě, CD nebo jiného zdroje a také o vyřešení závislostí mezi nimi.

^[19] Protože je debian-installer velmi líný, tak si na pomoc volá jiné
aplikace. Konkrétně pro zobrazení seznamu úloh spustí program tasksel, který
můžete spustit i samostatně kdykoliv po instalaci a (od)instalovat si tak další
balíky. Je-li pro vaše potřeby výběr úloh moc hrubý, pak poslouží program 
aptitude. Například pro instalaci konkrétního balíku stačí spustit příkaz
aptitude install balík, kde balík je jméno balíku, který chcete nainstalovat.

^[20] Například příkazem ssh-keygen -R <počítač> nebo ssh-keygen -R <IP adr.>.

Kapitola 7. Zavedení vašeho nového systému

Obsah

7.1. Okamžik pravdy
7.2. Připojení zašifrovaných svazků

    7.2.1. Řešení problémů

7.3. Přihlášení do systému

7.1. Okamžik pravdy

Teď přichází chvíle zahoření systému.

Jestliže jste provedli víceméně standardní instalaci, měli byste při zavádění
systému jako první vidět nabídku zavaděče grub, případně lilo. První položky
nabídky patří novému systému Debian. Jestliže máte na svém systému i jiné
operační systémy (např. Windows), které byly během instalace rozpoznány, budou
v nabídce uvedeny.

Pokud Debian z disku nenaběhne, nepanikařte. Byla-li instalace úspěšná, je
velká šance, že se jedná jen o relativně drobný problém. Ve většině případů je
možné tyto problémy spravit bez opakování celé instalace. Jednou z možností je
použít záchranný režim zabudovaný přímo do instalačního systému (viz část 8.7 -
"Obnovení poškozeného systému").

Jestliže se systémem Debian začínáte, může se vám hodit pomoc zkušenějších
uživatelů. Pro online pomoc můžete zkusit IRC kanály #debian nebo #debian-boot
v síti OFTC, nebo můžete kontaktovat poštovní konferenci debian-user. Dále nám
můžete poslat zprávu o instalaci (viz 5.4.7 - "Pošlete nám zprávu o instalaci"
). Svůj problém popište stručně a jasně a opište z obrazovky všechny hlášky,
které by mohly ostatním pomoci v určení problému.

Pokud na svém počítači máte operační systémy, které nebyly nalezeny, nebo
nebyly rozpoznány správně, pošlete nám prosím zprávu o instalaci.

7.2. Připojení zašifrovaných svazků

Jestliže jste při instalaci vytvořili nějaké šifrované svazky a přiřadili jim
přípojné body, budete během zavádění dotázáni na přístupovou frázi ke každému
takovému svazku.

Pro oblasti zašifrované pomocí dm-crypt uvidíte při zavádění výzvu podobnou
této:

Starting early crypto disks... part_crypt(starting)
Enter LUKS passphrase:

kde oblast je název oblasti, která byla zašifrována. Možná nyní přemýšlíte, pro
který svazek vlastně frázi zadáváte. /home? /var? Samozřejmě pokud máte jen
jediný šifrovaný svazek, tyto pochyby vás trápit nemusí a stačí zadat frázi,
kterou jste použili při vytváření svazku. Pro ostatní se nyní hodí poznámky,
které jste si poznačili jako poslední krok 6.3.3.6 - "Nastavení šifrovaných
svazků". Pokud jste si nepoznačili dvojice oblast_crypt a přípojný bod, můžete
tuto informaci najít v souboru /etc/fstab (a částečně v /etc/crypttab) ve svém
novém systému.

Při připojování kořenového souborového systému může výzva k zadání fráze
vypadat mírně jinak. Vzhled závisí na generátoru, kterým byl initrd vytvořen.
Initrd v následujícím příkladu byl vytvořen nástrojem initramfs-tools:

Begin: Mounting root file system... ...
Begin: Running /scripts/local-top ...
Enter LUKS passphrase:

Během zadávání přístupové fráze se nezobrazují žádné znaky (ani hvězdičky).
Zadáte-li chybnou frázi, máte ještě dva další pokusy. Po třetím pokusu,
zaváděcí proces tento svazek přeskočí a bude pokračovat připojením dalšího
souborového systému. Přeskočený svazek můžete připojit později ručně, viz část
7.2.1 - "Řešení problémů".

Po zadání všech přístupových frází by mělo zavádění pokračovat jako obvykle.

7.2.1. Řešení problémů

Pokud se některé šifrované svazky nepodařilo připojit kvůli chybné přístupové
frázi, budete je muset připojit po zavedení systému ručně. Existuje několik
možností.

  • První případ se zabývá kořenovou oblastí. Pokud se tato nepřipojí, zavádění
    se zastaví a pro další pokus budete muset počítač restartovat.

  • Nejjednodušší případ se týká datových oblastí typu /home nebo /srv. Po
    zavedení je stačí ručně připojit.

    U dm-crypt nejprve musíte zaregistrovat svazky do části jádra nazvané 
    device mapper. Slouží k tomu příkaz

    # /etc/init.d/cryptdisks start

    který prohledá všechny svazky zmíněné v souboru /etc/crypttab a po zadání
    správných přístupových frází vytvoří příslušná zařízení v adresáři /dev.
    (Již zaregistrované svazky budu přeskočeny, takže můžete příkaz spustit bez
    obav i několikrát po sobě.) Po úspěšné registraci můžete svazky připojit
    tradičním

    # mount /pripojny_bod

  • Pokud se nepodařilo připojit svazky obsahující nekritické části systému
    (např. /usr nebo /var), systém by se měl stále zavést a měli byste mít
    možnost připojit svazky ručně stejně jako v předchozím případě. Navíc byste
    ale měli nastartovat (resp. restartovat) služby, které se spouští ve vašem
    výchozím runlevelu, protože je velmi pravděpodobné, že se nespustily.
    Nejjednodušší cestou je asi restart celého počítače.

7.3. Přihlášení do systému

Po zavedení Debianu se setkáte s výzvou k přihlášení do systému (tzv. login
prompt). Přihlaste se pod svým osobním účtem, který jste si vytvořili během
instalace. Systém je připraven k používání.

Pokud jste začínající uživatel, asi si budete chtít prohlédnout dokumentaci
dostupnou v systému. V současné době existuje několik dokumentačních systémů,
ale pracuje se na jejich sjednocení.

Dokumentace vztahující se k instalovaným programům je v adresáři /usr/share/doc
/ v podadresáři se jménem programu (přesněji se jménem balíku). U rozsáhlejší
dokumentace bývá tato zabalena v samostatném balíku, který je většinou potřeba
doinstalovat zvlášť. Například příručku pro použití programu apt naleznete v
balíku apt-doc nebo apt-howto.

/usr/share/doc/ navíc obsahuje několik speciálních adresářů. Například linuxové
návody "jak na to" (HOWTO) jsou v adresáři /usr/share/doc/HOWTO/en-txt/.
Nainstalujete-li balík dhelp, získáte soubor /usr/share/doc/HTML/index.html,
který obsahuje seznam veškeré instalované dokumentace.

Tyto dokumenty můžete jednoduše prohlížet pomocí textového prohlížeče. Zadejte:

$ cd /usr/share/doc/
$ w3m .

Tečka za příkazem w3m říká, že má zobrazit obsah aktuálního adresáře.

Máte-li nainstalované desktopové grafické prostředí, můžete použít v něm
obsažený grafický webový prohlížeč. Spusťte prohlížeč z nabídky aplikací a do
řádku s adresou zadejte /usr/share/doc/.

Dokumentaci k příkazu můžete získat, když napíšete na příkazovém řádku info 
prikaz nebo man prikaz. Zkrácený návod k použití příkazu obvykle získáte, když
za příkaz přidáte parametr --help. Jestliže je výstup delší než obrazovka,
napište na konec příkazu ještě | more (výstup se pak zastaví po každé plné
obrazovce). Všechny příkazy začínající určitým řetězcem zobrazíte tak, že
napíšete řetězec a dvakrát stisknete klávesu Tab. Nápovědu k povelům shellu
získáte příkazem help.

Kapitola 8. Co dál?

Obsah

8.1. Vypínání systému
8.2. První kroky se systémem UNIX
8.3. Orientace v Debianu

    8.3.1. Balíčkovací systém Debianu
    8.3.2. Další software pro Debian
    8.3.3. Správa různých verzí programů
    8.3.4. Správa Cronu

8.4. Další dokumentace
8.5. Nastavení poštovního systému

    8.5.1. Výchozí nastavení pošty
    8.5.2. Odesílání pošty mimo systém
    8.5.3. Nastavení poštovního serveru Exim4

8.6. Kompilace nového jádra

    8.6.1. Správa jader

8.7. Obnovení poškozeného systému

8.1. Vypínání systému

Běžící systém Debian GNU/Linux nesmíte vypínat tlačítkem reset nebo prostým
vytažením napájecí šňůry ze zásuvky. Pokud se operační systém nevypne řízeně,
mohou se soubory na disku ztratit nebo poškodit. Používáte-li desktopové
prostředí, obvykle se v menu vyskytuje položka "Odhlásit", která vám umožní
systém vypnout (případně restartovat).

Na konzoli můžete použít klávesovou kombinaci Ctrl+Alt+Del . Pokud žádná z
předchozích možností nefungovala, můžete se přihlásit jako uživatel root a
zadat příslušný příkaz ručně. Systém restartujete příkazem reboot, zastavíte
příkazem halt (bez vypnutí napájení) a zcela vypnete příkazem poweroff^[21]
nebo shutdown -h now. Nový init systém systemd nabízí podobné příkazy se
stejnou funkcionalitou, a sice systemctl reboot, systemctl halt a systemctl
poweroff.

8.2. První kroky se systémem UNIX

Jestliže se systémem Unix začínáte, měli byste si pořídit (a hlavně přečíst)
nějakou literaturu. Mnoho hodnotných informací naleznete v Debian Reference. Za
shlédnutí stojí také seznam unixových FAQ, který obsahuje spoustu usenetových
dokumentů, jež mohou sloužit jako pohled do historie.

Linux je jednou z implementací systému Unix. Na stránkách Linux Documentation
Project (LDP) je shromážděno obrovské množství elektronických knih a návodů
HOWTO týkajících se Linuxu. Většinu z těchto materiálů si můžete pročítat
lokálně, stačí nainstalovat jeden z balíků doc-linux-html (HTML verze) nebo
doc-linux-text (ASCII verze). Dokumenty se nainstalují do adresáře /usr/share/
doc/HOWTO. V balících jsou dostupné rovněž překlady některých návodů.

8.3. Orientace v Debianu

Debian GNU/Linux se od ostatních distribucí mírně odlišuje. Proto i když jste
již s Linuxem nebo jiným unixovým systémem pracovali, pokud si chcete udržet
systém v pořádku, je třeba se seznámit s tím, jak distribuce funguje. Tato
kapitola vám pomůže se v Debianu lépe zorientovat. Opět se jedná pouze o letmý
přehled.

8.3.1. Balíčkovací systém Debianu

Nejdůležitější je pochopit, jak pracuje balíčkovací software, protože systém je
z velké části spravován právě balíčkovacím systémem. Jedná se o adresáře:

  • /usr (vyjma /usr/local)

  • /var (vyjma /var/local)

  • /bin

  • /sbin

  • /lib

Do vyjmenovaných adresářů byste neměli zasahovat, protože byste mohli narušit
informace udržované balíčkovacím systémem a mohlo by to vést až k nefunkčním
aplikacím. Například když nahradíte program /usr/bin/perl, nejspíš bude vše
fungovat, ale s přechodem k novější verzi balíku perl o své úpravy přijdete.
Zkušení uživatelé tomu dokáží zabránit převedením balíku do stavu "hold".

Jedna z nejlepších instalačních metod je určitě apt. Můžete ji použít z
příkazové řádky programem apt, nebo v celoobrazovkové textové aplikaci aptitude
. Apt vám dovolí sloučit všechny archivy (main, contrib a non-free), takže
můžete instalovat jak standardní, tak exportně omezené verze balíčků.

8.3.2. Další software pro Debian

I když máte po instalaci systému Debian k dispozici oficiální repositáře
balíčků, je možné, že budete potřebovat software, který se v nich nenachází. V
takovém případě se můžete poohlédnout po dalších více či méně oficiálních
repositářích, které mohou daný software obsahovat. Jeden komentovaný seznam
repositářů naleznete Wiki stránce Dostupný software pro Debian (stabilní
vydání)

8.3.3. Správa různých verzí programů

Pokud udržujete více verzí různých aplikací, bude vás zajímat manuálová stránka
příkazu update-alternatives.

8.3.4. Správa Cronu

Všechny periodické úlohy spojené se správou systému by měly být v adresáři /
etc, protože to jsou konfigurační soubory. Pokud spouštíte administrátorské
úlohy denně, týdně, nebo měsíčně, umístěte je do /etc/cron.
{daily,weekly,monthly}. Spouštění těchto úloh je řízeno souborem /etc/crontab.
Úlohy poběží postupně podle abecedního pořadí.

Jestliže však máte speciálnější požadavky (potřebujete úlohu spouštět pod jiným
uživatelem nebo chcete úlohu pouštět v určitém čase nebo intervalu), můžete
použít soubor /etc/crontab, nebo ještě lépe /etc/cron.d/cokoliv. Tyto soubory
mají navíc pole pro jméno uživatele, pod kterým se má úloha spustit.

V obou případech stačí přidat/upravit soubory a cron je automaticky rozpozná a
začne používat -- není potřeba spouštět žádný příkaz. Další informace jsou v
cron(8), crontab(5) a /usr/share/doc/cron/README.Debian.

8.4. Další dokumentace

Hledáte-li popis nějakého programu, vyzkoušejte nejprve kombinaci man program a
info program.

Užitečné informace najdete v adresáři /usr/share/doc, obzvláště v podadresářích
/usr/share/doc/HOWTO a /usr/share/doc/FAQ. Pokud chcete nahlásit chybu,
přečtěte si soubory /usr/share/doc/debian/bug*. Úpravy, které vývojáři provedli
v distribuovaných programech, jsou zdokumentovány v souborech /usr/share/doc/
(název balíčku)/README.Debian.

Webové stránky Debianu sdružují ohromné množství informací. V první řadě se
podívejte do Debian GNU/Linux FAQ a Debian Reference. Seznam další dokumentace
vztahující se k Debianu naleznete na stránkách Debian Documentation Project.
Ohromné množství informací obsahuje také archiv debianích diskusních listů.
Komunita okolo Debianu si navzájem pomáhá (uživatelé uživatelům), takže pokud
se chcete přihlásit k některému z Debianích diskusních listů, podívejte se na
stránku přihlášení do diskusních listů.

Základním zdrojem informací o Linuxu je Linux Documentation Project, kde mimo
jiné naleznete návody HOWTO (jak na to) a odkazy na další dokumenty o
jednotlivých částech systému GNU/Linux.

8.5. Nastavení poštovního systému

V dnešní době je elektronická pošta důležitou součástí našich životů. Protože
existuje spousty způsobů, jak poštu nastavit, a protože na ni spoléhají některé
nástroje, zkusíme zde pokrýt alespoň základy.

Poštovní systém se skládá ze tří částí. Uživateli nejbližší je klientský
program (MUA), jenž uživatel používá pro čtení a psaní pošty. Dále je zde
poštovní server (MTA), který se stará o přenos pošty mezi různými počítači. A
na závěr je zde doručovací agent (MDA), který se stará o doručení pošty do
uživatelovy schránky. Tyto tři funkce mohou vykonávat samostatné programy, nebo
mohou být sloučeny do dvou, případně jediného programu.

Na unixových systémech je historicky velmi populární MUA mutt a jako většina
tradičních programů je textový. Jako MTA se často používá exim nebo sendmail a
funkci MDA vykonává procmail nebo maildrop.

S rostoucí popularitou grafických desktopových prostředí se začíná používat
více grafických poštovních klientů jako evolution pro prostředí GNOME, kmail
pro prostředí KDE, nebo multiplatformní thunderbird. Tyto programy kombinují
funkce MUA, MTA a MDA dohromady, ale mohou být -- a často jsou -- používány v
kombinaci s tradičními unixovými nástroji.

8.5.1. Výchozí nastavení pošty

I když plánujete používat grafický poštovní program typu vše v jednom, je
důležité, aby byl nainstalován i tradiční MTA/MDA. Důvodem jsou různé nástroje^
[22], které mohou elektronickou poštou zasílat správci a/nebo uživatelům
důležitá upozornění.

K těmto účelům se při standardní instalaci (pokud jste nezrušili výběr úlohy "
standardní") nainstalují balíky exim4 a mutt. exim4 kombinuje MTA a MDA, je
relativně malý, jednoduchý na pochopení a zároveň je dostatečně pružný, aby
vyhověl i náročnějším požadavkům. Ve výchozí konfiguraci je nastaven tak, aby
zpracovával pouze lokální poštu (tj. tu, která vznikla na tomto systému) a
veškeré zprávy adresované systémovému správci (účet root) posílal na účet
běžného uživatele, který byl vytvořen během instalace^[23].

Pošta je při doručení přidána do souboru /var/mail/jmeno_uctu. Tuto poštu
můžete číst například programem mutt.

8.5.2. Odesílání pošty mimo systém

Jak bylo zmíněno dříve, po základní instalaci Debianu umí systém zpracovávat
pouze poštu pocházející ze stejného počítače. Odesílání nebo přijímání pošty z
jiných systémů není nastaveno.

Chcete-li, aby exim4 zpracovával i externí poštu, podívejte se na následující
podkapitolu, kde naleznete základní možnosti. Nezapomeňte pak otestovat, zda
odesílání a přijímání pošty funguje bez problému.

Jestliže plánujete používat grafický poštovní program ve spojení s poštovním
serverem vašeho poskytovatele Internetu nebo s poštovním serverem vaší firmy,
není důvod, abyste nastavovali exim4. Stačí nastavit grafický poštovní klient,
aby používal pro přijímání a odesílání správné poštovní servery (konkrétní
nastavení spadá mimo rozsah této příručky).

I při použití grafického poštovního klienta a externího poštovního serveru je
někdy potřeba nastavit některé konkrétní programu pro posílání pošty mimo
systém. Jedním z takových programů je nástroj reportbug, který zajišťuje
odesílání hlášení o chybách v Debianích balících. Ve výchozím nastavení
očekává, že bude pro odesílání chybových hlášení používat exim4.

Abyste reportbug přemluvili, aby používal externí poštovní server, spusťte
příkaz reportbug --configure a na otázku, zda je MTA dostupný, odpovězte "ne".
Poté budete dotázáni na SMTP server, který se má používat pro odesílání
chybových hlášení. Sem vyplňte stejné jméno nebo IP adresu, jakou jste zadali v
konfiguraci grafického poštovního klienta.

8.5.3. Nastavení poštovního serveru Exim4

V případě, že na svém systému chcete zpracovávat i externí poštu, musíte změnit
nastavení balíku exim4^[24]:

# dpkg-reconfigure exim4-config

Po zadání příkazu budete nejprve dotázáni, zda chcete rozdělit konfiguraci do
menších souborů. Pokud si nejste jisti, ponechte výchozí možnost.

Další obrazovka vám nabídne několik typických scénářů použití. Vyberte z nich
ten, který nejvíce odpovídá zamýšlenému použití:

internetový počítač

    Váš systém je připojen k počítačové síti a pošta je odesílána/přijímána
    přímo protokolem SMTP. Na následujících obrazovkách budete dotázáni několik
    základních údajů, jako je poštovní jméno nebo seznam domén, pro které
    chcete přijímat nebo předávat poštu.

odesílání pošty přes chytrý počítač

    Podle tohoto scénáře je veškerá odchozí pošta posílána "chytrému" počítači,
    který ji za vás rozešle. Chytrý počítač také často ukládá vaši příchozí
    poštu, tudíž nemusíte být neustále připojeni. To pak znamená, že poštu
    musíte číst na chytrém počítači, nebo ji z něj stahovat programem typu 
    fetchmail.

    Chytrý počítač obvykle bývá poštovní server vašeho poskytovatele připojení,
    což je obzvláště vhodné pro uživatele s vytáčeným připojením. Jinak to může
    být třeba firemní poštovní server, nebo i jiný počítač na vaší síti.

odesílání pošty přes chytrý počítač; žádná lokální pošta

    Tato volba je v podstatě shodná s předchozí, až na fakt, že systém nebude
    zpracovávat poštu pro lokální poštovní doménu. Zpracovávat se bude pouze
    pošta vzniklá na systému (např. pro systémového správce).

pouze lokální pošta

    Systém není připojen k síti a pošta se rozesílá pouze mezi lokálními
    uživateli. Tato volba je důrazně doporučena i když neplánujete posílání
    žádných zpráv, protože různé systémové nástroje mohou elektronickou poštou
    zasílat nejrůznější výstrahy a varování (například oblíbené "Překročili
    jste diskovou kvótu"). Tato volba je také vhodná pro nové uživatele,
    protože se neptá žádné další otázky.

žádné nastavení

    Tuto možnost vyberte jedině pokud přesně víte, co děláte, protože dokud
    poštovní systém nenastavíte, nebudete moci přijímat a odesílat žádnou poštu
    a můžete tak přijít o důležité zprávy od systémových programů.

Jestliže vám nevyhovuje žádný z nabízených scénářů, nebo pokud potřebujete
jemnější nastavení, budete muset ručně upravit konfigurační soubory v adresáři
/etc/exim4. Další informace o exim4 naleznete v adresáři /usr/share/doc/exim4.

Mějte však na paměti, že pokud nemáte oficiální doménové jméno, tak pošta
odesílaná přímo do Internetu může být protistranou odmítnuta jako ochrana proti
spammerům. Preferováno je posílání pošty přes poštovní server vašeho
poskytovatele připojení. Chcete-li přesto odesílat poštu přímo, možná bude
dobré použít jinou adresu, než tu, která byla vytvořena automaticky. S
poštovním serverem Exim můžete přidat nový záznam do /etc/email-addresses.

8.6. Kompilace nového jádra

Proč byste si chtěli sestavit nové jádro? Obvykle nejde o nutnost, poněvadž
jádro dodávané s Debianem funguje ve většině počítačů. V Debianu také bývají
dostupná alternativní jádra, která mohou odpovídat vašemu hardwaru lépe než
jádro výchozí, takže byste se na ně určitě měli podívat. Nicméně nové jádro
může být užitečné v následujících situacích:

  • Potřebujete vyřešit hardwarový konflikt zařízení nebo speciální nároky
    hardwaru, které dodávané jádro nezvládne.

  • Ve standardním jádře postrádáte podporu zařízení nebo nějakou službu (např.
    podporu vysoké paměti).

  • Chcete menší jádro bez ovladačů, které nepoužíváte. Urychlíte start systému
    a ušetříte paměť.

  • Chcete monolitické jádro místo modulárního.

  • Chcete jádro z vývojové řady.

  • Chcete se o jádře dozvědět něco víc.

8.6.1. Správa jader

Nebojte se kompilace jádra, je to zábava a budete z ní mít užitek.

Doporučený způsob kompilace jádra v Debianu vyžaduje tyto balíky: fakeroot,
kernel-package, linux-source-2.6 a další, které již máte patrně nainstalované
(úplný seznam je v souboru /usr/share/doc/kernel-package/README.gz).

Tato metoda vytvoří ze zdrojových textů jádra .deb balíček, a jestliže
používáte nestandardní moduly, taktéž z nich vyrobí aktuální balíčky. Při
instalaci balíčku se do adresáře /boot uloží pěkně pohromadě jádro, mapa
symbolů System.map a aktuální konfigurace.

Jádro nemusíte připravovat touto cestou, ale domníváme se, že s využitím
balíčkovacího softwaru se proces zjednoduší a je také bezpečnější. Místo balíku
linux-source-2.6 si klidně můžete stáhnout poslední zdrojové texty jádra přímo
od Linuse.

Popis balíku kernel-package se nachází v adresáři /usr/share/doc/
kernel-package. V následujících odstavcích najdete jen stručný úvod k jeho
použití.

V dalším budeme předpokládat, že zdrojové texty jádra verze 3.16 uložíte někam
do svého domovského adresáře.^[25] Přejděte do adresáře, kde chcete mít
zdrojové texty jádra (cd ~/build), rozbalte archiv (tar xf /usr/src/
linux-source-3.16.tar.xz) a vejděte do vzniklého adresáře (cd linux-source-3.16
/).

V prostředí X11 nakonfigurujte jádro příkazem make xconfig, nebo v terminálu
příkazem make menuconfig (musíte mít nainstalovaný balíček ncurses-dev).
Pročtěte si nápovědu a pozorně vybírejte z nabízených možností. Pokud si v
některém bodu nebudete vědět rady, je většinou lepší zařízení do jádra vložit.
Volby, kterým nerozumíte a které se nevztahují k hardwaru, raději nechte na
přednastavených hodnotách. Nezapomeňte do jádra zahrnout "Kernel module loader"
(tj. automatické vkládání modulů) v sekci "Loadable module support", které
přednastavené nebývá, avšak Debian tuto službu předpokládá.

Příkazem make-kpkg clean pročistíte strom zdrojových textů a vynulujete
předchozí nastavení balíku kernel-package.

Kompilaci jádra provedete příkazem fakeroot make-kpkg --initrd --revision=
1.0.moje kernel_image. Číslo verze "1.0.moje" si můžete zvolit podle vlastní
úvahy, slouží pouze k vaší orientaci v připravených balících. Kompilace zabere
chvíli času, záleží na výpočetním výkonu vašeho počítače.

Až kompilace skončí, jádro nainstalujete jako každý jiný balík. Jako root
napište dpkg -i ../linux-image-3.16-podarchitektura_1.0.moje_i386.deb.
podarchitektura je volitelné upřesnění architektury, např. "686", které jste
zadali při konfiguraci jádra. dpkg -i nainstaluje jádro spolu s doprovodnými
soubory. Jedná se třeba o soubory System.map, který je užitečný při dohledávání
problémů v jádře, a /boot/config-3.16 obsahující konfigurační soubor jádra.
Balík s jádrem je dostatečně chytrý, takže během instalace upraví zavaděč tak,
aby implicitně používal nové jádro. Pokud jste vytvořili balík s moduly (třeba
PCMCIA nebo lm-sensors), je nanejvýš vhodné ho také nainstalovat.

Nyní je čas spustit systém s novým jádrem. Projděte si chybové hlášky, které se
mohly při instalaci jádra vyskytnout, a pokud vše vypadá dobře, restartujte
příkazem shutdown -r now.

Více informací o debianích jádrech a o kompilaci jader si můžete přečíst v
Debian Linux Kernel Handbook. Popis balíku kernel-package najdete v adresáři /
usr/share/doc/kernel-package.

8.7. Obnovení poškozeného systému

Občas se věci pokazí a pečlivě instalovaný systém najednou nejde zavést. Možná
se při změně porušil zavaděč, možná není funkční nově instalované jádro, nebo
možná kosmické záření zasáhlo váš disk a v /sbin/init změnilo nějaký bit.
Pomineme-li příčinu toho, proč je váš systém pokažen, budete potřebovat funkční
systém, ze kterého můžete věci opravit. Jednou z možností je záchranný režim
instalačního systému.

Pro spuštění záchranného režimu vyberte ze zaváděcího menu položku rescue, na
výzvu boot: zadejte rescue, nebo použijte běžnou instalační metodu se zaváděcím
parametrem rescue/enable=true. Nejprve se zobrazí několik prvních obrazovek z
instalace, pouze v rohu obrazovky bude poznámka, že se jedná o záchranný režim.
Nepanikařte, váš stávající systém nebude přepsán. Záchranný režim jednoduše z
instalačního systému využije možnost automatického rozpoznání hardwaru, aby
zajistil, že budete mít při opravách přístup k vašim diskům, síťovým kartám, a
podobným užitečným zařízením.

Namísto nástroje pro dělení disků by se vám měl zobrazit seznam nalezených
oblastí s pobídkou, abyste jednu z oblastí vybrali. Obvykle byste měli vybrat
oblast, na které se nachází kořenový souborový systém, jež chcete opravit.
Kromě běžných "fyzických" oblastí můžete samozřejmě vybírat i oblasti "
virtuální" ležící na softwarovém RAIDu nebo LVM.

Pokud to bude jen trochu možné, instalátor vám nyní nabídne příkazový řádek ve
vybraném souborovém systému, který teď můžete použít pro provedení nezbytných
záchranných prací. Například potřebujete-li přeinstalovat zavaděč GRUB do
hlavního zaváděcího záznamu (MBR) prvního disku, můžete použít příkaz
grub-install '(hd0)'.

Pokud se nepodaří spustit použitelný příkazový řádek ve vybraném kořenovém
souborovém systému, je možné, že je souborový systém porušen. V takovém případě
se zobrazí dialog, který zobrazí varování a nabídne spuštění příkazového řádku
v prostředí instalačního systému. V tomto prostředí se nenachází příliš
nástrojů, ale k základní opravě systému často bohatě postačí. Vybraný kořenový
souborový systém bude připojen do adresáře /target.

V obou případech se po ukončení shellu systém restartuje.

Na závěr mějte na paměti, že oprava poškozených systémů může být obtížná a
popis všech možností, které mohou nastat, je mimo rozsah této příručky. Pokud
máte problémy, obraťte se na specialistu.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[21] S dřívějším init systémem SysV se příkaz halt choval stejně jako poweroff
, ale s init systémem systemd (výchozí od Debianu 8) se jejich chování změnilo.

^[22] cron, quota, logcheck, aide, ...

^[23] Přeposílání pošty uživatele root na účet běžného uživatele se nastavuje v
souboru /etc/aliases. Jestliže jste během instalace přeskočili vytvoření
běžného uživatele, pak bude pošta samozřejmě doručována přímo uživateli root.

^[24] Samozřejmě vám nic nebrání exim4 odstranit a nahradit alternativním MTA/
MDA.

^[25] Existují i jiná místa, kam můžete zdrojové texty jádra rozbalit, ale
použitá možnost je nejjednodušší a nevyžaduje žádná speciální práva.

Příloha A. Jak na instalaci

Obsah

A.1. Příprava
A.2. Zavedení instalačního programu

    A.2.1. CDROM
    A.2.2. USB Memory Stick
    A.2.3. Zavedení ze sítě
    A.2.4. Zavedení z pevného disku

A.3. Instalace
A.4. Pošlete nám zprávu o instalaci
A.5. A na závěr...

Tento dokument popisuje, jak nainstalovat Debian GNU/Linux buster pro
architekturu 32-bit PC ("i386") pomocí nového instalačního programu. Jedná se o
rychlého průvodce instalačním procesem, který by měl pokrýt většinu typických
instalací. V případech, kdy je vhodné sdělit více informací, se odkazujeme do
ostatních částí tohoto dokumentu.

A.1. Příprava

Zaznamenáte-li během instalace nějaké chyby, podívejte se do 5.4.7 - "Pošlete
nám zprávu o instalaci", kde naleznete instrukce, jak je nahlásit. Pokud máte
otázky, na které nemůžete nalézt odpovědi v tomto dokumentu, ptejte se v
diskuzní skupině debian-boot (debian-boot@lists.debian.org) nebo na IRC (kanál
#debian-boot v síti OFTC).

A.2. Zavedení instalačního programu

Tým debian-cd nabízí obrazy CD s debian-installerem na stránce Debian CD. Více
informací o získání CD naleznete v kapitole 4.1 - "Oficiální sada CD/DVD-ROM".

Některé metody instalace vyžadují jiné soubory než obrazy CD. Kapitola 4.2.1 -
"Kde se nalézají instalační obrazy?" vysvětluje, jak najít na zrcadlech Debianu
ty správné obrazy.

Následující podkapitoly osvětlují, které obrazy byste měli použít pro který typ
instalace.

A.2.1. CDROM

Populární volbou pro instalaci buster je obraz "síťového" CD. Tento obraz
slouží k zavedení instalačního systému z CD, instalaci minimálního funkčního
systému a k instalaci ostatních balíků ze sítě (proto mu říkáme "síťový").
Pokud byste raději nepoužili síť, můžete si stáhnout i plné CD, které k
instalaci síť nepotřebuje. (Z celé sady vám bude stačit pouze první obraz.)

Stáhněte si preferovaný obraz a vypalte jej na CD. Pro zavedení z CD možná
budete muset změnit nastavení v BIOSu, viz 3.6.1 - "Vyvolání menu systému BIOS"
.

A.2.2. USB Memory Stick

Instalovat můžete také z výměnných USB zařízení. Například USB klíčenka je
šikovným instalačním zařízením, které můžete nosit stále s sebou a velmi rychle
tak rozšiřovat řady počítačů s Debianem.

Nejjednodušší cestou k vytvoření USB klíčenky s instalačním systémem je
stáhnout libovolný CD/DVD obraz s instalací Debianu, který se na klíčenku vejde
a nakopírovat ho přímo na klíčenku. Tím samozřejmě zrušíte všechna data, která
na ní byla. Celé to funguje proto, že obrazy instalačních CD jsou "hybridní" a
umožňují zavádění jak z CD, tak z USB.

Funkční klíčenku s instalačním programem lze vyrobit více cestami, z nichž
některé jsou popsány v kapitole 4.3 - "Příprava souborů pro zavedení z USB
zařízení". (Například návod, jak použít klíčenku menší než 256 MB.)

Některé BIOSy umí zavádět přímo z USB, jiným je třeba pomoci. Hledejte menu,
které povolí zavádění z "removable drive" nebo "USB-ZIP". Užitečné tipy
naleznete v kapitole 5.1.1 - "Zavedení z USB "klíčenky"".

A.2.3. Zavedení ze sítě

Další z možností, jak zavést debian-installer je pomocí sítě. Konkrétní postup
závisí na vaší architektuře a síťovém prostředí. Obecně budete potřebovat
soubory z adresáře netboot/.

Nejjednodušší cesta je asi přes PXE. Do adresáře /srv/tftp (nebo jiného podle
vašeho tftp serveru) rozbalte soubor netboot/pxeboot.tar.gz. Nastavte DHCP
server, aby klientům předal název souboru pxelinux.0 a s trochou štěstí bude
vše fungovat samo. Podrobnější informace naleznete v kapitole 4.5 - "Příprava
souborů pro zavedení ze sítě pomocí TFTP".

A.2.4. Zavedení z pevného disku

Také je možné spustit instalační systém z pevného disku. Stáhněte si soubory
hd-media/initrd.gz, hd-media/vmlinuz a obraz instalačního CD do kořenového
adresáře pevného disku. Ujistěte se, že obraz CD má příponu .iso. Nyní již jen
stačí zavést stažené jádro vmlinuz spolu s jeho ramdiskem initrd. Postup
naleznete v kapitole 5.1.5 - "Zavedení z Linuxu programem LILO nebo GRUB".

A.3. Instalace

Po startu instalačního programu budete uvítáni úvodní obrazovkou. Nyní si
můžete buď přečíst návod pro různé způsoby zavádění (viz 5.3 - "Zaváděcí
parametry"), nebo jednoduše stisknout Enter a zavést instalaci.

Za chvíli budete vyzváni k výběru jazyka, ve kterém má instalace probíhat. Po
seznamu se můžete pohybovat šipkami, pro pokračování stiskněte Enter. Dále
budete dotázáni na výběr země. Pokud není požadovaná země v zobrazené nabídce,
můžete přejít do úplného seznamu zemí světa.

Můžete být vyzváni na potvrzení klávesnicového rozložení. Pokud si nejste
jisti, ponechte výchozí návrh.

Nyní se pohodlně usaďte a nechte debian-installer, aby rozpoznal základní
hardware a nahrál zbytek sebe sama z CD, disket, USB, apod.

Instalační program se pokusí rozpoznat síťová zařízení a nastavit síťování přes
DHCP. Pokud nejste připojeni k síti, nebo pokud nepoužíváte DHCP, budete mít
možnost nastavit síť ručně.

Dalším krokem je nastavení hodin a časového pásma. Instalátor se pokusí spojit
s časovým serverem na Internetu a nastavit přesný čas. Časové pásmo je vybráno
automaticky podle země, kterou jste zvolili dříve. Leží-li země v několika
časových pásmech, dostanete na výběr.

Následovat bude vytvoření uživatelských účtů, které po vás obvykle chce zadat
heslo pro správce systému (uživatel "root") a několik informací nutných pro
vytvoření účtu běžného uživatele. Jestliže necháte heslo uživatele "root"
prázdné, bude tento účet zakázán. Abyste mohli systém spravovat i bez uživatele
root, nainstaluje a nastaví se balík sudo tak, aby měl první zadaný uživatel
možnost zvýšit svá oprávnění.

Nyní je správný čas pro rozdělení disků. Nejprve vám bude nabídnuta možnost
automaticky rozdělit celý disk nebo dostupné volné místo na disku (viz kapitola
6.3.3.2 - "Asistované dělení"). Toto je doporučený způsob rozdělení disku pro
začátečníky nebo pro lidi ve spěchu. Pokud nechcete využít této možnosti,
vyberte z menu Ruční rozdělení.

Máte-li stávající DOSové nebo windowsové oblasti, které chcete zachovat, buďte
s automatickým dělením velmi opatrní. Pokud vyberete ruční dělení, můžete přímo
v instalačním programu měnit velikost stávajících NTFS a FAT oblastí a vytvořit
tak místo pro Debian; jednoduše vyberte oblast a zadejte její novou velikost.

Na další obrazovce uvidíte svou tabulku oblastí s informacemi o tom, jak budou
oblasti formátovány a kam budou připojeny. Pro změnu nastavení nebo pro smazání
oblasti ji jednoduše vyberte a proveďte požadovanou akci. Pokud jste využili
automatické dělení, mělo by stačit vybrat Ukončit rozdělování a zapsat změny na
disk. Nezapomeňte vytvořit alespoň jednu oblast pro odkládací prostor a
připojit kořenovou oblast na /. Více informací o dělení disku naleznete v
kapitole 6.3.3 - "Rozdělení disku a výběr přípojných bodů", obecnější informace
se nachází v dodatku C - "Poznámky k rozdělování disku".

Nyní debian-installer naformátuje oblasti a zahájí instalaci základního
systému, což může chvíli trvat. Následovat bude instalace jádra.

Základní systém je nyní funkční, avšak značně minimalistický. Další krok vám
tedy umožní doinstalovat další software pomocí předpřipravených úloh. Aby
systém věděl, odkud se mají balíky se softwarem nainstalovat, musí se nejprve
nastavit nástroj apt, který je za instalaci balíků zodpovědný. Ve výchozím
nastavení bude k instalaci vybrána úloha "Standardní systém", která doinstaluje
užitečný software pro textovou konzolu. Jestliže budete chtít nainstalovat
grafické prostředí, zvolte úlohu "Desktopové prostředí". Více o tomto kroku
naleznete v kapitole 6.3.5.2 - "Výběr a instalace softwaru".

Posledním krokem je instalace zavaděče. Pokud instalátor rozpozná na počítači
jiné operační systémy, přidá je do zaváděcího menu. Implicitně se GRUB
nainstaluje do hlavního zaváděcího záznamu prvního disku. K dispozici však máte
i možnost instalovat zavaděč kamkoliv jinam.

debian-installer vám oznámí, že instalace skončila. Vyjměte zaváděcí média
(např. CD) a restartujte počítač klávesou Enter. Měl by se spustit váš nově
nainstalovaný systém. Tato část je popsaná v 7 - "Zavedení vašeho nového
systému".

Pokud potřebujete k instalaci více informací, přečtěte si 6 - "Používáme
instalační program Debianu".

A.4. Pošlete nám zprávu o instalaci

Pokud jste zdárně dokončili instalaci Debianu, najděte si chvilku a pošlete nám
o tom krátkou zprávu. Nejjednodušší možností je nainstalovat si balík reportbug
(apt install reportbug), nastavit jej podle 8.5.2 - "Odesílání pošty mimo
systém" a spustit příkaz reportbug installation-reports.

Pokud instalaci nedokončili, pravděpodobně jste narazili na chybu v
debian-installeru. Abychom mohli tuto chybu odstranit a instalátor vylepšit,
potřebujeme o problémech vědět. Najděte si prosím chvilku a nalezené chyby
nahlaste (viz 5.4.6 - "Hlášení problémů s instalací").

A.5. A na závěr...

Doufáme, že se vám instalace Debianu líbí a že shledáváte Debian užitečným.
Nyní byste si možná chtěli přečíst kapitolu 8 - "Co dál?".

Příloha B. Automatizování instalací pomocí přednastavení

Obsah

B.1. Úvod

    B.1.1. Způsoby přednastavení
    B.1.2. Omezení

B.2. Použití

    B.2.1. Nahrání souboru s přednastavením
    B.2.2. Použití zaváděcích parametrů jako formy přednastavení
    B.2.3. Automatický režim
    B.2.4. Užitečné aliasy
    B.2.5. Použití DHCP serveru pro určení souboru s přednastavením

B.3. Vytvoření souboru s přednastavením
B.4. Obsah souboru s přednastavením (pro buster)

    B.4.1. Lokalizace
    B.4.2. Nastavení sítě
    B.4.3. Síťová konzole
    B.4.4. Nastavení zrcadla
    B.4.5. Nastavení účtů
    B.4.6. Nastavení hodin a časového pásma
    B.4.7. Rozdělení disku
    B.4.8. Instalace základního systému
    B.4.9. Nastavení APT
    B.4.10. Výběr balíků
    B.4.11. Instalace zavaděče
    B.4.12. Dokončení instalace
    B.4.13. Přednastavení ostatních balíků

B.5. Pokročilé možnosti

    B.5.1. Spouštění vlastních příkazů během instalace
    B.5.2. Použití přednastavení pro změnu výchozích hodnot
    B.5.3. Zřetězené nahrávání souborů s přednastavením

Tento dodatek vysvětluje taje a záludnosti přednastavení odpovědí na otázky
debian-installeru za účelem zautomatizování instalačního procesu.

Útržky konfigurace použité v této části jsou také dostupné jako samostatný
soubor na ../example-preseed.txt.

B.1. Úvod

Přednastavení nabízí možnost předem odpovědět na otázky, které se ptá
instalační program. Díky tomu pak nemusíte do většiny instalací zasahovat a
dokonce můžete využít některých vlastností, které jinak nejsou dostupné.

Přednastavení není povinné. Použijete-li prázdný soubor s odpověďmi, instalace
bude probíhat úplně stejně jako při běžné instalaci. Každá otázka, kterou
přednastavíte, jistým způsobem odchýlí instalaci od standardní cesty.

B.1.1. Způsoby přednastavení

Přednastavení existuje ve třech variantách: initrd, soubor a síť. Initrd
funguje s každým typem instalace, podporuje přednastavení více odpovědí, ovšem
vyžaduje nejvíce příprav. Přednastavení přes lokální soubor nebo přes síť se
používají pro různé typy instalací.

Následující tabulka ukazuje, které způsoby přednastavení fungují s kterými
způsoby instalací.

┌─────────────────────────────────────────────────┬───────┬───────┬─────────┐
│                Způsob instalace                 │initrd │soubor │   síť   │
├─────────────────────────────────────────────────┼───────┼───────┼─────────┤
│CD/DVD                                           │ano    │ano    │ano^[a]  │
├─────────────────────────────────────────────────┼───────┼───────┼─────────┤
│zavedení ze sítě                                 │ano    │ne     │ano      │
├─────────────────────────────────────────────────┼───────┼───────┼─────────┤
│z pevného disku (včetně usb klíčenky)            │ano    │ano    │ano^[a]  │
├─────────────────────────────────────────────────┴───────┴───────┴─────────┤
│^[a] Ovšem pouze pokud máte přístup k síti a správně nastavíte preseed/url.│
└───────────────────────────────────────────────────────────────────────────┘

U jednotlivých způsobů přednastavení je významný okamžik, kdy je soubor nahrán
a zpracován. Pro initrd to je okamžitě po startu instalace, ještě před první
otázkou. Přednastavení pomocí zaváděcích parametrů jádra se děje hned poté a je
tedy možné přepsat odpověd nachystanou v initrd přidáním parametru na
příkazovou řádku jádra (buď v konfiguračním souboru zavaděče, nebo ručně při
zavádění). Přednastavení v lokálním souboru se načte po připojení CD nebo jeho
obrazu. Přednastavení ze sítě je evidentně dostupné až po nastavení sítě.

Prakticky to znamená, že přednastavení pomocí souboru a sítě se nahraje zobrazí
až po zodpovězení otázek ohledně jazyka, země a klávesnice. (V případě
přednastavení ze sítě navíc až po všech otázkách týkajících se síťového
nastavení.) Instalujete-li se střední nebo nízkou prioritou, do cesty se vám
připletou ještě otázky ohledně rozpoznávání hardwaru.

Abyste mohli přednastavit i otázky, které se zobrazují před nahráním souboru s
přednastavením, můžete využít zaváděcí parametry jádra, viz část B.2.2 -
"Použití zaváděcích parametrů jako formy přednastavení".

Jinou možností, jak se vyhnout otázkám, které se zobrazují před nahráním
souboru s přednastavením, je spustit instalátor v "automatickém" režimu. Tím se
odsunou všechny brzké otázky až za okamžik nahození sítě a navíc se zobrazí jen
otázky s kritickou prioritou, což odfiltruje několik zbytečných otázek.
Podrobnosti naleznete v B.2.3 - "Automatický režim".

B.1.2. Omezení

Přestože takto můžete přednastavit většinu otázek debian-installeru, existuje
několik výjimek. Při dělení disku musíte rozdělit buď celý disk, nebo použít
stávající volné místo -- není možné použít existující oblasti.

B.2. Použití

Nejprve samozřejmě musíte vytvořit soubor s přednastavením a umístit jej na
vhodné místo, odkud jej budete používat. O vytvoření souboru se dočtete dále v
této příručce. Umístění souboru na vhodné místo je různě složité podle
použitého způsobu. V případě, že budete soubor s přednastavením načítat ze
sítě, z diskety nebo usb klíčenky, je jeho umístění zřejmé. Chcete-li soubor
umístit na CD nebo DVD, budete muset znovu sestavit celý ISO obraz. Umístění
souboru s přednastavením přímo do initrd je mimo rozsah tohoto dokumentu a
musíme vás odkázat na vývojářskou dokumentaci k debian-installeru.

Ukázkový soubor s přednastavením, jež můžete využít jako základ pro své pokusy,
naleznete na ../example-preseed.txt. Tento soubor je poskládán z ukázek
prezentovaných v tomto dodatku.

B.2.1. Nahrání souboru s přednastavením

Používáte-li přednastavení z initrd, musíte zajistit, aby se soubor jmenoval
preseed.cfg a aby se nacházel v kořenovém adresáři initrd. O vše ostatní se
postará instalační program. Ten se podívá, zda je soubor přítomen, a pokud ano,
tak jej nahraje.

U zbývajících způsobů přednastavení musíte instalátoru říci, který soubor má
použít. Toho dosáhnete parametrem, který předáte jádru buď ručně při zavádění,
nebo skrze soubor zavaděče (např. syslinux.cfg), kde na konec řádku append
přidáte příslušný parametr.

Pokud to váš zavaděč umožňuje, nemusí být od věci jej nastavit tak, aby nečekal
se zavedením instalačního systému na stisk klávesy Enter, ale aby dále
pokračoval automaticky. V případě syslinuxu to znamená nastavit v souboru
syslinux.cfg parametr timeout na hodnotu 1.

Abyste měli jistotu, že instalátor dostane správný soubor, můžete zadat jeho
kontrolní součet. V současnosti to musí být md5 součet. Pokud zadaný součet a
vypočítaný součet souboru nebudou souhlasit, instalátor odmítne tento soubor
použít.

Zaváděcí parametry:
- pro zavádění ze sítě:
  preseed/url=http://pocitac/cesta/k/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d
- nebo
  preseed/url=tftp://pocitac/cesta/k/preseed.cfg
  preseed/url/checksum=5da499872becccfeda2c4872f9171c3d

- pro zavádění z upraveného CD:
  preseed/file=/cdrom/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

- pro zavádění z USB média (soubor s přednastavením je
  v kořenovém adresáři USB média):
  preseed/file=/hd-media/preseed.cfg
  preseed/file/checksum=5da499872becccfeda2c4872f9171c3d

Pokud zadáte preseed/url nebo preseed/file jako zaváděcí parametr, můžete
použít zkrácenou verzi url, resp. file. Obdobně lze zkrátit preseed/file/
checksum na pouhé preseed-md5.

B.2.2. Použití zaváděcích parametrů jako formy přednastavení

I když nemůžete přednastavit některé kroky připravenými odpověďmi v souboru,
stále můžete dosáhnout plně automatické instalace, protože můžete zadat hodnoty
pro přednastavení jako zaváděcí parametry jádra. Zaváděcí parametry jádra
můžete též využít v případě, kdy nechcete použít celé přednastavení, ale jen
předodpovědět nějakou konkrétní otázku.

Pro nastavení hodnoty libovolné proměnné zmíněné v tomto dodatku stačí zadat
cesta/k/proměnné=hodnota. Jestliže se má hodnota použít k přednastavení balíku
v cílovém systému, musíte předřadit ještě vlastníka^[26] proměnné vlastník:
cesta/k/proměnné=hodnota. Nezadáte-li vlastníka, hodnota proměnné se
nezkopíruje do databáze debconfu v cílovém systému a tudíž zůstane při
konfiguraci daného balíku nevyužita.

Předzodpovězení otázky popsaným způsobem způsobí, že se tato otázka nezobrazí.
Chcete-li otázce přednastavit konkrétní odpověď, ale přesto chcete, aby se
otázka zobrazila, použijte místo "=" operátor "?=". Více též B.5.2 - "Použití
přednastavení pro změnu výchozích hodnot".

Některé často používané proměnné mohou mít i kratší variantu, Pokud je tato
varianta dostupná, upřednostňujeme ji zde před úplnou formou. Konkrétně
proměnnou preseed/url zde zkracujeme na url. Jiným příkladem je alias tasks,
který vlastně znamená tasksel:tasksel/first.

Tři pomlčky "---" mají u zaváděcích parametrů jádra speciální význam. Všechny
parametry nacházející se za posledními pomlčkami budou zkopírovány do
konfigurace zavaděče v instalovaném systému. (Pokud to instalátor pro daný
zavaděč umožňuje.) Parametry, které instalátor rozpozná (např. volby pro
přednastavení), budou automaticky odfiltrovány.

Poznámka

Aktuální jádra (2.6.9 a novější) akceptují nejvýše 32 parametrů a 32 proměnných
prostředí (včetně standardních voleb pro instalační program). Pokud tento limit
překročíte, jádro zpanikaří. (Dřívější jádra měla tyto limity ještě menší.)

Pro většinu instalací můžete celkem bez problémů odstranit implicitní volby
jako vga=normal, což vám umožní přidat další volby pro přednastavení.

Poznámka

V některých případech není možné zadat hodnotu obsahující mezeru, a to i v
případě, kdy hodnotu obklopíte uvozovkami.

B.2.3. Automatický režim

Díky několika pokročilým (někteří říkají zmateným) vlastnostem instalačního
systém Debianu je možné, aby se poměrně jednoduchý zaváděcí parametr rozvinul
do komplexní a na míru upravené automatické instalace.

Zařizuje to zaváděci volba Automated install, na některých architekturách nebo
zavaděčích nazývaná též auto. V této části příručky tedy řetězec auto není
zaváděcím parametrem, ale návěstím zavaděče, které připojí příslušné zaváděcí
parametry. Více o tom, jak přidat zaváděcí parametr, se dočtete v kapitole
5.1.7 - "Zaváděcí obrazovka".

Pro ilustraci uvádíme několik příkladů, které můžete zadat na zaváděcí výzvě.

auto url=autoserver

Toto spoléhá na fakt, že na síti existuje DHCP server, který dostane počítač do
bodu, kdy bude možné přes DNS přeložit jméno autoserver. Pokud DHCP server
poskytnul i název domény, tak se zkusí i varianta, kdy se za název počítače
přidá právě poskytnutá doména. Například pokud je přes DHCP poskytnuta doména
priklad.cz, vyústí to ve stažení souboru s přednastavením z adresy http://
autoserver.priklad.cz/d-i/buster/./preseed.cfg.

Poslední část url (d-i/buster/./preseed.cfg) pochází z proměnné auto-install/
defaultroot. Proměnná implicitně obsahuje adresář buster, aby jste s příchodem
novějších verzí Debianu a nových kódových označení nemigrovali na nové verze
automaticky, ale kontrolovaněji (po explicitním zadání nového kódového jména).
Část /./ indikuje kořen, vůči kterému můžete zadávat relativní cesty (používá
se v preseed/include a preseed/run). To umožňuje zadávat cesty k souborům jako
kompletní URL, cesty začínající na / jsou připojeny ke kořenu, nebo jako cesty
relativní k umístění, kde byl nalezen poslední soubor s přednastavením. To
umožňuje vytvářet přenositelnější skripty, kde můžete přesouvat celé hierarchie
skriptů na nová umístění, aniž by se co pokazilo. Například můžete na USB
klíčenku přesunout soubory, které se dříve používaly na webovém serveru.
Předpokládejme, že je v souboru s přednastavením nastavena proměnná preseed/run
na hodnotu /scripts/late_command.sh. Pak v naší ukázce bude zmíněný soubor
stažen z http://autoserver.priklad.cz/d-i/buster/./scripts/late_command.sh.

Pokud na dané síti není vybudovaná vhodná DHCP a DNS infrastruktura, nebo pokud
nechcete použít výchozí cestu k souboru preseed.cfg, můžete zadat explicitní
URL. Nebude-li URL obsahovat prvek /./, bude automaticky připojen na začátek
cesty, tj. za třetí lomítko URL. Příklad vyžadující jen minimální podporu od
místní síťové infrastruktury:

auto url=http://192.168.1.2/cesta/k/preseed.souboru

Celé to funguje tak, že

  • pokud v URL chybí protokol, předpokládá se http,

  • pokud název počítače neobsahuje tečky, připojí se k němu doména odvozená z
    DHCP a

  • pokud za názvem počítače není žádné lomítko, přidá se výchozí cesta.

Kromě zadávání URL můžete zadat i parametry, které přímo neovlivňují chování
debian-installeru samotného, ale které mohou být předány do skriptů spouštěných
z nahraného souboru s přednastavením pomocí preseed/run. V současnosti to je
pouze auto-install/classes, ve zkrácené verzi classes. Příklad použití:

auto url=autoserver classes=trida_A;trida_B

Třídy mohou například označovat typ systému, který se má instalovat, nebo
jazykové prostředí, které se má nastavit.

Tento koncept je možné dále rozšiřovat. Pokud toho ve svých skriptech
využijete, je rozumné použít jmenný prostor auto-install, například
auto-install/style. Jestliže si myslíte, že máte pro další parametr vhodné
využití, zmiňte se o něm v diskusní skupině <debian-boot@lists.debian.org>,
abychom předešli konfliktům v jmenném prostoru (a případně vám přidali kratší
alias).

Příkaz auto zatím není definován na všech architekturách. Stejného výsledku
však můžete dosáhnout přidáním dvou parametrů auto=true priority=critical k
parametrům jádra. Parametr jádra auto je vlastně alias pro auto-install/enable
a potlačuje zobrazení otázek ohledně místního prostředí a nastavení klávesnice
až do bodu, kdy je bude možné přednastavit. Parametr priority je alias pro
debconf/priority a nastavením na hodnotu critical zajistíte, aby se zobrazovaly
pouze otázky s kritickou prioritou, kterých při instalaci moc není.

Další parametry, které se mohou hodit při automatizaci instalací přes DHCP,
jsou interface=auto netcfg/dhcp_timeout=60, které způsobí, že se k instalaci
použije první funkční síťové rozhraní a že instalátor bude trpělivější při
čekání na odpovědi od DHCP serveru.

Tip

Rozsáhlý příklad použití této infrastruktury naleznete na webových stránkách
autora. Kromě ukázkových skriptů a tříd tam také naleznete zajímavé výsledky
kreativního použití přednastavení.

B.2.4. Užitečné aliasy

Při použití (automatického) přednastavení se mohou hodit následující aliasy.
Poznamenejme, že aliasy zkracují pouze jméno otázky. Vždy je třeba přidat ještě
hodnotu, například auto=true nebo interface=eth0.

priority    debconf/priority
fb          debian-installer/framebuffer
language    debian-installer/language
country     debian-installer/country
locale      debian-installer/locale
theme       debian-installer/theme
auto        auto-install/enable
classes     auto-install/classes
file        preseed/file
url         preseed/url
domain      netcfg/get_domain
hostname    netcfg/get_hostname
interface   netcfg/choose_interface
protocol    mirror/protocol
suite       mirror/suite
modules     anna/choose_modules
recommends  base-installer/install-recommends
tasks       tasksel:tasksel/first
desktop     tasksel:tasksel/desktop
dmraid      disk-detect/dmraid/enable
keymap      keyboard-configuration/xkb-keymap
preseed-md5 preseed/file/checksum

B.2.5. Použití DHCP serveru pro určení souboru s přednastavením

Jelikož DHCP umí předávat jméno souboru, je možné toho zneužít pro určení
souboru s přednastavením. Obvykle se totiž tato možnost používá pro určení
souboru, kterým se zavede systém ze sítě. Pokud ale bude soubor ve formě URL,
instalace to rozpozná a pokusí se soubor stáhnout a použít jako soubor s
přednastavením. Následující příkaz ukazuje, jak upravit konfigurační soubor
dhcpd.conf serveru ISC DHCP verze 3 (balík isc-dhcp-server).

if substring (option vendor-class-identifier, 0, 3) = "d-i" {
    filename "http://pocitac/preseed.cfg";
}

Všimněte si, že předchozí příklad omezuje použití na DHCP klienty, kteří se
identifikují jako "d-i", takže by to nemělo ovlivnit běžné DHCP klienty, ale
pouze instalace. Direktivu filename můžete zadat například i do sekce pro
jediný počítač, takže neovlivníte ostatní instalace na síti.

K dobrým zvykům při přednastavování přes DHCP patří přednastavení pouze hodnot,
které jsou specifické pro vaši síť, jako je např. lokální zrcadlo. Tím se při
instalaci automaticky vybere správné zrcadlo, ale zbytek instalace probíhá
interaktivně. Kompletní přednastavení přes DHCP byste měli provádět pouze s
nejvyšší opatrností.

B.3. Vytvoření souboru s přednastavením

Soubor s přednastavením soubor má stejný formát jako používá příkaz 
debconf-set-selections. Běžný řádek pak má tvar

<vlastník> <jméno otázky> <typ otázky> <hodnota>

Soubor by měl začínat komentářem #_preseed_V1

Při vytváření souboru s přednastavením byste měli mít na paměti několik
pravidel.

  • Mezi typ a hodnotu vkládejte pouze jednu mezeru nebo tabulátor -- případné
    další bílé znaky budou považovány za součást hodnoty.

  • Dlouhý řádek můžete pro lepší čitelnost rozdělit na několik řádků tak, že
    na konec řádku přidáte znak pro pokračování řádku "\" (zpětné lomítko). Je
    vhodné rozdělit řádek mezi názvem a typem otázky, ne mezi typem a hodnotou.
    Po spojení řádků bude bílé místo ze začátku/konce řádku spojeno do jediné
    mezery.

  • Pro debconf proměnné (šablony), které jsou součástí pouze samotného
    instalačního programu, by měl být vlastník nastaven na "d-i". Pro
    přednastavení ostatních proměnných používaných během instalace by se měl
    jako vlastník používat název balíku, který obsahuje příslušnou šablonu. Do
    debconf databáze v nainstalovaném systému se přenesou pouze proměnné, které
    mají jako vlastníka nastaveno něco jiného než "d-i".

  • Většina otázek vyžaduje zadání hodnot v angličtině, avšak existují výjimky
    jako třeba partman, kde musíte použít přeložené hodnoty.

  • Dále pak některé otázky vyžadují hodnotu formou kódu (a ne text, který se
    zobrazuje během instalace).

  • Na začátku souboru uveďte #_preseed_V1

Nejjednodušší způsob vytvoření souboru s přednastavením je použít ukázkový
soubor z B.4 - "Obsah souboru s přednastavením (pro buster)" jako základ a
upravit si jej dle potřeb.

Jiná možnost je provést ruční instalaci a po restartu do nového systému použít
příkaz debconf-get-selections (z balíku debconf-utils) a uložit databázi
debconfu i cdebconfu do jediného souboru:

$ echo "#_preseed_V1" > soubor
$ debconf-get-selections --installer >> soubor
$ debconf-get-selections >> soubor

Tento přístup má tu nevýhodu, že vytvořený soubor bude obsahovat i položky,
které by se neměly přednastavovat. Z tohoto pohledu je pro většinu uživatelů
vhodnější použití ukázkového souboru.

Poznámka

Tento způsob se spoléhá na fakt, že se na konci instalace uloží databáze
cdebconfu do instalovaného systému do souboru /var/log/installer/cdebconf.
Protože tato databáze může obsahovat důvěrné informace, jsou tyto soubory
čitelné pouze pro uživatele root.

Pokud ze systému vyčistíte balík installation-report, bude smazán také adresář
/var/log/installer.

Seznam možných hodnot pro otázky můžete zjistit během instalace ze souborů
umístěných v adresáři /var/lib/cdebconf (např. pomocí editoru nano). Samotné
šablony se nachází v souboru templates.dat, aktuální hodnoty naleznete v
souboru questions.dat.

Ještě před instalací je vhodné zkontrolovat formát předkonfiguračního souboru
příkazem debconf-set-selections -c preseed.cfg.

B.4. Obsah souboru s přednastavením (pro buster)

Útržky konfigurace použité v této části jsou také dostupné jako samostatný
soubor na ../example-preseed.txt.

Tento příklad je založen na instalaci pro architekturu Intel x86. Jestliže
instalujete na jinou architekturu, nemusí některá nastavení odpovídat těm
uvedeným (výběr klávesnice, instalace zavaděče) a budete je muset nahradit
adekvátními hodnotami.

Podrobnosti o tom, jak jednotlivé komponenty instalačního systému pracují,
naleznete v kapitole 6.3 - "Použití jednotlivých komponent".

B.4.1. Lokalizace

Nastavení lokalizačních proměnných bude fungovat pouze v případě, když
používáte přednastavení přes initrd, nebo pomocí zaváděcích parametrů jádra. U
ostatních způsobů se totiž soubor s přednastavením nahraje až po zobrazení
těchto otázek. Výjimkou je automatický režim (B.2.3 - "Automatický režim"),
který odsune otázky ohledně lokalizace na později a umožní je tak přednastavit
všemi známými způsoby.

Místní prostření (locale) slouží k současnému zadání jazyka i země. Například
pomocí zaváděcího parametru jádra můžete zadat locale=cs_CZ.

Tento způsob je velice jednoduchý, ale neumožňuje přednastavit všechny možné
kombinace jazyka, země a místního prostředí^[27]. Volitelně tedy můžete
přednastavit jednotlivé proměnné.

# Přednastavením locale se automaticky nastaví jazyk, země a locale.
d-i debian-installer/locale string cs_CZ

# Pro větší pružnost je též možno nastavit hodnoty samostatně.
#d-i debian-installer/language string en
#d-i debian-installer/country string NL
#d-i debian-installer/locale string en_GB.UTF-8
# Volitelně můžete zadat další locale, která se mají vygenerovat.
#d-i localechooser/supported-locales multiselect cs_CZ.UTF-8, en_US.UTF-8

Zadat můžete libovolnou kombinaci jazyka podporovaného v debian-installer a
země. Pokud kombinace netvoří platné prostředí, vybere instalační systém
kombinaci tak, že se pokusí zachovat jazyk a k němu vybere platnou zemi.

Nastavení klávesnice se skládá z výběru klávesové mapy a přepínače mezi
zvolenou mapou a US variantou. Během instalace jsou dostupné pouze základní
klávesové mapy. Ostatní dostupné varianty naleznete až v nainstalovaném systému
příkazem dpkg-reconfigure keyboard-configuration.

# Výběr klávesnice.
d-i keyboard-configuration/xkb-keymap select cz
# d-i keyboard-configuration/toggle select No toggling

Nastavení klávesnice můžete přeskočit nastavením proměnné keymap na hodnotu
skip-config. Tím se zachová výchozí klávesová mapa jádra.

B.4.2. Nastavení sítě

Pokud nahráváte soubor s přednastavením ze sítě, pak následující samozřejmě
nebude fungovat! V takovém případě zadejte potřebné parametry sítě zavaděči
jádra. Zavádíte-li z CD nebo USB, bude nastavení fungovat bez problémů.

Potřebujete-li při zavádění ze sítě vybrat konkrétní síťové rozhraní ještě před
nahráním souboru s přednastavením, použijte zaváděcí parametr interface=eth1.

Přestože přednastavení síťování není běžně dostupné při přednastavení ze sítě
(tj. při použití "preseed/url"), můžete to obejít následujícím hackem (např.
pokud chcete síťovému rozhraní nastavit statickou adresu). Hack spočívá ve
vynucení opětovné konfigurace sítě po načtení souboru s přednastavením. Stačí
vytvořit skript pro "preseed/run" obsahující následující příkazy:

kill-all-dhcp; netcfg

Pro nastavení sítě lze využít následující proměnné:

# Kompletně zakáže nastavení sítě. Hodí se pro instalace z CD
# na nezasíťovaných zařízeních, kde by byly síťové otázky,
# varování o nedostupné síti a dlouhé čekací doby na obtíž.
#d-i netcfg/enable boolean false

# netcfg zkusí použít rozhraní, jehož druhý konec je aktivní
# a tím pádem přeskočí výběr ze seznamu nalezených rozhraní.
d-i netcfg/choose_interface select auto

# Výběr konkrétního síťového rozhraní:
#d-i netcfg/choose_interface select eth1

# Rozpoznání aktivního síťového připojení může někdy trvat déle než
# výchozí 3 sekundy. V takovém případě pomůže zvýšení této hodnoty.
#d-i netcfg/link_wait_timeout string 10

# Máte-li pomalejší dhcp server a instalačnímu systému vyprší čas při
# čekání na odpověď, bude užitečné následující.
#d-i netcfg/dhcp_timeout string 60
#d-i netcfg/dhcpv6_timeout string 60

# Pokud dáváte přednost ručnímu nastavení sítě:
#d-i netcfg/disable_autoconfig boolean true

# Má-li tento soubor s přednastavením fungovat na systémech s i bez
# dhcp serveru, odkomentujte následující řádky a také statické
# nastavení sítě níže.
#d-i netcfg/dhcp_failed note
#d-i netcfg/dhcp_options select Configure network manually

# Statické nastavení sítě.
#
# Příklad IPv4
#d-i netcfg/get_ipaddress string 192.168.1.42
#d-i netcfg/get_netmask string 255.255.255.0
#d-i netcfg/get_gateway string 192.168.1.1
#d-i netcfg/get_nameservers string 192.168.1.1
#d-i netcfg/confirm_static boolean true
#
# Příklad IPv6
#d-i netcfg/get_ipaddress string fc00::2
#d-i netcfg/get_netmask string ffff:ffff:ffff:ffff::
#d-i netcfg/get_gateway string fc00::1
#d-i netcfg/get_nameservers string fc00::1
#d-i netcfg/confirm_static boolean true

# Název počítače a domény přiřazené přes DHCP mají větší prioritu než
# hodnoty nastavené zde, nicméně takto máte jistotu, že tato otázka
# nezobrazí (ať už nastavení z DHCP obdržíme nebo ne).
d-i netcfg/get_hostname string nenastavene-jmeno
d-i netcfg/get_domain string nenastavena-domena

# Chcete-li vynutit konkrétní název počítače bez ohledu na to, co
# nabídne DHCP server, odkomentujte následující řádku.
#d-i netcfg/hostname string nejakejmeno

# Zakáže otravný dialog o WEP klíči.
d-i netcfg/wireless_wep string
# Praštěné DHCP jméno počítače, které používají někteří ISP jako heslo.
#d-i netcfg/dhcp_hostname string radish

# Pokud síťová karta nebo jiný hardware vyžaduje nesvobodný firmware,
# můžete říct instalátoru, aby se vždy pokusil firmware nahrát bez
# dalšího dotazování. Chcete-li nahrávání i dotazování zakázat,
# nastavte na hodnotu false.
#d-i hw-detect/load_firmware boolean true

Pokud není proměnná netcfg/get_netmask přednastavená, netcfg si síťovou masku
dopočítá automaticky. Pro plně automatické instalace musíte v takovém případě
nastavit proměnnou jako seen, aby instalace nečekala na potvrzení spočítané
masky. Obdobně je možné nepřednastavovat proměnnou netcfg/get_gateway a nechat 
netcfg, aby automaticky automaticky odhadl adresu brány. Jako speciální případ
je možné nastavit proměnnou netcfg/get_gateway na hodnotu "none", což znamená,
že se brána nemá použít vůbec.

B.4.3. Síťová konzole

# Následující nastavení se hodí v situacích, kdy chcete instalovat
# vzdáleně přes SSH pomocí komponenty network-console.
# Toto přednastavení má smysl pouze pokud plánujete dokončit
# instalaci ručně.
#d-i anna/choose_modules string network-console
#d-i network-console/authorized_keys_url string http://10.0.0.1/openssh-key
#d-i network-console/password password r00tme
#d-i network-console/password-again password r00tme

B.4.4. Nastavení zrcadla

V závislosti na způsobu instalace můžete zrcadlo použít pro stažení dodatečných
komponent instalačního systému, stažení základního systému a pro nastavení
souboru /etc/apt/sources.list.

Parametr mirror/suite určuje verzi instalovaného systému.

Parametr mirror/udeb/suite určuje verzi Debianu, ze které se stáhnou dodatečné
komponenty instalačního systému. Nastavení této proměnné má smysl pouze v
případě, že komponenty stahujete ze sítě a potřebujete, aby odpovídaly verzi
initrd, který se používá pro instalaci. Instalační systém obvykle zvolí
správnou hodnotu, takže by neměl být důvod tuto proměnnou měnit.

# Zvolíte-li ftp, nemusíte nastavovat mirror/country
#d-i mirror/protocol string ftp
d-i mirror/country string manual
d-i mirror/http/hostname string ftp.cz.debian.org
d-i mirror/http/directory string /debian
d-i mirror/http/proxy string

# Verze pro instalaci.
#d-i mirror/suite string testing
# Verze, ze které nahrát komponenty instalátoru (volitelné).
#d-i mirror/udeb/suite string testing

B.4.5. Nastavení účtů

Instalační systém umožňuje přednastavit jak heslo uživatele root, tak jméno a
heslo prvního běžného uživatele systému. Heslo můžete zadat buď v nešifrované
podobě, nebo jako crypt(3) hash.

Varování

Přednastavení hesel není bezpečné, protože kdokoliv s přístupem k souboru s
přednastavením si tato hesla může přečíst. Z pohledu bezpečnosti je použití
hashů lepší, ovšem vzhledem k možným útokům hrubou silou je třeba zvolit silný
algoritmus jako SHA-256 nebo SHA512. Dřívější hashovací algoritmy jako DES a
MD5 jsou považovány za slabé.

# Přeskočí vytvoření účtu pro roota (běžný uživatel bude moci použít
# sudo).
#d-i passwd/root-login boolean false
# Volitelně přeskočí vytvoření běžného uživatelského účtu.
#d-i passwd/make-user boolean false

# Rootovo heslo v čitelném tvaru
#d-i passwd/root-password password r00tme
#d-i passwd/root-password-again password r00tme
# nebo šifrované pomocí crypt(3) hashe.
#d-i passwd/root-password-crypted password [crypt(3) hash]

# Vytvoření účtu běžného uživatele.
#d-i passwd/user-fullname string Jan Novak
#d-i passwd/username string jan
# Heslo běžného uživatele v čitelném tvaru
#d-i passwd/user-password password nebezpecne
#d-i passwd/user-password-again password nebezpecne
# nebo šifrované pomocí crypt(3) hashe.
#d-i passwd/user-password-crypted password [crypt(3) hash]
# Nastaví UID běžného uživatele (jinak se použije výchozí hodnota).
#d-i passwd/user-uid string 1010
# Uživatelský účet bude automaticky přidán do několika standardních
# skupin. Chcete-li to změnit, zadejte seznam požadovaných skupin.
#d-i passwd/user-default-groups string audio cdrom video

Do proměnných passwd/root-password-crypted a passwd/user-password-crypted
můžete jako hodnotu zadat znak vykřičník "!", což znamená, že daný účet bude
zakázán. To se může hodit například pro účet root, což ovšem předpokládá, že
máte nastavenu nějakou jinou možnost, jak počítač spravovat (například pomocí 
sudo nebo autentizace přes SSH klíče).

SHA-512 hash hesla můžete vygenerovat následujícím příkazem (z balíku whois):

mkpasswd -m sha-512

B.4.6. Nastavení hodin a časového pásma

# Určuje, zda jsou hardwarové hodiny nastaveny na UTC.
d-i clock-setup/utc boolean true

# Proměnnou můžete nastavit na libovolnou platnou hodnotu $TZ;
# Seznam časových pásem naleznete v /usr/share/zoneinfo/.
d-i time/zone string Europe/Prague

# Určuje, zda se mají při instalaci nastavit hodiny pomocí NTP.
d-i clock-setup/ntp boolean true
# NTP server, který se má použít. Výchozí hodnota je většinou
# dostačující.
#d-i clock-setup/ntp-server string tak.cesnet.cz

B.4.7. Rozdělení disku

Dělení disku je víceméně omezeno možnostmi, které nabízí partman-auto. Můžete
zvolit rozdělení buď stávajícího volného místa, nebo celého disku. Rozvržení
oblastí můžete určit pomocí předdefinovaného schematu, vlastního schematu ze
souboru nebo schematu obsaženém v souboru s přednastavením.

Přednastavení pokročilejších konfigurací s RAIDem, LVM a šifrováním je sice
podporováno, ale ne s takovými možnostmi, jako při ručním dělení.

Příklady níže ukazují jen základní použití schemat. Podrobnější informace
naleznete v souborech partman-auto-recipe.txt a partman-auto-raid-recipe.txt,
které jsou součástí balíku debian-installer. Oba soubory jsou též dostupné ze
zdrojového repositáře debian-installer. Poznamenejme, že podporovaná
funkcionalita se může mezi jednotlivými vydáními lišit.

Varování

Označení disků závisí na pořadí, ve kterém jsou nahrány jejich ovladače.
Jestliže se v systému nachází více disků, tak se ubezpečte, že jste vybrali ten
správný.

B.4.7.1. Příklad dělení disku

# Má-li systém nějaké volné místo, můžete si vybrat, zda chcete
# automaticky rozdělit pouze toto volné místo. To však funguje pouze
# pokud není nastavena proměnná partman-auto/method (níže).
#d-i partman-auto/init_automatically_partition select biggest_free

# Alternativně můžete zadat k automatickému dělení celý disk.
# Obsahuje-li systém pouze jediný disk, použije se tento automaticky.
# V opačném případě musíte zadat název příslušného zařízení
# v tradičním formátu a ne ve formátu devfs (tj. musíte zadat něco
# jako /dev/sda, ne /dev/discs/disc0/disc).
# Například pro použití prvního SCSI/SATA disku:
#d-i partman-auto/disk string /dev/sda
#
# Dále musíte zvolit metodu, která se má použít. Momentálně jsou
# dostupné metody
# - regular: použije typ oblastí typický na vaší architektuře
# - lvm:     pro rozdělení disku použije LVM
# - crypto:  použije LVM nad zašifrovanou oblastí
d-i partman-auto/method string lvm

# Pokud některý z disků určených k automatickému rozdělení obsahuje
# pozůstatek z předchozího LVM, zobrazí se varování. Tímto můžete
# varování potlačit...
d-i partman-lvm/device_remove_lvm boolean true
# To stejné platí pro potvrzení při zápisu LVM oblastí.
d-i partman-lvm/confirm boolean true
d-i partman-lvm/confirm_nooverwrite boolean true
# A platí i pro odstranění pozůstatků předchozího softwarového RAIDu:
d-i partman-md/device_remove_md boolean true

# Můžete vybrat jedno ze tří připravených schémat dělení.
# - atomic: všechny soubory v jedné oblasti
# - home:   samostatná oblast /home
# - multi:  samostatné oblasti /home, /var a /tmp
d-i partman-auto/choose_recipe select atomic

# Nebo zadat váš vlastní návod na dělení...
# Pokud umíte do prostředí d-i dostat soubor s návodem na dělení,
# stačí na něj odkázat.
#d-i partman-auto/expert_recipe_file string /hd-media/recipe

# V opačném případě můžete zadat celý návod na jednu (logickou) řádku.
# Například vytvoříme malou oblast /boot, vhodný swap a zbytek
# použijeme jako kořenovou oblast:
#d-i partman-auto/expert_recipe string                         \
#      boot-root ::                                            \
#              40 50 100 ext3                                  \
#                      $primary{ } $bootable{ }                \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ /boot }                     \
#              .                                               \
#              500 10000 1000000000 ext3                       \
#                      method{ format } format{ }              \
#                      use_filesystem{ } filesystem{ ext3 }    \
#                      mountpoint{ / }                         \
#              .                                               \
#              64 512 300% linux-swap                          \
#                      method{ swap } format{ }                \
#              .

# Kompletní formát je popsán v souboru partman-auto-recipe.txt
# dostupném v balíku "debian-installer" nebo ve zdrojovém repositáři
# D-I. Soubor demonstruje použití i takových věcí, jako je pojmenování
# souborových systémů, pojmenování skupin svazků a určení, ze kterých
# fyzických zařízení se má skupina svazků skládat.

# Následujícím řeknete partmanu, aby disk rozdělil bez potvrzení.
# (Za předpokladu, že jste partmanu v předchozích krocích řekli,
# co má dělat.)
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true
d-i partman/confirm_nooverwrite boolean true

# Je-li povoleno šifrování disku, přeskočí úvodní vymazání oblastí.
#d-i partman-auto-crypto/erase_disks boolean false

B.4.7.2. Rozdělení při použití RAIDu

Pomocí přednastavení též můžete nastavit oblasti na polích softwarového RAIDu.
Podporovány jsou RAID úrovně 0, 1, 5, 6 a 10, vytváření degradovaných polí a
určení rezervních zařízení.

Používáte-li RAID 1, můžete podle části B.4.11 - "Instalace zavaděče"
přednastavit grub, aby se nainstaloval do všech zařízení v poli použitých.

Varování

U tohoto typu automatického rozdělení se dá velice lehce něco pokazit. Navíc se
jedná o komponentu, kterou vývojáři debian-installer testují relativně málo.
Odpovědnost za správné zapsání návodu pro rozdělení (aby dával smysl a
nevytvářel konflikty) nese uživatel. V případě problémů zkontrolujte /var/log/
syslog.

# Metoda by měla být nastavena na "raid".
#d-i partman-auto/method string raid
# Zadejte disky k rozdělení. Na všech bude nakonec stejné rozložení,
# takže to bude fungovat pouze pokud mají disky stejnou velikost.
#d-i partman-auto/disk string /dev/sda /dev/sdb

# Dále musíte zadat fyzické oblasti, které se mají použít.
#d-i partman-auto/expert_recipe string \
#      multiraid ::                                         \
#              1000 5000 4000 raid                          \
#                      $primary{ } method{ raid }           \
#              .                                            \
#              64 512 300% raid                             \
#                      method{ raid }                       \
#              .                                            \
#              500 10000 1000000000 raid                    \
#                      method{ raid }                       \
#              .

# Na závěr musíte zadat, jakým způsobem se mají dříve definované oblasti
# použít v nastavení RAIDu. Důležité je použít správná čísla logických
# oblastí. Podporovány jsou RAID úrovně 0, 1, 5, 6 a 10; zařízení jsou
# oddělena pomocí "#"
# Parametry jsou:
# <typraidu> <početzařízení> <početrezerv> <typss> <přípbod> \
#          <zařízení> <rezervnízařízení>

#d-i partman-auto-raid/recipe string \
#    1 2 0 ext3 /                    \
#          /dev/sda1#/dev/sdb1       \
#    .                               \
#    1 2 0 swap -                    \
#          /dev/sda5#/dev/sdb5       \
#    .                               \
#    0 2 0 ext3 /home                \
#          /dev/sda6#/dev/sdb6       \
#    .

# Více informací naleznete v souboru partman-auto-recipe.txt dostupném
# v balíku "debian-installer" nebo ve zdrojovém repositáři D-I.

# Toto zajistí, že se partman nebude při rozdělování ptát na potvrzení.
d-i partman-md/confirm boolean true
d-i partman-partitioning/confirm_write_new_label boolean true
d-i partman/choose_partition select finish
d-i partman/confirm boolean true

B.4.7.3. Způsob připojení oblastí

Souborové systémy se obvykle připojují pomocí jedinečného univerzálního
identifikátoru, tzv. UUID. To umožňuje korektní připojení oblastí i v
případech, kdy se změní jejich jména zařízení. UUID jsou dlouhé a špatně se
čtou, takže pokud si budete přát, může instalátor připojit souborové systémy
pomocí tradičních jmen zařízení, nebo pomocí názvů oblastí, které jim
přidělíte. Zvolíte-li připojení pomocí názvů oblastí, budou oblasti bez
nastaveného názvu připojeny pomocí UUID.

Zařízení se stabilními jmény, jako např. logické svazky LVM, budou místo UUID
nadále používat připojení pomocí tradičních jmen zařízení.

Varování

Tradiční jména zařízení se mohou měnit v závislosti na pořadí, ve kterém jádro
při zavádění zařízení objeví. To může způsobit připojení chybného souborového
systému. Podobný problém existuje v případě použití názvů oblastí, protože při
zapojení dalšího disku (i externího) mohou použité názvy oblastí kolidovat a
tím pádem není zaručeno, která oblast se připojí.

# Výchozí je připojování pomocí UUID, ale můžete zvolit též "traditional"
# pro použití tradičních jmen zařízení, nebo "label" pro použití názvů
# oblastí (se záchytnou možností použití UUID).
#d-i partman/mount_style select uuid

B.4.8. Instalace základního systému

V této fázi instalace se toho moc nastavit nedá. Jediné otázky se týkají
instalace jádra.

# Nastaví APT, aby implicitně neinstaloval doporučené balíky. Použití
# této volby může znamenat instalaci nekompletního systému a měli by
# ji používat pouze zkušení uživatelé.
#d-i base-installer/install-recommends boolean false

# (Meta) balík jádra, který se má nainstalovat; nechcete-li instalovat
# žádné jádro, zadejte "none".
#d-i base-installer/kernel/image string linux-image-686

B.4.9. Nastavení APT

Nastavení souboru /etc/apt/sources.list a několika základních parametrů je plně
řízeno typem instalace a dříve zodpovězenými otázkami. Volitelně můžete přidat
další (lokální) archivy.

# Můžete si zvolit instalaci softwaru ze sekcí non-free a contrib.
#d-i apt-setup/non-free boolean true
#d-i apt-setup/contrib boolean true
# Odkomentujte, pokud nechcete používat síťové zrcadlo.
#d-i apt-setup/use_mirror boolean false
# Vyberte, které aktualizační služby chcete využívat a zadejte
# jejich zrcadla. Příklad ukazuje výchozí hodnoty.
#d-i apt-setup/services-select multiselect security, updates
#d-i apt-setup/security_host string security.debian.org

# Další archivy, k dispozici jsou local[0-9]
#d-i apt-setup/local0/repository string \
#       http://muj.server/debian stable main
#d-i apt-setup/local0/comment string local server
# Povolí řádky deb-src
#d-i apt-setup/local0/source boolean true
# URL k veřejnému klíči lokálního archivu; Klíč musíte zadat, protože
# jinak si apt bude stěžovat na neautentizovaný archiv a příslušný
# řádek v sources.list zůstane zakomentovaný
#d-i apt-setup/local0/key string http://muj.server/klic

# Instalace vyžaduje, aby byly všechny repositáře autentizovány
# známým gpg klíčem. Tímto nastavením můžete autentizaci potlačit.
# Varování: Nebezpečné, není doporučeno.
#d-i debian-installer/allow_unauthenticated boolean true

# Odkomentujte pro přidání další architektury, zde i386
#d-i apt-setup/multiarch string i386

B.4.10. Výběr balíků

Můžete nainstalovat libovolnou kombinaci dostupných úloh. V době psaní to
zahrnuje:

  • standard (standardní unixové nástroje)

  • desktop (grafické prostředí)

  • gnome-desktop (prostředí Gnome)

  • xfce-desktop (prostředí XFCE)

  • kde-desktop (prostředí KDE Plasma)

  • cinnamon-desktop (prostředí Cinnamon)

  • mate-desktop (prostředí MATE)

  • lxde-desktop (prostředí LXDE)

  • web-server (webový server)

  • print-server (tiskový server)

  • ssh-server (SSH server)

Instalaci úloh můžete vynechat a instalovat balíky nějakou jinou cestou. Úlohu
standard však doporučujeme instalovat vždy.

Chcete-li kromě balíků v úlohách instalovat také nějaké samostatné balíky,
můžete použít parametr pkgsel/include. Hodnotou parametru je čárkami nebo
mezerami oddělený seznam, takže jej můžete jednoduše použít i na příkazové
řádce jádra.

#tasksel tasksel/first multiselect standard, web-server, kde-desktop

# Samostatné balíky pro instalaci.
#d-i pkgsel/include string openssh-server build-essential
# Zda se mají balíky po rozbalení debootstrapem aktualizovat.
# Povolené hodnoty: none, safe-upgrade, full-upgrade
#d-i pkgsel/upgrade select none

# Některé verze instalačního systému mohou vývojářům Debianu hlásit
# seznam balíků, které jste nainstalovali, což pomáhá při
# rozhodování, který software je oblíbený a proto by měl být zařazen
# na CD. Výchozí hodnotou je zákaz posílání tohoto seznamu, ale měli
# byste zvážit jeho povolení.
#popularity-contest popularity-contest/participate boolean false

B.4.11. Instalace zavaděče


# Výchozím zavaděčem (pro x86) je Grub. Chcete-li místo něj instalovat
# LILO, odkomentujte následující:
#d-i grub-installer/skip boolean true
# Jestliže chcete přeskočit také instalaci LILA a neinstalovat žádný
# zavaděč, odkomentujte ještě toto:
#d-i lilo-installer/skip boolean true



# Toto je bezpečné nastavení - pokud nenalezne jiný operační systém,
# nainstaluje Grub do MBR.
d-i grub-installer/only_debian boolean true

# Toto nainstaluje Grub do MBR i když nalezne jiný operační systém,
# což je méně bezpečné, protože se jiný systém nemusí zavést.
d-i grub-installer/with_other_os boolean true

# Kvůli potenciáním zapojeným USB klíčenkám nelze obecně bezpečně určit
# umístění MBR, takže je potřeba ho zadat:
#d-i grub-installer/bootdev  string /dev/sda
# Pro instalaci na první zařízení (předpokládejme, že nejde o USB klíčenku):
#d-i grub-installer/bootdev  string default

# Alternativně můžete instalovat jinam než do MBR - odkomentujete
# a upravte tyto řádky:
#d-i grub-installer/only_debian boolean false
#d-i grub-installer/with_other_os boolean false
#d-i grub-installer/bootdev  string (hd0,1)
# Pro instalaci Grubu na více disků:
#d-i grub-installer/bootdev  string (hd0,1) (hd1,1) (hd2,1)

# Volitelné heslo pro Grub buď v čitelné podobě
#d-i grub-installer/password password r00tme
#d-i grub-installer/password-again password r00tme
# nebo zašifrované pomocí MD5 hashe, viz grub-md5-crypt(8).
#d-i grub-installer/password-crypted password [MD5 hash]

# Následující volbou můžete přidat další zaváděcí parametry pro
# nainstalovaný systém (pokud to podporuje instalátor zavaděče).
# Poznámka: parametry předané instalátoru budou přidány automaticky.
#d-i debian-installer/add-kernel-opts string nousb

MD5 hash hesla pro grub můžete získat buď příkazem grub-md5-crypt, nebo
příkazem uvedeným v příkladu v části B.4.5 - "Nastavení účtů".

B.4.12. Dokončení instalace

# Při instalaci skrze sériovou konzoli jsou tradiční virtuální konzoly
# (VT1-VT6) v /etc/inittab zakázány. Chcete-li je nechat povolené,
# odkomentujte následující řádek.
#d-i finish-install/keep-consoles boolean true

# Vynechá poslední hlášku, že je instalace kompletní.
d-i finish-install/reboot_in_progress note

# Zakáže vysunutí CD během restartu, což se občas může hodit.
#d-i cdrom-detect/eject boolean false

# Tímto se počítač po skončení instalace místo restartu do nového
# systému zastaví, případně zcela vypne.
#d-i debian-installer/exit/halt boolean true
# Tímto se počítač nejen zastaví, ale i vypne.
#d-i debian-installer/exit/poweroff boolean true

B.4.13. Přednastavení ostatních balíků

# Je možné, že se objeví další otázky v závislosti na tom, jaký
# software nainstalujete, nebo podle toho, co se během instalace
# pokazí. Seznam všech možných otázek během instalace získáte
# příkazy:
#   debconf-get-selections --installer > soubor
#   debconf-get-selections >> soubor

B.5. Pokročilé možnosti

B.5.1. Spouštění vlastních příkazů během instalace

Nástroje pro přednastavení nabízí velice mocnou vlastnost, kterou je možnost
spouštění libovolných příkazů nebo skriptů v určitých bodech instalace.

Po připojení souborového systému instalovaného systému je tento dostupný v
adresáři /target. Pokud pro instalaci používáte CD, je po připojení dostupné
přes /cdrom.

# Přednastavení d-i není už ze své podstaty bezpečné. Nic
# v instalačním systému nekontroluje pokusy kolem přetečení bufferu
# ani zneužití hodnot v souboru s přednastaveními. Používejte tyto
# soubory pouze z důvěryhodných zdrojů!
# Následuje ukázka, jak v d-i spustit automaticky nějaký shellový příkaz.

# První příkaz je spuštěn co nejdříve - hned po načtení přednastavení.
#d-i preseed/early_command string anna-install nejaky-udeb

# Tento příkaz je spuštěn těsně před vstupem do dělení disků. Může se
# hodit pro dynamické přednastavení rozdělení disku, které závisí na
# aktuálním stavu disků (které ještě nemusí být vidět v době spuštění
# předchozího příkazu preseed/early_command).
#d-i partman/early_command \
#       string debconf-set partman-auto/disk "$(list-devices disk | head -n1)"

# Tento příkaz je spuštěn těsně před koncem instalace, ale ještě je
# připojen adresář /target. Buď můžete použít chroot na /target
# a pracovat přímo v něm, nebo můžete použít příkaz apt-install
# resp. in-target pro jednoduchou instalaci balíků resp. spouštění
# příkazů v nově instalovaném systému
#d-i preseed/late_command string apt-install zsh; in-target chsh -s /bin/zsh

B.5.2. Použití přednastavení pro změnu výchozích hodnot

Pomocí přednastavení můžete dosáhnout i toho, že se otázka normálně zobrazí,
ale změní se její výchozí odpověď. (Například na úvodní otázce ohledně jazyka
můžete přednastavit místo angličtiny češtinu, takže uživateli stačí stisknout 
Enter, ale stále mu necháváte možnost volby jiného jazyka.) Dosáhnete toho tak,
že po nastavení proměnné změníte příznak seen na hodnotu "false".

d-i foo/bar string hodnota
d-i foo/bar seen false

Chcete-li stejného výsledku dosáhnout pro všechny otázky, můžete použít
zaváděcí parametr preseed/interactive=true, což se může hodit pro testování a
ladění konfiguračního souboru s přednastavením.

Zopakujme, že vlastník "d-i" by se měl používat pouze pro proměnné používané
samotným instalačním systémem. Pro proměnné nacházející se v instalovaných
balících byste měli jako vlastníka použít jméno příslušného balíku (viz
poznámka pod čarou u B.2.2 - "Použití zaváděcích parametrů jako formy
přednastavení").

Přednastavujete-li pomocí zaváděcích parametrů, můžete použít speciální
operátor "?=", kterým instalátor donutíte, aby danou otázku zobrazil. Například
foo/bar?=hodnota (nebo vlastník:foo/bar?=hodnota). To samozřejmě funguje jen u
parametrů, kterým odpovídá nějaká otázka zobrazená během instalace, tj.
nefunguje to pro "interní" parametry.

Pro více ladicích informací můžete použít zaváděcí parametr DEBCONF_DEBUG=5,
který zajistí, že debconf bude mnohem upovídanější, co se týče aktuálního
nastavení proměnných a postupu instalačními skripty.

B.5.3. Zřetězené nahrávání souborů s přednastavením

Přestože je použití jednoho velkého souboru s přednastavením jednoduché,
zdaleka nemusí být přehledné a navíc postrádá flexibilitu. Z tohoto důvodu je
možné nastavení rozdělit do několika samostatných souborů a ty pak skládat
dohromady. Protože později uvedené volby přepisují volby zadané dříve, přímo se
nabízí vytvoření hlavního (sdíleného) souboru s obecnými předvolbami a k němu
několik dalších souborů se specifickým nastavením pro danou situaci.

# Zadat můžete i více souborů najednou, stačí je oddělit mezerami.
# Vložené soubory mohou obsahovat jak deklarace pro přednastavení,
# tak příkazy pro zavedení dalších souborů. Pokud cestu zadáte
# relativně, hledají se soubory ve stejném adresáři, jako nadřízený
# soubor.
#d-i preseed/include string x.cfg

# d-i může volitelně kontrolovat kontrolní součty souborů
# s přednastavením. V současnosti jsou podporovány pouze md5 součty.
# Seznam součtů zadejte ve stejném pořadí, v jakém se budou načítat
# soubory s přednastavením.
#d-i preseed/include/checksum string 5da499872becccfeda2c4872f9171c3d

# Mnohem pružnější je použití shellového příkazu, který vrátí názvy
# souborů, jež se mají nahrát.
#d-i preseed/include_command \
#      string if [ "`hostname`" = bob ]; then echo bob.cfg; fi

# Nejpružnější možnost stáhne program a spustí jej. Program může
# používat příkazy pro manipulaci s databází debconfu jako např.
# debconf-set. Pokud jsou názvy souborů relativní, berou se ze
# stejného adresáře jako soubor s přednastavením, který je spouští.
# Zadat můžete i více skriptů, stačí je oddělit mezerami.
#d-i preseed/run string foo.sh

Zřetězené nahrávání souborů s přednastavením funguje i mezi různými typy
přednastavení. Například pokud používáte přednastavení z initrd nebo ze
souboru, můžete v nich uvést proměnnou preseed/url a po naběhnutí sítě tak
plynule přejít do souboru s přednastavením staženým ze sítě. Musíte však být
opatrní, protože to také znamená, že se proces přednastavení spustí znovu a
mimo jiné tím dostanete šanci na druhé spuštění příkazu preseed/early,
tentokráte po naběhnutí sítě.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[26] Vlastníkem debconf proměnné (nebo šablony) je obvykle jméno balíku, který
obsahuje odpovídající debconf šablonu. U proměnných používaných přímo v
instalačním systému je vlastníkem "d-i". Šablony a proměnné mohou mít více
vlastníků, což pomáhá při rozhodování, zda je možné je při odinstalování balíku
odstranit z databáze debconfu.

^[27] Například přednastavením locale na hodnotu en_NL by se jako výchozí
locale pro instalovaný systém použilo en_US.UTF-8. Jestliže preferujete britský
standard angličtiny (en_GB.UTF-8), musíte přednastavit jednotlivé proměnné.

Příloha C. Poznámky k rozdělování disku

Obsah

C.1. Počet a velikost oblastí
C.2. Strom adresářů
C.3. Doporučené rozdělení disku
C.4. Jak Linux pojmenovává pevné disky
C.5. Dělící programy v Debianu

    C.5.1. Dělení disku na 32-bit PC

C.1. Počet a velikost oblastí

Jako úplné minimum potřebuje GNU/Linux jeden diskový oddíl. Tento oddíl je
využit pro operační systém, programy a uživatelská data. Většina uživatelů
navíc pokládá za nutnost mít vydělenou část disku pro virtuální paměť (swap).
Tento oddíl slouží operačnímu systému jako odkládací prostor. Vydělení "swap"
oblasti umožní efektivnější využití disku jako virtuální paměti. Je rovněž
možné pro tento účel využít obyčejný soubor, ale není to doporučené řešení.

Většina uživatelů vyčlení pro GNU/Linux více než jeden oddíl na disku. Jsou k
tomu dva důvody. Prvním je bezpečnost, pokud dojde k poškození souborového
systému, většinou se to týká pouze jednoho oddílu, takže potom musíte nahradit
ze záloh pouze část systému. Minimálně můžete uvážit vydělení kořenového svazku
souborů. Ten obsahuje zásadní komponenty systému. Jestliže dojde poškození
nějakého dalšího oddílu, budete stále schopni spustit GNU/Linux a provést
nápravu, což vám může ušetřit novou instalaci systému.

Druhý důvod je obyčejně závažnější při produkčním nasazení. Představte si
situaci, kdy nějaký proces začne nekontrolovaně zabírat diskový prostor. Pokud
se jedná o proces se superuživatelskými právy, může zaplnit celý disk a naruší
tak chod systému, poněvadž Linux potřebuje při běhu vytvářet soubory. K takové
situaci může dojít i z vnějších příčin, například se stanete obětí spamu a
nevyžádané e-maily vám lehce zaplní celý disk. Rozdělením disku na více oddílů
se lze před podobnými problémy uchránit. Pokud třeba vydělíte pro /var/mail
samostatnou oblast, bude systém fungovat, i když bude zahlcen nevyžádanou
poštou.

Jedinou nevýhodou při používání více diskových oddílů je, že je obtížné dopředu
odhadnout kapacitu jednotlivých oddílů. Jestliže vytvoříte některý oddíl příliš
malý, budete muset systém instalovat znovu, a nebo se budete potýkat s
přesunováním souborů z oddílu, jehož velikost jste podhodnotili. V opačném
případě, kdy vytvoříte zbytečně velký oddíl, plýtváte diskovým prostorem, který
by se dal využít jinde. Diskový prostor je dnes sice levný, ale proč vyhazovat
peníze oknem?

C.2. Strom adresářů

Debian GNU/Linux dodržuje standard pro pojmenování souborů a adresářů (
Filesystem Hierarchy Standard), což zaručuje, že uživatelé či programy mohou
odhadnout umístění souborů či adresářů. Kořenový adresář je reprezentován
lomítkem / a na všech Debianích systémech obsahuje tyto adresáře:

┌───────┬─────────────────────────────────────────────────┐
│Adresář│                      Obsah                      │
├───────┼─────────────────────────────────────────────────┤
│bin    │Důležité programy                                │
├───────┼─────────────────────────────────────────────────┤
│boot   │Statické soubory zavaděče                        │
├───────┼─────────────────────────────────────────────────┤
│dev    │Soubory zařízení                                 │
├───────┼─────────────────────────────────────────────────┤
│etc    │Konfigurační soubory závislé na systému          │
├───────┼─────────────────────────────────────────────────┤
│home   │Domovské adresáře uživatelů                      │
├───────┼─────────────────────────────────────────────────┤
│lib    │Podstatné sdílené knihovny a moduly jádra        │
├───────┼─────────────────────────────────────────────────┤
│media  │Obsahuje přípojné body pro výměnná média         │
├───────┼─────────────────────────────────────────────────┤
│mnt    │Místo pro dočasné připojování souborových systémů│
├───────┼─────────────────────────────────────────────────┤
│proc   │Virtuální adresář obsahující systémové informace │
├───────┼─────────────────────────────────────────────────┤
│root   │Domovský adresář správce systému                 │
├───────┼─────────────────────────────────────────────────┤
│run    │Proměnlivá data platná po dobu běhu systému      │
├───────┼─────────────────────────────────────────────────┤
│sbin   │Důležité systémové programy                      │
├───────┼─────────────────────────────────────────────────┤
│srv    │Data nabízená systémem                           │
├───────┼─────────────────────────────────────────────────┤
│sys    │Virtuální adresář pro systémové informace        │
├───────┼─────────────────────────────────────────────────┤
│tmp    │Dočasné soubory                                  │
├───────┼─────────────────────────────────────────────────┤
│usr    │Druhá úroveň hierarchie                          │
├───────┼─────────────────────────────────────────────────┤
│var    │Proměnlivá data                                  │
├───────┼─────────────────────────────────────────────────┤
│opt    │Softwarové balíky třetích stran                  │
└───────┴─────────────────────────────────────────────────┘

Následující seznam by vám měl pomoci při rozhodování o rozdělení disku na
oblasti. Berte prosím na vědomí, že využití disku se velmi liší podle způsobu
používání systému a proto jsou následující doporučení pouze obecné a měly by
sloužit jen jako možný základ pro dělení disku.

  • /: kořenový adresář musí vždy fyzicky obsahovat adresáře /etc, /bin, /sbin,
    /lib a /dev, protože jinak byste nemohli zavést systém. Typicky je potřeba
    250-350 MB, ale v konkrétních podmínkách se požadavky mohou lišit.

  • /usr: obsahuje všechny uživatelské programy (/usr/bin), knihovny (/usr/
    lib), dokumentaci (/usr/share/doc), atd. Protože tato část souborového
    systému spotřebuje nejvíce místa, měli byste jí na disku poskytnout alespoň
    600-750 MB. Pokud budete instalovat hodně balíčků, měli byste tomuto
    adresáři vyhradit ještě více místa. Velkoryse pojatá instalace pracovní
    stanice nebo serveru může klidně zabrat i 5-6 GB.

    V současnosti se doporučuje mít adresář /usr umístěn přímo na kořenové
    oblasti, jelikož zavádění systému s /usr na samostatné oblasti je stále
    obtížnější a jednou přestane být podporováno.

  • /var: v tomto adresáři budou uložena všechna proměnlivá data jako příspěvky
    news, e-maily, webové stránky, vyrovnávací paměť pro balíčkovací software,
    atd. Velikost tohoto adresáře velmi závisí na způsobu používání vašeho
    počítače, ale pro většinu lidí bude velikost dána režijními náklady správce
    balíčků. Pokud se chystáte nainstalovat najednou vše, co Debian nabízí,
    mělo by stačit pro /var vyhradit dva až tři gigabajty. V případě, že budete
    instalovat systém po částech (nejprve služby a utility, potom textové
    záležitosti, následně X, ...), bude stačit 300 až 500 megabajtů. Jestliže
    je vaší prioritou volné místo na disku a neplánujete žádné velké
    aktualizace systému, lze vyjít se 30 až 40 megabajty.

  • /tmp: sem programy většinou zapisují dočasná data. Obvykle by mělo stačit
    40-100 MB. Některé aplikace -- včetně nadstaveb archivačních programů,
    authoringových CD/DVD nástrojů a multimediálních programů -- mohou /tmp
    využívat pro uložení celých obrazů. Plánujete-li využívat takovéto
    programy, měli byste dostupné místo příslušně zvýšit.

  • /home: každý uživatel si bude ukládat data do svého podadresáře v tomto
    adresáři. Jeho velikost závisí na tom, kolik uživatelů bude systém používat
    a jaké soubory se v jejich adresářích budou uchovávat. Pro každého
    uživatele byste měli počítat alespoň 100 MB místa, ale opět závisí na
    konkrétní situaci.

C.3. Doporučené rozdělení disku

Pro nové uživatele, domácí počítače a jiné jednouživatelské stanice je asi
nejjednodušší použít jednu oblast jako kořenovou (a případně jednu pro
virtuální paměť). Pokud bude některá oblast větší než 6 GB, použijte raději
jiný souborový systém než standardní ext2 (např. ext3). Oblasti se souborovým
systémem ext2 se totiž musí pravidelně kontrolovat, což může u větších oblastí
trvat poměrně dlouho a prodlužuje se tím náběh systému.

Jak jsme řekli dříve, pro víceuživatelské systémy je lepší použít pro /var, /
tmp a /home samostatné oblasti.

Chcete-li instalovat hodně programů, které nejsou přímo součástí distribuce,
může se vám hodit samostatný oddíl pro /usr/local. Na počítači, který slouží
jako poštovní server, má smysl vytvořit svazek pro /var/mail. Někdy je také
dobré oddělit adresář /tmp na samostatný oddíl s kapacitou 20 až 50MB. Na
serveru s více uživateli je výhodné vymezit velký oddíl pro domovské adresáře
(/home). Obecně ale platí, že rozdělení disku se liší počítač od počítače a
záleží na tom, k čemu systém používáte.

Při instalaci komplikovanějšího systému (serveru) se podívejte do Multi Disk
HOWTO na podrobnější informace. Tento odkaz může být zajímavý rovněž pro
zprostředkovatele připojení k Internetu.

Zůstává otázka, kolik vyhradit pro virtuální paměť. Názory systémových
administrátorů jsou různé. Jedna (dobrá) zkušenost říká, že je dobré mít stejně
odkládacího prostoru jako máte paměti, ale rozhodně ne méně než 16MB (To už je
skoro lepší odkládací prostor nepoužívat vůbec). Samozřejmě že existují výjimky
-- budete-li řešit soustavu 10000 rovnic na počítači s 256 MB, budete
potřebovat více jak gigabajt odkládacího prostoru.

Na některých 32-bitových architekturách (m68k a PowerPC) využije Linux z
jednoho odkládacího oddílu maximálně 2 GB, takže není důvod, proč překračovat
tuto hranici. Máte-li větší nároky na virtuální paměť, zkuste umístit odkládací
oddíly na různé fyzické disky, a pokud možno, na různé IDE nebo SCSI kanály.
Jádro bude automaticky vyrovnávat zátěž mezi jednotlivé oblasti, což se projeví
ve zvýšení rychlosti.

Například starší domácí počítač může mít 32 MB paměti a 1,7 GB IDE disk na
zařízení /dev/sda. Řekněme, že na /dev/sda1 je oblast pro druhý operační systém
o velikosti 500 MB. Odkládací oddíl má 32 MB a je na /dev/sda3. Zbytek, tj. asi
1,2 GB na /dev/sda2 je kořenový svazek pro Linux.

Pro představu, kolik místa zaberou jednotlivé úlohy, se podívejte na D.2 -
"Místo potřebné pro úlohy".

C.4. Jak Linux pojmenovává pevné disky

Disky a oddíly na nich mají v Linuxu odlišné názvy než v jiných operačních
systémech. Tyto názvy budete potřebovat při rozdělování disku a připojování
oblastí. Základní zařízení:

  • První disketová jednotka je nazvána /dev/fd0.

  • Druhá disketová jednotka je /dev/fd1.

  • První rozpoznaný disk má název /dev/sda.

  • Druhý rozpoznaný disk má název /dev/sdb atd.

  • První SCSI CD mechanice odpovídá /dev/scd0 nebo také /dev/sr0.

Oddíly na discích jsou rozlišeny připojením čísla k názvu zařízení: sda1 a sda2
představují první a druhý oddíl prvního disku.

Například uvažujme počítač se dvěma disky na SCSI sběrnici na SCSI adresách 2 a
4. Prvnímu disku (na adrese 2) odpovídá zařízení sda, druhému sdb. Tři oddíly
na disku sda by byly pojmenovány sda1, sda2, sda3. Stejné schéma značení platí
i pro disk sdb a jeho oblasti.

Máte-li v počítači dva SCSI řadiče, pořadí disků zjistíte ze zpráv, které Linux
vypisuje při startu.

Primární oddíly jsou v Linuxu reprezentovány názvem disku a číslem oddílu 1 až
4. Například /dev/sda1 odpovídá prvnímu primárnímu oddílu na prvním disku.
Logické oddíly jsou číslovány od 5, takže na stejném disku má první logický
oddíl označení /dev/sda5. Rozšířený oddíl, tj. primární oddíl obsahující
logické oddíly, sám o sobě použitelný není.

C.5. Dělící programy v Debianu

K rozdělení disku nabízí každá architektura různé programy. Pro váš typ
počítače jsou k dispozici:

partman

    Doporučený nástroj, který umí kromě dělení disků i měnit velikost oblastí,
    vytvářet souborové systémy (v řeči Windows "formátovat") a přiřadit je k
    přípojným bodům.

fdisk

    Původní linuxový program pro správu oddílů, vhodný pro guru.

    Obzvláště opatrní musíte být v případě, že máte na disku oblasti systému
    FreeBSD. Instalační jádra sice obsahují podporu pro tyto oblasti, ale
    způsob, jakým je fdisk (ne)reprezentuje, může změnit názvy zařízení. Viz
    Linux+FreeBSD HOWTO.

cfdisk

    Jednoduchý, celoobrazovkový program pro správu oddílů se vyznačuje snadným
    ovládáním.

    Poznamenejme, že cfdisk oblasti FreeBSD nerozpozná vůbec a tím pádem se
    názvy zařízení mohou změnit.

Jeden z těchto programů se spustí automaticky, když vyberete krok Rozdělit
disky (nebo podobný). Teoreticky je možné přepnout se na druhou konzoli (tty2)
a použít jiný nástroj na dělení disku, avšak prakticky se to nedoporučuje.

Nezapomeňte označit zaváděcí oddíl jako "aktivní" (bootable).

C.5.1. Dělení disku na 32-bit PC

BIOS osobních počítačů obvykle přidává další omezení na rozdělení disku. Je
určeno, kolik můžete na disku připravit "primárních" a "logických" oddílů.
Starší BIOSy z let 1994-1998 dokáží zavést systém jen z části disku. Informace
na toto téma podávají dokumenty Linux Partition HOWTO, zde uvádíme jen stručný
přehled.

"Primární" oddíly jsou původní koncept rozdělení disku. Na disku mohou být
maximálně čtyři. Toto omezení překonávají oddíly "rozšířené" a "logické".
Změníte-li primární oddíl na rozšířený, můžete tento prostor využít k vytvoření
libovolného počtu (max. 60) logických částí. Na disku lze však vytvořit
maximálně jeden rozšířený oddíl.

Linux omezuje počet oddílů na disk takto: 255 oddílů pro disky SCSI (3 primární
a 252 logických) a 63 oddílů na discích IDE (3 primární a 60 logických).
Standardní Debian GNU/Linux nabízí na každém disku pouze 20 zařízení pro
oblasti, takže pokud chcete využívat oblasti s číslem větším než 20, musíte
odpovídající zařízení vytvořit ručně.

Jestliže máte velký IDE disk na kterém nepoužíváte ani LBA adresování, ani
překládací ovladač od výrobce, pak musíte umístit zaváděcí oddíl (obsahující
jádro) do prvních 1024 cylindrů na disku (obvykle prvních 524 megabajtů).

Toto omezení neplatí pro novější BIOSy (podle výrobce 1995-98), které podporují
"Enhanced Disk Drive Support Specification". Lilo, linuxový zavaděč, i
alternativní zavaděč mbr musí použít BIOS pro načtení jádra z disku do operační
paměti. Jestliže jsou v BIOSu přítomna rozšíření pro přístup k velkým diskům
(přes přerušení 0x13), pak budou použita. V opačném případě je použito původní
rozhraní pro přístup k diskům, které bohužel neumí adresovat oblasti nad 1023.
cylindrem. Avšak v okamžiku, kdy je Linux zaveden, už nezáleží na omezeních
BIOSu, protože Linux k přístupu na disky BIOS nepoužívá.

Pokud máte velký disk, možná budete chtít využít techniku překladu cylindrů,
kterou můžete zapnout v BIOSu (jako třeba LBA "Logical Block Addressing" nebo
CHS "Large" módy). Více informací ohledně velkých disků najdete v Large Disk
HOWTO. Pokud používáte techniku překladu cylindrů a BIOS nepodporuje rozšíření
pro přístup k velkým diskům, pak se vaše zaváděcí oblast musí vlézt do 
přeloženého ekvivalentu 1024. cylindru.

Pro splnění těchto požadavků doporučujeme vytvořit malou oblast na začátku
disku (25-50MB by mělo stačit), která se použije jako zaváděcí. Ostatní oblasti
je pak možné vytvořit kdekoliv ve zbylém místu. Zaváděcí oblast musí být
připojena jako /boot, protože v tomto adresáři se uchovávají jádra. Takovéto
nastavení bude fungovat na libovolném počítači, bez ohledu na to, zda používá
nebo nepoužívá LBA, CHS nebo zda podporuje rozšíření pro přístup k velkým
diskům.

Příloha D. Co se jinam nevešlo

Obsah

D.1. Zařízení v Linuxu

    D.1.1. Nastavení myši

D.2. Místo potřebné pro úlohy
D.3. Jak nainstalovat Debian GNU/Linux ze stávajícího unixového/linuxového
    systému

    D.3.1. Přípravné práce
    D.3.2. Instalace balíku debootstrap
    D.3.3. Spuštění debootstrapu
    D.3.4. Nastavení základního systému
    D.3.5. Instalace jádra
    D.3.6. Nastavení zavaděče
    D.3.7. Vzdálený přístup: Instalace SSH a nastavení přístupu
    D.3.8. Závěrečné kroky

D.4. Jak nainstalovat Debian GNU/Linux přes paralelní port (PLIP)

    D.4.1. Požadavky
    D.4.2. Nastavení stroje earthsimulator
    D.4.3. Instalace na nahepc

D.5. Jak nainstalovat Debian GNU/Linux pomocí PPP přes Ethernet (PPPoE)

D.1. Zařízení v Linuxu

V Linuxu existuje v adresáři /dev spousta speciálních souborů nazývaných
soubory zařízení. V unixovém světě se k hardwaru přistupuje právě přes tyto
soubory, které se ovšem chovají jinak, než obyčejné soubory. Soubor zařízení je
vlastně abstraktní rozhraní k systémovému ovladači, který komunikuje přímo s
hardwarem. Nejběžnějšími typy souborů zařízení jsou bloková a znaková zařízení,
méně rozšířené jsou pak pojmenované roury. V následujícím výpisu je uvedeno
několik nejdůležitějších souborů.

┌───┬──────────────────────────┐
│fd0│první disketová mechanika │
├───┼──────────────────────────┤
│fd1│druhá disketová mechanika │
└───┴──────────────────────────┘

┌────┬───────────────────────────────────┐
│sda │první pevný disk                   │
├────┼───────────────────────────────────┤
│sdb │druhý pevný disk                   │
├────┼───────────────────────────────────┤
│sda1│první oblast na prvním pevném disku│
├────┼───────────────────────────────────┤
│sdb7│sedmá oblast na druhém pevném disku│
└────┴───────────────────────────────────┘

┌───┬─────────────┐
│sr0│první CD-ROM │
├───┼─────────────┤
│sr1│druhá CD-ROM │
└───┴─────────────┘

┌───────┬────────────────────────────────────────────────────────────────┐
│ttyS0  │sériový port 0, pod MS-DOSem COM1                               │
├───────┼────────────────────────────────────────────────────────────────┤
│ttyS1  │sériový port 1, pod MS-DOSem COM2                               │
├───────┼────────────────────────────────────────────────────────────────┤
│lp0    │první paralelní port                                            │
├───────┼────────────────────────────────────────────────────────────────┤
│lp1    │druhý paralelní port                                            │
├───────┼────────────────────────────────────────────────────────────────┤
│psaux  │rozhraní myši na portu PS/2                                     │
├───────┼────────────────────────────────────────────────────────────────┤
│gpmdata│pseudozařízení - jenom opakuje data získaná z GPM (ovladač myši)│
└───────┴────────────────────────────────────────────────────────────────┘

┌─────┬────────────────────────────────────┐
│cdrom│symbolický odkaz na CD-ROM mechaniku│
├─────┼────────────────────────────────────┤
│mouse│symbolický odkaz na rozhraní myši   │
└─────┴────────────────────────────────────┘

┌────┬──────────────────────────────────────────────────┐
│null│cokoliv pošlete na toto zařízení, zmizí beze stopy│
├────┼──────────────────────────────────────────────────┤
│zero│z tohoto zařízení můžete až do nekonečna číst nuly│
└────┴──────────────────────────────────────────────────┘

D.1.1. Nastavení myši

Myš můžete používat jak na konzoli, tak v prostředí X Window. Obvykle stačí
nainstalovat balík gpm a příslušný X server. Oboje by mělo používat jako
zařízení myši soubor /dev/input/mice. Správný komunikační protokol bývá v gpm
exps2, v systému X Window ExplorerPS/2. Příslušné konfigurační soubory jsou /
etc/gpm.conf a /etc/X11/xorg.conf.

Aby myš fungovala, musí být zavedeny některé moduly jádra. Ve většině případů
jsou správné moduly rozpoznány a zavedeny automaticky. Výjimkou mohou být staré
sériové a sběrnicové myši^[28], které jsou dnes spíše raritou ve velmi starých
počítačích. Typické moduly, které jsou potřeba pro různé typy myší:

┌────────┬───────────────────────────────────────────────────────────┐
│ Modul  │                           Popis                           │
├────────┼───────────────────────────────────────────────────────────┤
│psmouse │PS/2 myši (měl by být rozpoznán automaticky)               │
├────────┼───────────────────────────────────────────────────────────┤
│usbhid  │USB myši (měl by být rozpoznán automaticky)                │
├────────┼───────────────────────────────────────────────────────────┤
│sermouse│Většina sériových myší                                     │
├────────┼───────────────────────────────────────────────────────────┤
│logibm  │Sběrnicová myš připojená k adaptérové kartě Logitech       │
├────────┼───────────────────────────────────────────────────────────┤
│inport  │Sběrnicová myš připojená ke kartě ATI nebo Microsoft InPort│
└────────┴───────────────────────────────────────────────────────────┘

Pro zavedení modulu s ovladačem můžete použít příkaz modconf z balíku stejného
jména a hledat v kategorii kernel/drivers/input/mouse.

D.2. Místo potřebné pro úlohy

Standardní instalace na architektuře amd64 zabere na disku včetně všech
standardních balíků 933MB. Menší instalace bez úlohy "Standardní systém" zabere
701MB.

Důležité

V obou případech je zabrané místo počítáno po dokončení instalace a smazání
všech dočasných souborů. Výpočet také nebere v úvahu režii souborového systému,
například pro žurnálovací soubory. To znamená, že během instalace a také
později při samotném používání systému bude potřeba mnohem více místa na
dočasné soubory (stažené balíky) a uživatelská data.

Následující tabulka ukazuje velikosti úloh tak, jak je vypisuje program
aptitude. Protože se mohou balíky v některých úlohách překrývat, je možné, že
celková velikost instalovaných úloh bude menší než součet jejich velikostí.

Ve výchozím nastavení se instaluje desktopové prostředí GNOME. Některá jiná
desktopová prostředí můžete nainstalovat buď pomocí speciálního instalačního
CD, nebo použitím zaváděcího parametru při zavádění instalátoru (viz 6.3.5.2 -
"Výběr a instalace softwaru").

Při určování velikostí diskových oblastí budete muset čísla uvedená v tabulce
přidat k velikosti standardního systému. Většina z hodnot ve sloupci "
Instalovaná velikost" skončí v /usr, při instalaci je však ještě třeba počítat
s hodnotami ze sloupce "Stáhne se", které se (dočasně) uloží v adresáři /var.

┌─────────────────┬──────────────────────┬────────────┬───────────────────────┐
│      Úloha      │ Instalovaná velikost │ Stáhne se  │ Místo během instalace │
│                 │         (MB)         │    (MB)    │         (MB)          │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│Desktopové       │                      │            │                       │
│prostředí        │                      │            │                       │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│  • GNOME        │2724                  │785         │3509                   │
│(výchozí)        │                      │            │                       │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│  • KDE Plasma   │4244                  │1280        │5524                   │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│  • Xfce         │2342                  │657         │2999                   │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│  • LXDE         │2486                  │707         │3193                   │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│  • MATE         │2857                  │757         │3614                   │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│  • Cinnamon     │3824                  │1102        │4926                   │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│Webový server    │44                    │11          │55                     │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│Tiskový server   │440                   │91          │531                    │
├─────────────────┼──────────────────────┼────────────┼───────────────────────┤
│SSH server       │2                     │0           │2                      │
└─────────────────┴──────────────────────┴────────────┴───────────────────────┘

Instalujete-li v jiném jazyce než angličtině, je možné, že tasksel automaticky
nainstaluje lokalizační úlohu pro daný jazyk. Velikost lokalizační úlohy závisí
na tom, co do ní její tvůrci umístili za balíky.

D.3. Jak nainstalovat Debian GNU/Linux ze stávajícího unixového/linuxového
systému

Tato kapitola se, na rozdíl od zbytku příručky, nezabývá oficiálním instalačním
programem, ale popisuje instalaci Debianu ze stávajícího unixového nebo
linuxového systému. Tuto kapitolu si vyžádali uživatelé přecházející z
distribucí Red Hat, Mandriva a SUSE. Předpokládáme zde jisté znalosti s
používáním *nixových příkazů a pohybem v souborovém systému. V této sekci
platí, že příkazy uvozené promptem $ zadáváte ve svém stávajícím systému,
zatímco příkazy uvozené # se spouští v chrootovaném prostředí.

Až si Debian GNU/Linux vyladíte k obrazu svému, můžete do něj převést stávající
uživatelská data a plynule přejít k nové distribuci bez zbytečných prostojů.
Tento druh instalace je též vhodný pro systémy s podivným hardwarem, který
jinak není podporován instalačními médii.

Poznámka

Protože se z velké části jedná o ruční postup, měli byste mít na paměti, že
spoustu věcí, které běžně řeší instalační program sám, nyní budete muset
provádět sami. To také klade větší nároky na znalosti Debianu a unixových
systémů obecně. Následující návod řeší pouze základní nastavení systému, je
možné, že bude potřeba provést další kroky.

D.3.1. Přípravné práce

Nejprve si rozdělte disk. Budete potřebovat aspoň jeden oddíl (kořenový) plus
oblast pro virtuální paměť (swap). Pro čistě konzolovou instalaci potřebujete
oblast velkou minimálně 701 MB, jestliže budete instalovat i X Window System,
počítejte s nejméně 2486 MB.

Na nových oddílech vytvořte souborové systémy. Například souborový systém ext3
na oblasti /dev/sda6 vytvoříte příkazem:

# mke2fs -j /dev/sda6

(Ve zbytku návodu budeme předpokládat, že kořenový oddíl je /dev/sda6.)
Jestliže chcete vytvořit systém ext2, vynechejte parametr -j.

Inicializujte a aktivujte odkládací oddíl (nezapomeňte změnit číslo oblasti
podle skutečnosti):

# mkswap /dev/sda5
# sync
# swapon /dev/sda5

Připojte budoucí kořenovou oblast (/) do adresáře /mnt/debinst. Na jméně
přípojného adresáře nezáleží.

# mkdir /mnt/debinst
# mount /dev/sda6 /mnt/debinst

Poznámka

Chcete-li mít části souborového systému (např. /usr) připojené na různých
oblastech, musíte tyto adresáře vytvořit a připojit ručně ještě před příští
kapitolou.

D.3.2. Instalace balíku debootstrap

debootstrap je program, kterým se v Debianu instaluje základní systém. Má
minimum závislostí (pouze /bin/sh, ar, wget a základní unixové/linuxové
nástroje^[29]), takže se dá použít na téměř libovolném systému. Pokud ještě 
wget a ar nemáte, nainstalujte si je.

Poslední možností je ruční instalace. Vytvořte si pracovní adresář, do kterého
později balík rozbalíte:

# mkdir work
# cd work

Z poolu si stáhněte balík debootstrap pro svou architekturu, uložte jej do
pracovního adresáře a vybalte z něj potřebné soubory. K instalaci souborů
musíte mít rootovská práva.

# ar -x debootstrap_0.X.X_all.deb
# cd /
# zcat /cesta-k-pracovnimu-adresari/work/data.tar.gz | tar xv

D.3.3. Spuštění debootstrapu

debootstrap si umí stáhnout potřebné soubory přímo z archivu Debianu. Aby se
soubory nestahovaly přes půl Zeměkoule, nahraďte v ukázce server
ftp.cz.debian.org/debian nějakým bližším. Seznam zrcadel naleznete v http://
www.debian.org/mirror/list.

Pokud máte první oficiální CD, můžete jej připojit jako /cdrom a místo síťové
adresy použít odkaz na soubor: file:/cdrom/debian/.

V ukázkovém příkazu debootstrap nahraďte ARCH jedním z následujících: amd64,
arm64, armel, armhf, i386, mips, mips64el, mipsel, powerpc, ppc64el nebo s390x.

# /usr/sbin/debootstrap --arch ARCH buster \
     /mnt/debinst http://ftp.cz.debian.org/debian

Pokud se cílová architektura liší od hostitelské, měli byste přidat ještě
parametr --foreign.

D.3.4. Nastavení základního systému

V adresáři /mnt/debinst teď máte opravdový, i když minimální, systém Debian.
Nastal čas se do něj přesunout:

# LANG=C.UTF-8 chroot /mnt/debinst /bin/bash

Pokud se cílová architektura liší od hostitelské, budete ale nejprve muset do
nového systému nakopírovat qemu-user-static:

# cp /usr/bin/qemu-ARCH-static /mnt/debinst/usr/bin
# LANG=C.UTF-8 chroot /mnt/debinst qemu-ARCH-static /bin/bash

V novém systému možná budete muset nastavit definici terminálu tak, aby byla
kompatibilní se základním systémem Debianu:

# export TERM=xterm-color

Abyste mohli použít některé hodnoty proměnné TERM, budete možná muset
nainstalovat balík ncurses-term.

Jestliže se cílová architektura liší od hostitelské, musíte dokončit druhou
fázi nastavení:

/debootstrap/debootstrap --second-stage

D.3.4.1. Vytvoření souborů zařízení

Adresář /dev nyní obsahuje několik základních souborů zařízení, avšak pro další
instalaci může být zapotřebí dalších zařízení. Další postup závisí na různých
faktorech, jako je typ hostitelského systému, zda hodláte použít modulární
jádro a zda chcete soubory zařízení v novém systému spravovat staticky nebo
dynamicky (například pomocí udev).

Několik možných postupů:

  • V chrootu vytvořte základní sadu statických souborů zařízení příkazy:

    # apt install makedev
    # mount none /proc -t proc
    # cd /dev
    # MAKEDEV generic

  • Pomocí příkazu MAKEDEV ručně vytvořte pouze ty soubory zařízení, které
    potřebujete.

  • Do instalovaného systému připojte adresář /dev z hostitelského systému
    (parametr bind příkazu mount). S touto možností byste však měli být
    opatrní, protože některé balíky při instalaci vytvářejí nová zařízení, což
    nemusí být to, co chcete, aby se promítlo do hostitelského systému.

D.3.4.2. Připojení oblastí

Nejprve musíte vytvořit soubor /etc/fstab.

# editor /etc/fstab

Jako vzor můžete použít následující šablonu (místo XXX dosaďte vlastní
oblasti):

# /etc/fstab: static file system information.
#
# file system    mount point   type    options                  dump pass
/dev/XXX         /             ext3    defaults                 0    1
/dev/XXX         /boot         ext3    ro,nosuid,nodev          0    2

/dev/XXX         none          swap    sw                       0    0
proc             /proc         proc    defaults                 0    0

/dev/fd0         /media/floppy auto    noauto,rw,sync,user,exec 0    0
/dev/cdrom       /media/cdrom  iso9660 noauto,ro,user,exec      0    0

/dev/XXX         /tmp          ext3    rw,nosuid,nodev          0    2
/dev/XXX         /var          ext3    rw,nosuid,nodev          0    2
/dev/XXX         /usr          ext3    rw,nodev                 0    2
/dev/XXX         /home         ext3    rw,nosuid,nodev          0    2

Souborové systémy, které jste zadali do /etc/fstab můžete připojit všechny
najednou příkazem mount -a, nebo individuálně příkazem:

# mount /cesta # např.:  mount /usr

Přípojné body pro výměnná média se v aktuálních verzích Debianu nachází v
adresáři /media, ale pro zachování zpětné kompatibility na ně existují i
symbolické odkazy v kořenu /. Příklad:

# cd /media
# mkdir cdrom0
# ln -s cdrom0 cdrom
# cd /
# ln -s media/cdrom

Před další prací si ověřte, že máte připojený virtuální souborový systém /proc.
Pokud tomu tak není, připojte jej:

# mount -t proc proc /proc

Příkaz ls /proc by nyní měl vypsat neprázdný adresář. Pokud by se tak nestalo,
stále byste měli být schopni připojit proc z vnějšku chrootu:

# mount -t proc proc /mnt/debinst/proc

D.3.4.3. Nastavení časového pásma

Nastavením třetího řádku v souboru /etc/adjtime na hodnotu "LOCAL" resp. "UTC"
systému říkáte, zda má hardwarové hodiny počítače interpretovat jako místní
čas, resp. jako čas v UTC.

# editor /etc/adjtime

Příklad souboru souboru /etc/adjtime:

0.0 0 0.0
0
UTC

Své časové pásmo můžete nastavit příkazem:

# dpkg-reconfigure tzdata

D.3.4.4. Nastavení sítě

Síťování se nastavuje v souborech /etc/network/interfaces, /etc/resolv.conf, /
etc/hostname a /etc/hosts.

# editor /etc/network/interfaces

Pro začátek vám mohou pomoci ukázky z /usr/share/doc/ifupdown/examples:

######################################################################
# /etc/network/interfaces -- configuration file for ifup(8), ifdown(8)
# See the interfaces(5) manpage for information on what options are
# available.
######################################################################

# Virtuální loopback chceme vždy.
#
auto lo
iface lo inet loopback

# Použití dhcp:
#
# auto eth0
# iface eth0 inet dhcp

# Statická IP adresa: (broadcast a gateway jsou volitelné)
#
# auto eth0
# iface eth0 inet static
#     address 192.168.0.42
#     network 192.168.0.0
#     netmask 255.255.255.0
#     broadcast 192.168.0.255
#     gateway 192.168.0.1

Do /etc/resolv.conf zadejte nastavení jmenných serverů (DNS):

# editor /etc/resolv.conf

Jednoduchá ukázka /etc/resolv.conf:

search hqdom.local
nameserver 10.1.1.36
nameserver 192.168.9.100

Zadejte název svého systému (délka aspoň 2 a nejvýše 63 znaky):

# echo JmenoPocitace > /etc/hostname

A vytvořte základní /etc/hosts s podporou IPv6:

127.0.0.1 localhost
127.0.1.1 JmenoPocitace

# The following lines are desirable for IPv6 capable hosts
::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

Jestliže máte více síťových karet, měli byste si pohrát s názvy modulů v /etc/
modules, aby se karty vždy přiřadily ke stejnému rozhraní (eth0, eth1, atd.)

D.3.4.5. Nastavení APT

Debootstrap sice vytvořil základní soubor /etc/apt/sources.list, který umožní
instalaci dalších balíků, ale je možné, že budete chtít přidat další zdroje,
například pro bezpečnostní aktualizace, nebo pro zdrojové balíky:

deb-src http://ftp.cz.debian.org/debian buster main

deb http://security.debian.org/ buster/updates main
deb-src http://security.debian.org/ buster/updates main

Po úpravách seznamu zdrojů nezapomeňte spustit příkaz apt update.

D.3.4.6. Nastavení místního prostředí a klávesnice

Aby se s vámi systém bavil v jiném jazyce než je angličtina, musíte
nainstalovat a nastavit balík pro podporu národních prostředí. V současnosti se
doporučuje použít prostředí v kódování UTF-8.

# apt install locales
# dpkg-reconfigure locales

Pokud je to potřeba, můžete nakonfigurovat klávesnici:

# apt install console-setup
# dpkg-reconfigure keyboard-configuration

Klávesnici nemůžete nastavit v chrootu, změna se projeví až po příštím
restartu.

D.3.5. Instalace jádra

Jestliže budete chtít tento systém i zavádět (na 99% ano), musíte si
nainstalovat jádro (a možná zavaděč). Následujícím příkazem zjistíte dostupná
připravená jádra:

# apt search linux-image

Poté balík s vybraným jádrem nainstalujte.

# apt install linux-image-arch-atd

D.3.6. Nastavení zavaděče

Abyste mohli zavádět svůj Debian GNU/Linux, nastavte v zavaděči, aby nahrál
instalované jádro s novou kořenovou oblastí. debootstrap sám o sobě zavaděč
neinstaluje, takže jej budete muset doinstalovat zvlášť (např. pomocí apt
uvnitř chrootovaného prostředí).

Návod k nastavení zavaděče prozradí příkaz info grubnebo man lilo.conf. Pokud
si ponecháte původní operační systém, stačí do stávajícího grub2 grub.cfg nebo
lilo.conf přidat příslušnou položku. lilo.conf si také můžete zkopírovat do
nového systému, zde ho upravit a spustit lilo (použije konfigurační soubor
systému, ze kterého jej spouštíte).

Instalace a nastavení grub2 není složitější než spuštění:

# apt install grub-pc
# grub-install /dev/sda
# update-grub

Druhý příkaz nainstaluje grub2 (v tomto případě do hlavního zaváděcího záznamu
(MBR) disku sda). Poslední příkaz vytvoří rozumný a funkční konfigurační soubor
/boot/grub/grub.cfg.

V příkladu se předpokládá existence souboru zařízení /dev/sda.

Pro inspiraci nabízíme minimální /etc/lilo.conf:

boot=/dev/sda6
root=/dev/sda6
install=menu
delay=20
lba32
image=/vmlinuz
initrd=/initrd.img
label=Debian

D.3.7. Vzdálený přístup: Instalace SSH a nastavení přístupu

Pokud se do systému můžete přihlásit přes konzoli, můžete tento krok přeskočit.
Jestliže však má být počítač dostupný přes síť, měli byste nainstalovat SSH a
nastavit přístup.

# apt install ssh

Uživatel root má implicitně zakázané přihlášení pomocí hesla. Pokud mu chcete
povolit přístup pomocí hesla tak, jako to bývalo běžné dříve, musíte mu
nastavit heslo a povolit přihlášení pomocí hesla:

# passwd
# editor /etc/ssh/sshd_config

kde musíte povolit volbu

PermitRootLogin yes

Přístup můžete moderněji nastavit také přidáním ssh klíče do seznamu
autorizovaných klíčů uživatele root:

# mkdir /root/.ssh
# chmod 700 /root/.ssh
# cat << EOF > /root/.ssh/authorized_keys
ssh-rsa ....
EOF

Poslední možností je dát přístup běžnému uživateli:

# adduser franta
# passwd franta

D.3.8. Závěrečné kroky

Jak již bylo řečeno dříve, nainstalovaný systém bude poměrně jednoduchý.
Chcete-li z něj udělat systém o něco vyspělejší, doinstalujte alespoň balíky s
prioritou "standardní":

# tasksel install standard

Nic vám samozřejmě nebrání nainstalovat jednotlivé balíky pomocí apt.

Po instalaci zůstanou stažené .deb soubory v adresáři /var/cache/apt/archives/.
Nějaké místo můžete uvolnit jejich smazáním:

# apt clean

D.4. Jak nainstalovat Debian GNU/Linux přes paralelní port (PLIP)

Tato část vysvětluje instalaci Debianu na počítači bez ethernetové karty, ale
na kterém funguje paralelní port, přes který je připojen druhý počítač (brána)
pomocí nullmodemového kabelu. Počítač sloužící jako brána by měl být připojen
do sítě, která obsahuje zrcadlo Debianu (např. Internet).

V příkladu použijeme pro PLIP spojení k bráně IP adresy 192.168.0.1 a
192.168.0.2. Pokud tyto kolidují s adresami vaší lokální sítě, zvolte si nějaké
vhodnější. Brána je do Internetu připojena pomocí vytáčeného připojení (ppp0).

PLIP připojení, které během instalace vytvoříme, bude dostupné i po restartu do
nainstalovaného systému (viz 7 - "Zavedení vašeho nového systému").

Před začátkem instalace byste měli zkontrolovat nastavení BIOSu a poznamenat si
přerušení (IRQ) a bázovou VV adresu (IO base address) paralelních portů na obou
spojovaných systémech. Nejběžnější hodnoty jsou io=0x378 a irq=7.

D.4.1. Požadavky

  • Cílový počítač nahepc, na který budeme instalovat.

  • Instalační média, viz 2.4 - "Instalační média".

  • Pomocný počítač earthsimulator připojený k Internetu, který bude sloužit
    jako brána.

  • Nullmodemový kabel DB-25. Podrobnosti o kabelu naleznete v
    PLIP-Install-HOWTO společně s návodem, jak si můžete tento kabel vyrobit
    vlastními silami.

D.4.2. Nastavení stroje earthsimulator

Následujíc skript ukazuje možné nastavení earthsimulatoru jako brány do
Internetu pomocí ppp0.

#!/bin/sh

# Odstraníme z jádra následující moduly, abychom se vyhnuli
# konfliktům a abychom je mohli nastavit ručně.
modprobe -r lp parport_pc
modprobe parport_pc io=0x378 irq=7
modprobe plip

# Nastavení rozhraní plip (zde je to plip0, viz dmesg | grep plip)
ifconfig plip0 192.168.0.2 pointopoint 192.168.0.1 netmask 255.255.255.255 up

# Nastavení brány
modprobe iptable_nat
iptables -t nat -A POSTROUTING -o ppp0 -j MASQUERADE
echo 1 > /proc/sys/net/ipv4/ip_forward

D.4.3. Instalace na nahepc

Zaveďte systém z instalačních médií v expertním režimu (např. na zaváděcí výzvě
zadejte expert) a poté během instalace odpovězte na následující otázky
naznačeným způsobem. Potřebujete-li předat modulům jádra nějaké parametry,
můžete tak učinit rovněž na zaváděcí výzvě. Například pro zavedení instalátoru
a nastavení parametrů "io" a "irq" modulu parport_pc zadejte:

expert parport_pc.io=0x378 parport_pc.irq=7

 1. Nahrát komponenty instalátoru z CD

    Ze seznamu vyberte možnost plip-modules; tím se instalačnímu systému
    zpřístupní ovladače pro PLIP.

 2. Rozpoznat síťový hardware

      □ Pokud nahepc obsahuje síťové karty, zobrazí se seznam modulů pro
        všechny rozpoznané karty. Trváte-li na použití PLIP, musíte všechny
        vybrané moduly odznačit. Samozřejmě že pokud nejsou rozpoznány žádné
        karty, seznam se nezobrazí.

      □ Protože nebyly nalezeny/vybrány žádné síťové karty, instalační systém
        vás požádá o výběr vhodného modulu s ovladačem. Vyberte modul plip.

 3. Nastavit síť

      □ Automaticky nastavit síť přes DHCP: Ne

      □ IP adresa: 192.168.0.1

      □ Point-to-point adresa: 192.168.0.2

      □ Adresy jmenných serverů: můžete zadat stejnou hodnotu, jako máte na
        earthsimulatoru (viz soubor /etc/resolv.conf)

D.5. Jak nainstalovat Debian GNU/Linux pomocí PPP přes Ethernet (PPPoE)

V některých zemích (např. v České republice) se mezi poskytovatelem
širokopásmového připojení k Internetu pomocí ADSL nebo kabelové televize a
koncovým zákazníkem běžně používá protokol PPP přes Ethernet (PPPoE). Použití
PPPoE během instalace není v běžném instalátoru podporováno, ale podpora
existuje a stačí ji zapnout. Tato kapitola vysvětluje jak.

PPPoE spojení vytvořené během instalace bude k dispozici i po restartu do
nového systému (viz 7 - "Zavedení vašeho nového systému").

Abyste mohli během instalace nastavit a využít PPPoE, musíte k instalaci použít
obraz některého z dostupných CD/DVD. Ostatní způsoby instalace (zavádění ze
sítě) PPPoE nepodporují.

Instalace pomocí PPPoE je téměř shodná s ostatními instalacemi, drobné rozdíly
jsou zachyceny v následujících bodech.

  • Instalační systém zaveďte se zaváděcím parametrem modules=ppp-udeb^[30].
    Tímto zajistíte, aby se automaticky zavedla komponenta zodpovědná za
    nastavení PPPoE (ppp-udeb).

  • Stejně jako v běžné instalaci projděte nastavením jazyka, země, klávesnice
    a zavedením dodatečných komponent instalačního systému^[31].

  • Dalším krokem je rozpoznání síťového hardwaru v systému.

  • Poté se spustí vlastní nastavení PPPoE. Instalační systém postupně zkusí na
    každém rozpoznaném ethernetovém rozhraní nalézt PPPoE koncentrátor (to je
    typ serveru, který se stará o PPPoE spojení).

    Je možné, že se koncentrátor nepodaří nalézt na první pokus. To se občas
    stává na pomalých nebo hodně zatížených sítích, případně u porouchaných
    serverů. Opakovaný pokus o nalezení koncentrátoru většinou bývá úspěšný.
    Pro opakování vyberte z hlavního menu instačního systému položku Nastavit a
    spustit PPPoE spojení.

  • Po nalezení koncentrátoru budete dotázáni na přihlašovací informace (PPPoE
    jméno uživatele a heslo).

  • V tomto okamžiku se instalační systém pokusí navázat PPPoE spojení.
    Jestliže byly zadané informace správné, PPPoE spojení se nastaví a bude k
    dispozici po zbytek instalace. Pokud jste zadali chybné přihlašovací
    informace, nebo pokud se vyskytne nějaká jiná chyba, instalace se zastaví,
    ale stále budete mít možnost se vrátit do hlavního menu a zkusit krok
    zopakovat; stačí znovu vybrat možnost Nastavit a spustit PPPoE spojení.


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

^[28] Sériové myši mají obvykle konektor tvaru D s devíti otvory. Sběrnicové
myši mají kulatý 8 pinový konektor. Pozor, neplést s 6 pinovým kulatým
konektorem myší PS/2 a 4 pinovým kulatým konektorem ADB.

^[29] Sem patří GNU core utilities a příkazy typu sed, grep, tar a gzip.

^[30] Více informací o použití zaváděcích parametrů naleznete v části 5.1.7 -
"Zaváděcí obrazovka".

^[31] V tomto kroku se nahraje komponenta ppp-udeb. Instalujete-li se střední
nebo nízkou prioritou (expertní režim), můžete zde ručně zvolit ppp-udeb a
nemusíte používat zaváděcí parametr "modules" z předchozího kroku.

Příloha E. Administrivia

Obsah

E.1. O tomto dokumentu
E.2. Jak přispět k tomuto návodu
E.3. Hlavní spoluautoři
E.4. Český překlad
E.5. Ochranné známky

E.1. O tomto dokumentu

Tato příručka byla vytvořena pro instalaci distribuce Sarge (debian-installer).
Příručka vychází z dřívějšího manuálu pro Woodyho (boot-floppies), který je
zase založen na předchozích instalačních manuálech. Využili jsme i částí manálu
distribuce Progeny, který byl v roce 2003 uvolněn pod licencí GNU GPL.

Tento dokument je napsán ve formátu XML DocBook. Výstupní formáty jsou
generovány různými programy využívající informace z balíků docbook-xml a
docbook-xsl.

Aby byl dokument lépe udržovatelný, používáme různé výhody XML, jako jsou
entity a profilovací atributy, které nahrazují proměnné a podmínky z
programovacích jazyků. Zdrojový text příručky například obsahuje pohromadě
informace pro všechny podporované typy počítačových architektur. Pomocí
profilovacích atributů jsou různé pasáže textu označeny jako závislé na dané
architektuře a při překladu se zobrazí jenom v určitých verzích dokumentu.

E.2. Jak přispět k tomuto návodu

Problémy a vylepšení týkající se tohoto dokumentu zasílejte formou bug reportu
(hlášení o chybě) v balíku installation-guide. (Viz popis v balíku reportbug
nebo online dokumentace Debian Bug Tracking System.) Před nahlášením problému
je vždy dobré nejprve zkontrolovat databázi otevřených chyb balíku
installation-guide, zda již chyba nebyla hlášena. Pokud stejný problém najdete
mezi neuzavřenými chybami, můžete doplnit existující popis o váš poznatek
zasláním zprávy na adresu <XXXX@bugs.debian.org>, kde XXXX je číslo již
nahlášeného problému.

Ještě lepší je získat zdrojový text dokumentu ve formátu DocBook a vytvářet
záplaty (patch) přímo proti němu. Pokud jste se s formátem DocBook ještě
nesetkali, pro začátek vám pomůže soubor cheatsheet.txt nacházející se v
adresáři se zdrojovými texty příručky. Ty můžete nalézt na stránce
debian-installer WebSVN. Návod, jak získat soubory ze SVN, najdete v souboru
README.

Prosíme vás, abyste nekontaktovali autory tohoto dokumentu přímo. Existuje
emailová konference balíku debian-installer, která je zaměřena i na tento
manuál. Její adresa je <debian-boot@lists.debian.org>. Návod pro přihlášení do
konference naleznete na stránce Přihlášení do diskusních listů Debianu. Starší
zprávy jsou dostupné v archivu diskusních listů Debianu.

E.3. Hlavní spoluautoři

Tento dokument původně napsali Bruce Perens, Sven Rudolph, Igor Grobman, James
Treacy a Adam Di Carlo. Sebastian Ley sepsal Installation Howto.

Miroslav Kuře zdokumentoval (prý velké) části funkcionality nového instalačního
programu pro Sarge. Frans Pop byl hlavním editorem a release managerem během
vydání Etche, Lennyho a Squeeze.

K tomuto dokumentu přispělo mnoho uživatelů a vývojářů Debianu. Zmiňme alespoň
Michaela Schmitze (m68k), Franka Neumanna (je autorem instalačního manuálu pro
Amigu). Dále to jsou Arto Astala, Eric Delaunay/Ben Collins (SPARC), Tapio
Lehtonen a Stéphane Bortzmeyer (mnoho oprav a textu). Také je třeba poděkovat
Pascalu Le Bailovi za užitečné informace o zavádění z USB zařízení.

Velmi užitečné informace jsme nalezli v dokumentech "Jim Mintha's HOWTO for
network booting" (neznámá adresa), Debian FAQ, Linux/m68k FAQ, Linux for SPARC
Processors FAQ, Linux/Alpha FAQ a dalších. Uznání samozřejmě patří i lidem,
kteří tyto volně dostupné a bohaté zdroje informací spravují.

Část manuálu zabývající se chrootovanou instalací (D.3 - "Jak nainstalovat
Debian GNU/Linux ze stávajícího unixového/linuxového systému") je částečně
odvozena z dokumentů na něž vlastní copyright Karsten M. Self.

Kapitola zabývající se instalací přes (D.4 - "Jak nainstalovat Debian GNU/Linux
přes paralelní port (PLIP)") je založena na PLIP-Install-HOWTO od Gilla
Lamirala.

E.4. Český překlad

Tento dokument smí být šířen za podmínek uvedených v GNU General Public
License. Vlastníkem autorských práv k překladu je Miroslav Kuře <
kurem@debian.cz> a historicky též Jiří Mašík <masik@debian.cz> a Vilém Vychodil
<vychodiv@debian.cz>.

E.5. Ochranné známky

Všechny ochranné známky jsou majetkem svých vlastníků.

Příloha F. Český překlad GNU General Public License

Abstrakt

This is an unofficial translation of the GNU General Public License into Czech.
It was not published by the Free Software Foundation, and does not legally
state the distribution terms for software that uses the GNU GPL -- only the
original English text of the GNU GPL does that. However, we hope that this
translation will help Czech speakers to better understand the GNU GPL.

Tento text je neoficiálním překladem GNU General Public License (GNU GPL).
Nebyl vydán nadací Free Software Foundation a nevyjadřuje právní podstatu
podmínek pro šíření softwaru používajícího GNU GPL -- tomuto účelu slouží
výhradně původní anglická verze GNU GPL. Přesto doufáme, že tento překlad
pomůže českým čtenářům lépe porozumět licenci GNU GPL.

Český překlad verze 2, červen 1991

Copyright (C) 1989, 1991 Free Software Foundation, Inc. 51 Franklin St, Fifth
Floor, Boston, MA 02110-1301, USA.

Kopírování a distribuce doslovných kopií tohoto licenčního dokumentu jsou
dovoleny komukoliv, jeho změny jsou však zakázány.

F.1. Preambule

Softwarové licence jsou většinou navrženy tak, že vám odebírají právo
svobodného sdílení a úprav programů. Smyslem GNU General Public License je
naproti tomu zaručit svobodu ke sdílení a úpravám svobodného softwaru -- pro
zajištění svobodného přístupu k tomuto softwaru pro všechny jeho uživatele.
Tato General Public License se vztahuje na většinu softwaru nadace Free
Software Foundation a na jakýkoli jiný program, jehož autor se přikloní k
jejímu používání. (Některý další software od Free Software Foundation je
namísto toho pokryt GNU Lesser General Public License.) Můžete ji rovněž použít
pro své programy.

Pokud mluvíme o svobodném softwaru, máme na mysli svobodu, nikoliv cenu. Naše
General Public License je navržena pro zajištění toho, že můžete svobodně šířit
kopie svobodného softwaru (a účtovat si poplatek za tuto službu, pokud chcete),
že obdržíte zdrojový kód anebo jej můžete získat, pokud ho chcete, že můžete
tento software modifikovat nebo jeho části použít v nových svobodných
programech; a že víte, že tyto věci smíte dělat.

Abychom mohli chránit vaše práva, musíme vytvořit omezení, která zakáží
komukoli vám tato práva odepírat nebo vás žádat, abyste se těchto práv vzdali.
Tato omezení se promítají do jistých povinností, kterým musíte dostát, pokud
šíříte kopie dotyčného softwaru anebo ho modifikujete.

Například, šíříte-li kopie takového programu, ať již zdarma nebo za poplatek,
musíte poskytnout příjemcům všechna práva, která máte sami. Musíte zaručit, že
příjemci rovněž dostanou anebo mohou získat zdrojový kód. A musíte jim ukázat
tyto podmínky, aby znali svá práva.

Vaše práva chráníme ve dvou krocích: (1) autorizací softwaru a (2) nabídkou
této licence, která vám dává právoplatné svolení ke kopírování, šíření a
modifikaci softwaru.

Kvůli ochraně každého autora i nás samotných chceme zajistit, aby každý chápal
skutečnost, že pro svobodný software neplatí žádné záruky. Je-li software někým
jiným modifikován a poslán dále, chceme, aby příjemci věděli, že to, co mají,
není originál, takže jakékoliv problémy vnesené jinými se neodrazí na reputaci
původních autorů.

Konečně, každý svobodný program je neustále ohrožen softwarovými patenty.
Přejeme si zamezit nebezpečí, že redistributoři svobodného programu obdrží
samostatně patentová osvědčení a tím učiní program vázaným. Abychom tomu
zamezili, deklarovali jsme, že každý patent musí být buď vydán s tím, že
umožňuje každému svobodné užití, anebo nesmí být vydán vůbec.

Přesná ustanovení a podmínky pro kopírování, šíření a modifikaci jsou uvedeny
dále.

F.2. GNU GENERAL PUBLIC LICENSE

USTANOVENÍ A PODMÍNKY PRO KOPÍROVÁNÍ, DISTRIBUCI A MODIFIKACI

0. Tato licence se vztahuje na kterýkoliv program či jiné dílo, které obsahuje
zmínku, umístěnou v něm držitelem autorských práv, o tom, že dílo může být
šířeno podle ustanovení GNU General Public License. V dalším textu znamená "
program" každý takový program nebo dílo a "dílo založené na programu" znamená
buď program samotný anebo každé jiné dílo z něj odvozené, které podléhá
autorskému zákonu: tím se míní dílo obsahující program nebo jeho část, buď
doslovně anebo s modifikacemi, popřípadě v překladu do jiného jazyka. (Nadále
je překlad zahrnován bez omezení pod pojem "modifikace".) Každý uživatel
licence je označován jako "vy".

Jiné činnosti než kopírování, šíření a modifikace nejsou touto licencí pokryty;
sahají mimo její rámec. Akt spuštění programu není omezen a výstup z programu
je pokryt pouze tehdy, jestliže obsah výstupu tvoří dílo založené na programu
(nezávisle na tom, zda bylo vytvořeno činností programu). Posouzení platnosti
předchozí věty závisí na tom, co program dělá.

1. Smíte kopírovat a šířit doslovné kopie zdrojového kódu programu tak, jak
jste jej obdrželi a na libovolném médiu, za předpokladu, že na každé kopii
viditelně a náležitě zveřejníte zmínku o autorských právech a absenci záruky;
ponecháte nedotčené všechny zmínky vztahující se k této licenci a k absenci
záruky; a dáte každému příjemci spolu s programem kopii této licence.

Za fyzický akt přenesení kopie můžete žádat poplatek a podle vlastního uvážení
můžete nabídnout za poplatek záruční ochranu.

2. Můžete modifikovat svou kopii či kopie programu anebo kterékoliv jeho části,
a tak vytvořit dílo založené na programu a kopírovat a rozšiřovat takové
modifikace či dílo podle podmínek paragrafu 1 výše za předpokladu, že splníte
všechny tyto podmínky:

 a. Modifikované soubory musíte opatřit zřetelnou zmínkou uvádějící, že jste
    soubory změnili a také uvést datum každé změny.

 b. Musíte umožnit, aby jakékoliv vámi publikované či rozšiřované dílo, které
    obsahuje zcela nebo zčásti program nebo jakoukoli jeho část, popřípadě je z
    programu nebo jeho části odvozeno, mohlo být jako celek bezplatně
    poskytnuto každé třetí osobě v souladu s ustanoveními této licence.

 c. Pokud modifikovaný program pracuje normálně tak, že čte interaktivně
    povely, musíte zajistit, že při nejběžnějším způsobu jeho spuštění vytiskne
    nebo zobrazí hlášení zahrnující příslušnou zmínku o autorském právu a
    uvede, že neexistuje žádná záruka (nebo případně, že záruku poskytujete
    vy), a že uživatelé mohou za těchto podmínek program redistribuovat, a musí
    uživateli sdělit, jakým způsobem může nahlédnout do kopie této licence.
    (Výjimka: v případě, že sám program je interaktivní, avšak žádné takové
    hlášení nevypisuje, nepožaduje se, aby vaše dílo založené na programu
    takové hlášení vypisovalo.)

Tyto požadavky se vztahují k modifikovanému dílu jako celku. Pokud lze
identifikovat části takového díla, které zřejmě nejsou odvozeny z programu a
mohou být samy o sobě rozumně považovány za nezávislá a samostatná díla, pak se
tato licence a její ustanovení nevztahují na tyto části, jsou-li šířeny jako
nezávislá díla. Avšak jakmile tytéž části rozšiřujete jako část celku, jímž je
dílo založené na programu, musí být rozšiřování tohoto celku podřízeno
ustanovením této licence tak, že povolení poskytnutá dalším uživatelům se
rozšíří na celé dílo, tedy na všechny jeho části bez ohledu na to, kdo kterou
část napsal.

Smyslem tohoto paragrafu tedy není získání práv na dílo zcela napsané vámi ani
popírání vašich práv vůči němu; skutečným smyslem je výkon práva na řízení
distribuce odvozených nebo kolektivních děl založených na programu.

Pouhé spojení jiného díla, jež není na programu založeno, s programem (anebo
dílem založeným na programu) na paměťovém nebo distribučním médiu neuvazuje
toto jiné dílo do působnosti této licence.

3. Můžete kopírovat a rozšiřovat program (nebo dílo na něm založené, viz
paragraf 2) v objektové anebo spustitelné podobě podle ustanovení paragrafů 1
a 2 výše, pokud splníte některou z následujících náležitostí:

 a. Doprovodíte jej zdrojovým kódem ve strojově čitelné formě. Zdrojový kód
    musí být rozšiřován podle ustanovení paragrafů 1 a 2 výše, a to na médiu
    běžně používaném pro výměnu softwaru; nebo

 b. Doprovodíte jej písemnou nabídkou s platností nejméně tři roky, podle níž
    poskytnete jakékoli třetí straně, za poplatek nepřevyšující vaše výdaje
    vynaložené na fyzickou výrobou zdrojové distribuce, kompletní strojově
    čitelnou kopii odpovídajícího zdrojového kódu, jenž musí být šířen podle
    ustanovení paragrafů 1 a 2 výše na médiu běžně používaném pro výměnu
    softwaru; nebo

 c. Doprovodíte jej informacemi, které jste dostali ohledně nabídky na
    poskytnutí zdrojového kódu. (Tato alternativa je povolena jen pro
    nekomerční šíření a jenom tehdy, pokud jste obdržel program v objektovém
    nebo spustitelném tvaru spolu s takovou nabídkou, v souladu s položkou b
    výše.)

Zdrojový kód k dílu je nejvhodnější formou díla z hlediska jeho případných
modifikací. Pro dílo ve spustitelném tvaru znamená úplný zdrojový kód veškerý
zdrojový kód pro všechny moduly, které obsahuje, plus jakékoli další soubory
pro definici rozhraní, plus dávkové soubory potřebné pro kompilaci a instalaci
spustitelného programu. Zvláštní výjimkou jsou však ty softwarové komponenty,
které jsou normálně šířeny (buď ve zdrojové nebo binární formě) s hlavními
součástmi operačního systému, na němž spustitelný program běží (tj. s
překladačem, jádrem apod.). Tyto komponenty nemusí být šířeny se zdrojovým
kódem, pokud ovšem komponenta sama nedoprovází spustitelnou podobu díla.

Je-li šíření objektového nebo spustitelného kódu činěno nabídkou přístupu ke
kopírování z určitého místa, potom se za distribuci zdrojového kódu počítá i
nabídnutí ekvivalentního přístupu ke kopírování zdrojového kódu ze stejného
místa, byť přitom nejsou třetí strany nuceny ke zkopírování zdrojového kódu
spolu s objektovým.

4. Nesmíte kopírovat, modifikovat, poskytovat sublicence anebo šířit program
jiným způsobem než výslovně uvedeným v této licenci. Jakýkoli jiný pokus o
kopírování, modifikování, poskytnutí sublicence anebo šíření programu je
neplatný a automaticky ukončí vaše práva daná touto licencí. Strany, které od
vás obdržely kopie anebo práva v souladu s touto licencí, však nemají své
licence ukončeny, dokud se jim plně podřizují.

5. Není vaší povinností tuto licenci přijmout, protože jste ji nepodepsal. Nic
jiného vám však nedává možnost kopírovat nebo šířit program nebo odvozená díla.
V případě, že tuto licenci nepřijmete, jsou tyto činnosti zákonem zakázány. Tím
pádem modifikací anebo šířením programu (anebo každého díla založeného na
programu) vyjadřujete své podřízení se licenci a všem jejím ustanovením a
podmínkám pro kopírovaní, modifikování a šíření programu a děl na něm
založených.

6. Pokaždé, když redistribuujete program (nebo dílo založené na programu),
získává příjemce od původního držitele licence právo kopírovat, modifikovat a
šířit program v souladu s těmito ustanoveními a podmínkami. Nesmíte klást žádné
další překážky výkonu zde zaručených příjemcových práv. Nejste odpovědný za
vymáhání dodržování této licence třetími stranami.

7. Jsou-li vám z rozhodnutí soudu, obviněním z porušení patentu nebo z
jakéhokoli jiného důvodu (nejen v souvislosti s patenty) uloženy takové
podmínky (ať již příkazem soudu, smlouvou nebo jinak), které se vylučují s
podmínkami této licence, nejste tím osvobozen od podmínek této licence. Pokud
nemůžete šířit program tak, abyste vyhověl zároveň svým závazkům vyplývajícím z
této licence a jiným platným závazkům, nesmíte jej v důsledku toho šířit vůbec.
Pokud by například patentové osvědčení nepovolovalo bezplatnou redistribuci
programu všemi, kdo vaším přičiněním získají přímo nebo nepřímo jeho kopie, pak
by jediný možný způsob jak vyhovět zároveň patentovému osvědčení i této licenci
spočíval v ukončení distribuce programu.

Pokud by se za nějakých specifických okolností jevila některá část tohoto
paragrafu jako neplatná nebo nevynutitelná, považuje se za směrodatnou
rovnováha vyjádřená tímto paragrafem a paragraf jako celek se považuje za
směrodatný za jiných okolností.

Smyslem tohoto paragrafu není navádět vás k porušování patentů či jiných
ustanovení vlastnického práva, anebo tato ustanovení zpochybňovat; jediným jeho
smyslem je ochrana integrity systému šíření svobodného softwaru, který je
podložen veřejnými licenčními předpisy. Mnozí lidé poskytli své příspěvky do
širokého okruhu softwaru šířeného tímto systémem, spolehnuvše se na jeho
důsledné uplatňování; záleží na autorovi/dárci, aby rozhodl, zda si přeje šířit
software pomocí nějakého jiného systému a žádný uživatel licence nemůže takové
rozhodnutí zpochybňovat.

Smyslem tohoto paragrafu je zevrubně osvětlit to, co je považováno za důsledek
plynoucí ze zbytku této licence.

8. Pokud je šíření či použití programu v některých zemích omezeno buď patenty
anebo autorsky chráněnými rozhraními, může držitel původních autorských práv,
který svěřuje program do působnosti této licence, přidat výslovné omezení pro
geografické šíření, vylučující takové země, takže šíření je povoleno jen v těch
zemích nebo mezi těmi zeměmi, které nejsou tímto způsobem vyloučeny. Tato
licence zahrnuje v tomto případě takové omezení přesně tak, jako by bylo
zapsáno v textu této licence.

9. Free Software Foundation může čas od času vydávat upravené nebo nové verze
General Public License. Takové nové verze se budou svým duchem podobat současné
verzi, v jednotlivostech se však mohou lišit s ohledem na nové problémy či
zájmy. Každé verzi je přiděleno rozlišující číslo verze. Pokud program
specifikuje číslo verze, která se na něj vztahuje, a "všechny následující verze
", můžete se podle uvážení řídit ustanoveními a podmínkami buďto oné konkrétní
verze anebo kterékoliv následující verze, kterou vydala Free Software
Foundation. Jestliže program nespecifikuje číslo verze této licence, můžete si
vybrat libovolnou verzi, kterou kdy Free Software Foundation vydala.

10. Pokud si přejete zahrnout části programu do jiných svobodných programů,
jejichž distribuční podmínky jsou odlišné, zašlete autorovi žádost o povolení.
V případě softwaru, k němuž vlastní autorská práva Free Software Foundation,
napište Free Software Foundation; někdy činíme výjimky ze zde uvedených
ustanovení. Naše rozhodnutí bude vedeno dvěma cíli: zachováním svobodné povahy
všech odvozenin našeho svobodného softwaru a podporou sdílení a opětovného
využití softwaru obecně.

ZÁRUKA SE NEPOSKYTUJE

11. Vzhledem k bezplatnému poskytnutí licence k programu se na program
nevztahuje žádná záruka, a to v míře povolené platným zákonem. pokud není
písemně stanoveno jinak, poskytují držitelé autorských práv popřípadě jiné
strany program "tak, jak je", bez záruky jakéhokoli druhu, ať výslovné nebo
vyplývající, včetně, ale nikoli jen, záruk prodejnosti a vhodnosti pro určitý
účel. Pokud jde o kvalitu a výkonnost programu, leží veškeré riziko na vás.
pokud by se u programu projevily závady, padají náklady za všechnu potřebnou
údržbu, opravu či nápravu na váš vrub.

12. V žádném případě, s výjimkou toho, když to vyžaduje platný zákon, anebo
když to bylo písemně odsouhlaseno, vám nebude žádný z držitelů autorských práv
ani žádná jiná strana, která smí modifikovat či šířit program v souladu s
předchozími ustanoveními, odpovědni za škody, včetně všech obecných,
speciálních, nahodilých nebo následných škod vyplývajících z užívání anebo
neschopnosti užívat programu (včetně, ale nikoli jen, ztráty nebo zkreslení
dat, nebo trvalých škod způsobených vám nebo třetím stranám, nebo selhání
funkce programu v součinnosti s jinými programy), a to i v případě, že takový
držitel autorských práv nebo jiná strana byli upozorněni na možnost takových
škod.

KONEC USTANOVENÍ A PODMÍNEK

F.3. Jak uplatnit tato ustanovení na vaše nové programy

Pokud vyvinete nový program a chcete, aby byl veřejnosti co nejvíce k užitku,
můžete toho nejlépe dosáhnout tím, že jej prohlásíte za svobodný software,
který může kdokoliv redistribuovat a měnit za zde uvedených podmínek.

K tomu stačí připojit k programu následující údaje. Nejbezpečnější cestou je
jejich připojení na začátek každého zdrojového souboru, čímž se nejúčinněji
sdělí vyloučení záruky; a v každý souboru by pak měla být přinejmenším řádka s 
"copyrightem" a odkaz na místo, kde lze nalézt úplné údaje.

řádka se jménem programu a nástinem toho, co dělá.
Copyright (C) rok jméno autora

Tento program je svobodný software; můžete jej šířit a modifikovat
podle ustanovení GNU General Public License, vydávané Free Software
Foundation; a to buď verze 2 této licence anebo (podle vašeho uvážení)
kterékoli pozdější verze.

Tento program je rozšiřován v naději, že bude užitečný, avšak BEZ
JAKÉKOLI ZÁRUKY; neposkytují se ani odvozené záruky PRODEJNOSTI anebo
VHODNOSTI PRO URČITÝ ÚČEL. Další podrobnosti hledejte ve GNU General
Public License.

Kopii GNU General Public License jste měli obdržet spolu s tímto
programem; pokud se tak nestalo, napište o ni Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
MA 02110-1301, USA.

Připojte rovněž informaci o tom, jak je možné se s vámi spojit elektronickou a
papírovou poštou.

Pokud je program interaktivní, zařiďte, aby se při startu v interaktivním módu
vypsalo hlášení podobné tomuto:

Gnomovision verze 69, Copyright (C) rok jméno autora.

Program Packal je absolutně bez záruky; podrobnosti se dozvíte
zadáním `show w'.

Toto je svobodný software a jeho šíření za jistých podmínek je vítáno;
podrobnosti získáte zadáním `show c'.

Hypotetické povely `show w' a `show c' by měly zobrazit příslušné pasáže
General Public License. Odpovídající povely ovšem nemusí být právě `show w' a
`show c'; mohou to být třeba stisky tlačítka na myši nebo položky v menu --
cokoliv, co se do vašeho programu hodí.

Pokud je to nutné, měli byste také přimět svého zaměstnavatele (jestliže
pracujete jako programátor) nebo představitele vaší školy, je-li někdo takový,
k tomu, aby podepsal "zřeknutí se autorských práv". Zde je vzor; jména
pozměňte:

Jojotechna, a.s., se tímto zříká veškerého zájmu o autorská práva
k programu `Packal' (překladač s nakladačem) napsanému Jakubem
Programátorem.

Tomáš Ředitel - podpis, 1. dubna 1989

Tomáš Ředitel, více než prezident

Tato General Public License neumožňuje zahrnutí vašeho programu do jiných než
svobodných programů. Je-li váš program knihovnou podprogramů, můžete zvážit,
zda je užitečné umožnit sestavování i vázaných aplikačních programů s vaší
knihovnou. V takovém případě použijte GNU Lesser General Public License namísto
této licence.

